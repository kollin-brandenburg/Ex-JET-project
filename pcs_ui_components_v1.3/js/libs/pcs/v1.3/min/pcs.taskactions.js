/**
 * @license RequireJS text 2.0.12 Copyright (c) 2010-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/*
 RequireJS i18n 2.0.2 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/requirejs/i18n for details
*/

define("text",["module"],function(e){"use strict";var t,n,r,i,s,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],u=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,a=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,f=typeof location!="undefined"&&location.href,l=f&&location.protocol&&location.protocol.replace(/\:/,""),c=f&&location.hostname,h=f&&(location.port||undefined),p={},d=e.config&&e.config()||{};t={version:"2.0.12",strip:function(e){if(e){e=e.replace(u,"");var t=e.match(a);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:d.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=o[t];try{e=new ActiveXObject(n)}catch(r){}if(e){o=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,d.isBuild&&(p[e]=r),i(r)},load:function(e,n,r,i){if(i&&i.isBuild&&!i.inlineText){r();return}d.isBuild=i&&i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),a=d.useXhr||t.useXhr;if(u.indexOf("empty:")===0){r();return}!f||a(u,l,c,h)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(p.hasOwnProperty(n)){var s=t.jsEscape(p[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(d.env==="node"||!d.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node&&!process.versions["node-webkit"])n=require.nodeRequire("fs"),t.get=function(e,t,r){try{var i=n.readFileSync(e,"utf8");i.indexOf("ï»¿")===0&&(i=i.substring(1)),t(i)}catch(s){r&&r(s)}};else if(d.env==="xhr"||!d.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);d.onXhr&&d.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status||0,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r&&r(o)):n(s.responseText),d.onXhrComplete&&d.onXhrComplete(s,e))},s.send(null)};else if(d.env==="rhino"||!d.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),r!==null&&n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(d.env==="xpconnect"||!d.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var n,o,u,a={};s&&(e=e.replace(/\//g,"\\")),u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),o=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),o.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(n.available(),a),o.close(),n.close(),t(a.value)}catch(f){throw new Error((u&&u.path||"")+": "+f)}};return t}),define("text!pcs/tasklistActions/templates/pcs-task-actions.html",[],function(){return'<div id="pcs-taskactions-container">\n	<!-- ko foreach: taskActionList -->\n	<!-- ko if: actionType == \'Custom\' -->\n	<button class="pcs-act-custom" data-bind="visible: !$parent.hideCustomActions, attr:{id:title}, click:$parent.onCustomActionClick,\n									ojComponent: {\n									component:\'ojButton\',\n									label: label,\n									rootAttributes: {style: \'font-size: 12px;\'}\n									}"></button>\n	<!-- /ko -->\n	<!-- /ko -->\n	<button data-bind="visible: !hideSystemActions && isTaskSelected ,ojComponent: {\n									component:\'ojButton\',\n									label: bundle.pcs.tasklist.systemActions,\n									menu: \'#systemMenu\',\n									rootAttributes: {style: \'font-size: 12px;\'}\n								}">\n	</button>\n	<ul class="pcs-tl-hidden" id="systemMenu"\n		data-bind="ojComponent: {component: \'ojMenu\', select: onSystemActionSelect}">\n		<!-- ko foreach: taskActionList -->\n		<!-- ko if: actionType == \'System\' -->\n		<li class="oj-menu-item">\n			<a href="#" class="pcs-tl-action-menu-item" data-bind="text:label, value:title"></a>\n		</li>\n		<!-- /ko -->\n		<!-- /ko -->\n	</ul>\n	<div class="oj-flex"\n		 data-bind=\'component: {name: "requestInfo", params: { isVisible: displayInfoRequest, showInline: false, tasks: selectedTasklist }}\'>\n	</div>\n	<div class="oj-flex"\n		 data-bind=\'component: {name: "reassign", params: { isVisible: displayReassign, showInline: false, tasks: selectedTasklist }}\'>\n	</div>\n	<div id="pcs-taskActions-confirmation-dialog"\n		 data-bind="ojComponent:{component: \'ojDialog\', title: bundle.pcs.taskActions.confirmation + displayActionName(), close: handleClose,\n		 	rootAttributes: { style: \'width: 500px; min-width: 100px; max-width 500px;\'}}">\n		<div class="oj-dialog-body" id="pcs-taskActions-confirmation-dialog-content">\n			<div data-bind="text: getSelectedItems()">\n			</div>\n			<br/>\n			<div class="oj-flex-item">\n				<label for="comments" data-bind="text:bundle.pcs.taskActions.comments"></label>\n							<textarea id="comments" style="resize: both" data-bind="ojComponent:\n                   {component: \'ojTextArea\', rootAttributes: {style:\'min-width:100%\'}, value:actionComments, required: false}">\n							</textarea>\n			</div>\n		</div>\n		<div class="oj-dialog-footer" id="pcs-taskActions-confirmation-dialog-footer">\n			<button id="okButton"\n					data-bind="ojComponent: {component: \'ojButton\', label: bundle.pcs.taskActions.ok}, click: handleSubmit"></button>\n			<button id="cancelButton"\n					data-bind="ojComponent: {component: \'ojButton\', label: bundle.pcs.taskActions.cancel}, click: handleClose"></button>\n		</div>\n	</div>\n</div>\n'}),define("pcs/util/pcsUtil",["module","knockout","ojs/ojcore","jquery"],function(e,t,n,r){"use strict";function a(){var e={},t;if(window.location.href.indexOf("?")===-1)return e;var n=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");for(var r=0;r<n.length;r++){t=n[r].split("=");var i=decodeURIComponent(t[0]),s=decodeURIComponent(t[1]),o=JSON.parse(s);e[i]=o}return e}var i={};r.CustomEvent=function(e){var t,n=e&&i[e];return n||(t=r.Callbacks(),n={publish:t.fire,subscribe:t.add,unsubscribe:t.remove},e&&(i[e]=n)),n};var s={addHandler:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n},removeHandler:function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=null}};String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{enumerable:!1,value:function(e,t){return t=t||0,this.substr(t,e.length)===e}}),String.prototype.endsWith||Object.defineProperty(String.prototype,"endsWith",{enumerable:!1,value:function(e,t){var n=this.toString();if(typeof t!="number"||!isFinite(t)||Math.floor(t)!==t||t>n.length)t=n.length;t-=e.length;var r=n.indexOf(e,t);return r!==-1&&r===t}});var o=function(e){typeof window.doADFProxyCall=="function"?window.doADFProxyCall(e):e&&window.location.assign(e)},u=function(e){function a(e){var t=e.split("\r\n"),n="text/plain",r="pcsFormUrl",i={contentType:n,fieldName:r};for(var s=1;s<t.length;s++){var o=t[s],u=o.match(/^.*filename="([^"]*)"/);if(u)i.fieldName=u[1];else{var a="Content-Type:";o.indexOf(a)>-1&&(u=o.substring(o.indexOf(a)+a.length)),u&&(i.contentType=u.trim())}}return i}var t=e.getResponseHeader("Content-Type"),n=e.response,r=t.match(/boundary=(?:'([^']+)'|([^;]+))/i);if(!r)throw new Error("Bad content-type header, no multipart boundary");var i=r[1]||r[2],s=typeof n!="string",o,u;i="\r\n--"+i;if(s){var f=new Uint8Array(n),l=32768,c=[];for(u=0;u<f.length;u+=l)c.push(String.fromCharCode.apply(null,f.subarray(u,u+l)));o=c.join("")}else o=n;o="\r\n"+o;var h=o.split(new RegExp(i)),p={};for(u=1;u<h.length-1;u++){var d="\r\n\r\n",v=h[u].substring(h[u].indexOf(d)+d.length),m=h[u].substring(0,h[u].indexOf(d)),g=a(m),y=!1;s&&!g.contentType.startsWith("text")&&(y=!0),p[g.fieldName]={data:v,contentType:g.contentType,fileName:g.fieldName}}return p},f=function(e){return r.ajax({type:"GET",url:e,dataType:"text",xhrFields:{withCredentials:!0}})};return t.bindingHandlers.formatDateInMillis={update:function(e,r,i){var s=t.unwrap(r());if(!s)return;var o={formatType:"date",pattern:i().datePattern},u=n.Validation.converterFactory("datetime").createConverter(o),a=u.format(n.IntlConverterUtils.dateToLocalIso(new Date(s)));t.bindingHandlers.text.update(e,function(){return a})}},{adfProxyCall:o,getAuthToken:f,multipartParse:u,getUrlParametersObject:a,eventHandler:s,initComponentForIFrame:function(e,t,n){if(!r.isEmptyObject(r.pcsConnection))t();else{r.pcsConnection={};if(!r.isEmptyObject(e)){e.testMode&&(r.pcsConnection.testMode=e.testMode),e.serverURL&&(r.pcsConnection.serverURL=e.serverURL);if(e.authInfo){r.pcsConnection.authInfo=e.authInfo,t();return}}var i=this,s=function(){var e=i.getServerURL();console.log("Script loaded and ready, getting token"),i.getAuthToken(e+"/bpm/workspace/auth/token").done(function(e){e&&e.startsWith("<html")?n.text("User cannot be authorized").show():(r.pcsConnection.authInfo="Bearer "+e,t())}).fail(function(e){n.text("User cannot be authorized").show()})},o=document.createElement("script");o.onload=s,o.onreadystatechange=function(){this.readyState==="complete"&&s()};var u=this.getServerURL();o.src=u+"/bpm/workspace/faces/js/homePage.js",document.getElementsByTagName("head")[0].appendChild(o)}},getCookie:function(e){var t;return(t=(new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)")).exec(document.cookie))?t[1]:null},getServerURL:function(){if(r.pcsConnection&&r.pcsConnection.serverURL)return r.pcsConnection.serverURL.endsWith("/")?r.pcsConnection.serverURL.substring(0,r.pcsConnection.serverURL.length-1):r.pcsConnection.serverURL;if(e.uri.indexOf(".")===0||e.uri.indexOf("/")===0)return window.location.origin;try{return(new URL(e.uri)).origin}catch(t){return window.location.origin}},getRestUri:function(){return"/bpm/api/3.0/"},getAuthInfo:function(){if(r.pcsConnection&&r.pcsConnection.authInfo){var e=r.pcsConnection.authInfo;return!e.startsWith("Bearer ")&&!e.startsWith("Basic ")&&(e="Bearer "+e),e}return""},getRestURL:function(){if(r.pcsConnection&&r.pcsConnection.restURL)return r.pcsConnection.restURL;var e=this.getServerURL()+this.getRestUri();return r.pcsConnection&&(r.pcsConnection.restURL=e),e},isTestMode:function(){return r.pcsConnection&&r.pcsConnection.testMode?!0:!1},taskIconColor:function(e){if(!e)return"grey";var t=0,n,r,i;for(n=0,i=e.length;n<i;n++)r=e.charCodeAt(n),t=(t<<5)-t+r,t|=0;var s=t,o=s&255;s>>=8;var u=s&255;s>>=8;var a=s&255;return"rgb("+a+","+u+","+o+")"},taskInitials:function(e){if(!e)return"NA";e=e.replace(" ","");var t=e.charAt(0).toUpperCase(),n="";for(var r=1;r<e.length;r++)if(e.charAt(r)===e.charAt(r).toUpperCase()){n=e.charAt(r);break}return t+n},getRandomInt:function(e,t){return Math.floor(Math.random()*(t-e+1))+e},unApplyBindings:function(e,n){e.find("*").each(function(){r(this).off(),r(this).unbind()}),e.off(),n?(t.cleanNode(e[0]),e.find("*").each(function(){r(this).remove()}),t.removeNode(e)):(t.cleanNode(e),e.find("*").each(function(){r(this).remove()}))}}}),define("pcs/data-services/DataServices",["require","jquery","pcs/util/pcsUtil"],function(e){"use strict";var t=e("jquery"),n=e("pcs/util/pcsUtil");return function(){function f(){return{get:function(e,n,r){return e.indexOf(i(r))===-1&&(e=i(r)+e),n&&n.queryParams&&(e+="?"+u(n.queryParams)),t.ajax({type:"GET",url:e,beforeSend:o,xhrFields:{withCredentials:!0},contentType:n&&n.contentType?n.contentType:"application/json",dataType:n&&n.dataType?n.dataType:"json"})},post:function(e,n,r){e.indexOf(i(r))===-1&&(e=i(r)+e),n.contentType==null&&(n.contentType="application/json");var s=a(n.contentType,n.payload);return t.ajax({type:"POST",url:e,cache:!1,processData:!1,data:s,beforeSend:o,xhrFields:{withCredentials:!0},contentType:n.contentType,dataType:n&&n.dataType?n.dataType:"json"})},put:function(e,n,r){e.indexOf(i(r))===-1&&(e=i(r)+e),n.contentType==null&&(n.contentType="application/json");var s=a(n.contentType,n.payload);return t.ajax({type:"PUT",url:e,cache:!1,processData:!1,data:s,beforeSend:o,xhrFields:{withCredentials:!0},contentType:n.contentType,dataType:n&&n.dataType?n.dataType:"json"})},"delete":function(e,t){}}}var e,r={credentials:n.getAuthInfo(),baseUrl:n.getServerURL()+"/bpm/api/3.0"},i=function(e){return e?n.getServerURL()+"/bpm/api/"+e:n.getServerURL()+"/bpm/api/3.0"},s=function(){return n.getAuthInfo()},o=function(e){e.setRequestHeader("Authorization",s()),n.isTestMode()&&e.setRequestHeader("pcs_mode","dev")},u=function(e){var t=[];if(e instanceof Array)e.forEach(function(e){for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]))});else for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")},a=function(e,t){var n=JSON.stringify(t);if(!e&&e.startsWith("multipart")){n=new Uint8Array(t.length);for(var r=0;r<t.length;r++)n[r]=t.charCodeAt(r)}return n};return{getInstance:function(t){return e||(e=f()),t?e.connection=t:r&&(e.connection=r),e},setConnection:function(t){e||(e=f()),e.connection=t},serializeUrlParams:function(e){return u(e)}}}()}),define("pcs/tasklistActions/viewModel/Task",[],function(){"use strict";return function(e,t){if(t&&t.hasOwnProperty("update"))for(var n in e){if(!e.hasOwnProperty(n))continue;t.update.hasOwnProperty(n)&&(e[n]=typeof t.update[n]=="function"?t.update[n](e[n]):e[n])}return{getTitle:function(){return e.title},getNumber:function(){return e.number},getFromUser:function(){return e.fromUserDisplayName},getState:function(){return e.state},getAssignees:function(){return e.assignees.items},getCreator:function(){return e.creatorName},getAssignedDate:function(){return e.assignedDate},getCreatedDate:function(){return e.createdDate},getPriority:function(){return e.priority},getFromUserName:function(){return e.fromUserName},getFromUserDisplayName:function(){return e.fromUserDisplayName},getShortSummary:function(){return e.shortSummary},getDueDate:function(){return e.dueDate},getProcessName:function(){return e.processName},getUpdatedDate:function(){return e.updatedDate},getActionList:function(){return e.actionList}}}}),define("pcs/tasklistActions/viewModel/TaskAction",["jquery","pcs/data-services/DataServices","pcs/tasklistActions/viewModel/Task"],function(e,t,n){"use strict";var r={tasks:"/tasks",identities:"/identities"},i=t.getInstance();return function(t){var s={};s.options=t;var o={tasks:{url:"/tasks"}},u=function(t,o,u,a){var f={payload:{action:{id:o.toUpperCase(),type:u}}};t==null&&(t=s.selectedTask?s.selectedTask:null),a&&a.trim()!==""&&(f.payload.comment={commentStr:a,commentScope:"BPM"});var l=e.Deferred();if(t!=null){var c=r.tasks+"/"+t.getNumber();i.put(c,f).then(function(e){l.resolve(new n(e))}).fail(function(e){l.reject(e)})}else l.reject("Task is null or undefined");return l},a=function(t,s,o,u){var a={payload:{action:{id:s.toUpperCase(),type:o},tasks:[]}},f=e.Deferred();if(t&&Array.isArray(t)){t.forEach(function(e){a.payload.tasks.push(e.getNumber())}),u&&u.trim()!==""&&(a.payload.comment={commentStr:u,commentScope:"BPM"});var l=r.tasks;i.put(l,a).then(function(e){f.resolve(e.items.map(function(e){return new n(e)}))}).fail(function(e){f.reject(e)})}else f.reject("Tasks is undefined or empty");return f},f=function(e,t){var n=[];for(var r=0;r<e.length;r++)n.push({id:e[r],type:t[r]});return n},l=function(t,o,u,a){t==null&&(t=s.tasks?s.tasks:null);var l=e.Deferred();if(t!=null){var c={payload:{identities:f(o,u),action:{id:"INFO_REQUEST",type:"SYSTEM"},tasks:t.map(function(e){return String(e.getNumber())}),comment:{commentStr:a,commentScope:"TASK"}}},h=r.tasks;i.put(h,c).then(function(e){l.resolve(e.items.map(function(e){return new n(e)}))}).fail(function(e){l.reject(e)})}else l.reject("Task is undefined or null");return l},c=function(t,o,u,a){t==null&&(t=s.selectedTask?s.selectedTask:null);var l=e.Deferred();if(t!=null){var c={payload:{identities:f(o,u),action:{id:"INFO_REQUEST",type:"SYSTEM"},comment:{commentStr:a,commentScope:"TASK"}}};l=new Promise(function(e,s){var o=r.tasks+"/"+t.getNumber();i.put(o,c).then(function(t){e(new n(t))}).fail(function(e){s(e)})})}else l.reject("Task is undefined or null");return l},h=function(t,o){t==null&&(t=s.tasks?s.tasks:null);var u=e.Deferred();if(t!=null){var a={payload:{identities:f(o.identityId,o.identityType),action:{id:o.reassignType,type:"SYSTEM"},tasks:t.map(function(e){return String(e.getNumber())}),comment:{commentStr:o.userComment,commentScope:"TASK"}}},l=r.tasks;i.put(l,a).then(function(e){u.resolve(e.items.map(function(e){return new n(e)}))}).fail(function(e){u.reject(e)})}else u.reject("Task is undefined or null");return u},p=function(t,o){t==null&&(t=s.selectedTask?s.selectedTask:null);var u=e.Deferred();if(t!=null){var a={payload:{identities:f(o.identityId,o.identityType),action:{id:o.reassignType,type:"SYSTEM"},comment:{commentStr:o.userComment,commentScope:"TASK"}}};u=new Promise(function(e,s){var o=r.tasks+"/"+t.getNumber();i.put(o,a).then(function(t){e(new n(t))}).fail(function(e){s(e)})})}else u.reject("Task is undefined or null");return u},d=function(t){var n=e.Deferred(),s=r.identities,o={contentType:"application/json; charset=utf-8",queryParams:t};return i.get(s,o,null,t).then(function(e){n.resolve(e)}).fail(function(e){n.reject(e)}),n};return{getTaskDetail:function(t,r){var u=e.Deferred();if(!t)return u.reject("Task is not passed");var a=r?{queryParams:r}:null,f=o.tasks.url+"/"+t.getNumber();return i.get(f,a).then(function(e){var t=new n(e);s.selectedTask=t,u.resolve(t)}).fail(function(e){u.reject(e)}),u},doCustomActionOnTask:function(e,t,n){return u(e,t,"CUSTOM",n)},doSystemActionOnTask:function(e,t,n){return u(e,t,"SYSTEM",n)},doCustomActionOnTasks:function(e,t,n){return a(e,t,"CUSTOM",n)},doSystemActionOnTasks:function(e,t,n){return a(e,t,"SYSTEM",n)},reassignTasks:function(e,t){return e.length<=1?p(e[0],t):h(e,t)},requestInfo:function(e,t,n,r){return e.length<=1?c(e[0],t,n,r):l(e,t,n,r)},getIdentities:function(e){return d(e)}}}}),define("pcs/tasklistActions/viewModel/taskActionsVM",["ojs/ojcore","knockout","jquery","pcs/tasklistActions/viewModel/TaskAction","pcs/tasklistActions/viewModel/Task","ojs/ojknockout","ojs/ojselectcombobox","ojs/ojbutton","ojs/ojmenu","ojs/ojdialog"],function(e,t,n,r,i){"use strict";return function(o,u){function c(){t.components.isRegistered("requestInfo")||t.components.register("requestInfo",{template:{require:"text!pcs/tasklistActions/templates/pcs-requestInfo.html"},viewModel:{createViewModel:function(e,t){var n=require("pcs/tasklistActions/viewModel/requestInfoVM");return new n(e,t)}}}),t.components.isRegistered("reassign")||t.components.register("reassign",{template:{require:"text!pcs/tasklistActions/templates/pcs-reassign.html"},viewModel:{createViewModel:function(e,t){var n=require("pcs/tasklistActions/viewModel/reassignVM");return new n(e,t)}}})}function d(e,t){a.taskActionList([]);if(!t)return;var n=[],r=t.filter(function(e){if(a.taskNumbers||e.isSelected())n=p(e.getActionList(),n);return a.taskNumbers||e.isSelected()});a.isTaskSelected(r.length>0),a.taskActionList(h(n)),a.selectedTasklist(r)}function v(){f=new r,c();if(a.taskNumbers){var e=a.taskNumbers.map(function(e){return f.getTaskDetail(e)});Promise.all(e).then(function(e){a.isTaskSelected(!0),d(null,e)}).catch(function(e){n("#pcs-taskactions-container").html("One of more task objects could not be obtained")})}}function m(){a.taskActionList([]),a.selectedTasklist([]),a.isTaskSelected(!1),a.actionName(""),a.actionComments(""),a.showConfirmation("none")}function g(){m()}var a=this,f,l=a.systemActions?a.systemActions:["SUSPEND","ESCALATE","RENEW","REASSIGN","INFO_REQUEST","WITHDRAW","ACQUIRE","PURGE","DELETE","RESUME","RELEASE"];a.rootElement=u?n(u.element):n(document),a.bundle=require("ojL10n!pcsMsg/nls/pcsSnippetsResource"),a.displayInfoRequest=t.observable(),a.displayReassign=t.observable(),a.taskActionList=t.observableArray([]),a.selectedTasklist=t.observableArray([]),a.isTaskSelected=t.observable(!1),a.isActionConfirm=t.observable(!1),a.showConfirmation=t.observable("none"),a.actionName=t.observable(""),a.actionComments=t.observable(""),a.displayActionName=t.computed(function(){return a.bundle.pcs.taskActions[a.actionName()]}),a.hideCustomActions=o.taskactionParams.hideCustomActions,a.hideSystemActions=o.taskactionParams.hideSystemActions,a.systemActions=o.taskactionParams.systemActions.split(",").map(function(e){return e.trim()}),a.taskNumbers=o.taskactionParams.taskNumbers==null?null:o.taskactionParams.taskNumbers.split(",").map(function(e){var t={number:e.trim()},n=new i(t);return n}),a.confirmDialog=n("#pcs-taskActions-confirmation-dialog",a.rootElement),c();var h=function(e){return e?e.filter(function(e){var t=a.bundle.pcs.taskActions[e.title];return e.label=t?t:e.title,e.actionType==="System"&&l.indexOf(e.title)>-1||e.actionType==="Custom"}):[]},p=function(e,t){return t.length===0&&e.length>0?t=e:t=t.filter(function(t){if(t.actionType==="System"&&l.indexOf(t.title)===-1)return!1;var n=e.filter(function(e){return t.title===e.title});return n.length>0}),t};v(),n(document).on("tasklist:taskCheck",d),n(document).on("tasklistAction:refresh",g),n(document).on("taskAction:submit",g),a.getSelectedItems=function(){var t=a.bundle.pcs.taskActions.selectedTasks;return t=e.Translations.applyParameters(t,{0:a.selectedTasklist().length}),t},a.onCustomActionClick=function(e,t){a.actionName(t.currentTarget.id),a.showConfirmation("custom"),a.confirmDialog.ojDialog("open")},a.onSystemActionSelect=function(e,t){a.actionName(t.item.children().val()),a.showConfirmation("system"),a.actionName()==="INFO_REQUEST"||a.actionName()==="REASSIGN"?a.handleSubmit():a.confirmDialog.ojDialog("open")},a.handleSubmit=function(){a.showConfirmation()==="custom"?a.submitCustomAction():a.showConfirmation()==="system"&&a.submitSystemAction(),a.confirmDialog.ojDialog("close")},a.handleClose=function(){a.confirmDialog.ojDialog("close")},a.submitCustomAction=function(){var e=a.actionName(),t=a.actionComments();a.selectedTasklist().length===1?f.doCustomActionOnTask(a.selectedTasklist()[0],e,t).then(function(){a.rootElement.trigger("taskAction:submit",[e]),m()}):f.doCustomActionOnTasks(a.selectedTasklist(),e,t).then(function(){a.rootElement.trigger("taskAction:submit",[e]),m()})};var y=function(e){var t=a.actionComments();a.selectedTasklist().length===1?f.doSystemActionOnTask(a.selectedTasklist()[0],e,t).then(function(){a.rootElement.trigger("taskAction:submit",[e]),m()}):f.doSystemActionOnTasks(a.selectedTasklist(),e,t).then(function(){a.rootElement.trigger("taskAction:submit",[e]),m()})};a.submitSystemAction=function(){a.displayInfoRequest(!1),a.displayReassign(!1);var e=a.actionName();switch(e){case"INFO_REQUEST":a.displayInfoRequest(!0);break;case"REASSIGN":a.displayReassign(!0);break;default:y(e)}},a.dispose=function(){console.log("dispose in taskActionsVM"),a.displayActionName.dispose()}}}),define("text!pcs/tasklistActions/templates/pcs-reassign.html",[],function(){return'<div id="pcs-reassign-container">\n\n	<div id="pcs-reassign-modalDialog"\n		 data-bind="visible: !showInline(), ojComponent:{component: \'ojDialog\', title: bundle.pcs.taskActions.reassignHeader, close: handleClose,\n		 	rootAttributes: { style: \'width: 450px; min-width: 100px; max-width 450px;\'}}">\n		<div class="oj-dialog-body" id="pcs-reassign-dialog-content">\n		</div>\n		<div class="oj-dialog-footer" id="pcs-reassign-dialog-footer">\n		</div>\n	</div>\n\n	<div data-bind="visible: showInline() && isVisible()" class="oj-panel oj-margin">\n		<div id="pcs-reassign-inline-content">\n			<div id="pcs-reassign-overlay"></div>\n			<div id="form-container" class="oj-form-layout">\n				<div class="oj-form">\n					<div class="oj-flex">\n						<div class="oj-flex-item">\n							<div id="reassignOptions" aria-labelledby="mainlabelid"\n								 data-bind="ojComponent: {\n										  component: \'ojRadioset\',\n										  value: action}">\n									<span class="oj-choice-row">\n										<input id="REASSIGN" type="radio" name="rbb" value="REASSIGN">\n										<label for="REASSIGN" data-bind="text:bundle.pcs.taskActions.reassign+bundle.pcs.taskActions.reassignDescription"></label>\n									</span>\n									<span class="oj-choice-row">\n										<input id="DELEGATE" type="radio" name="rbb" value="DELEGATE">\n										<label for="DELEGATE" data-bind="text:bundle.pcs.taskActions.delegate+bundle.pcs.taskActions.delegateDescription"></label>\n									</span>\n							</div>\n						</div>\n					</div>\n					<div class="oj-flex">\n						<div class="oj-flex-item">\n							<div id="username" data-bind=\'component: {\n								name: "pcs-identity-browser" , params: {multiple: true, placeholderTxt: placeholder(), scope: scope(), idbID: idbID}\n							}\'></div>\n						</div>\n					</div>\n					<div class="oj-flex">\n						<div class="oj-flex-item">\n							<label for="comments" data-bind="text:bundle.pcs.taskActions.comments"></label>\n							<textarea id="comments" style="resize: both" data-bind="ojComponent:\n                   {component: \'ojTextArea\',rootAttributes: {style:\'min-width:100%\'}, value:comments, required: false}">\n							</textarea>\n						</div>\n					</div>\n				</div>\n			</div>\n		</div>\n		<br/>\n		<div id="pcs-reassign-inline-footer">\n			<button id="okButton"\n					data-bind="ojComponent: {component: \'ojButton\', label: bundle.pcs.taskActions.submit}, click: handleSubmit"></button>\n			<button id="cancelButton"\n					data-bind="ojComponent: {component: \'ojButton\', label: bundle.pcs.taskActions.cancel}, click: handleClose"></button>\n		</div>\n	</div>\n</div>\n'}),define("pcs/tasklist/viewModel/Task",[],function(){"use strict";return function(e,t){if(t&&t.hasOwnProperty("update"))for(var n in e){if(!e.hasOwnProperty(n))continue;t.update.hasOwnProperty(n)&&(e[n]=typeof t.update[n]=="function"?t.update[n](e[n]):e[n])}return{getTitle:function(){return e.title},getNumber:function(){return e.number},getFromUser:function(){return e.fromUserDisplayName},getState:function(){return e.state},getAssignees:function(){return e.assignees.items},getCreator:function(){return e.creatorName},getAssignedDate:function(){return e.assignedDate},getCreatedDate:function(){return e.createdDate},getPriority:function(){return e.priority},getFromUserName:function(){return e.fromUserName},getFromUserDisplayName:function(){return e.fromUserDisplayName},getShortSummary:function(){return e.shortSummary},getDueDate:function(){return e.dueDate},getProcessName:function(){return e.processName},getUpdatedDate:function(){return e.updatedDate},getActionList:function(){return e.actionList}}}}),function(){function e(e,t,n,r,i,s){return t[e]||(e=e.replace(/^zh-(Hans|Hant)-([^-]+)$/,"zh-$2")),t[e]?(n.push(e),!0!==t[e]&&1!==t[e]||r.push(i+e+"/"+s),!0):!1}function t(e){var t=e.toLowerCase().split(/-|_/);e=[t[0]];var n=1,r;for(r=1;r<t.length;r++){var i=t[r],s=i.length;if(1==s)break;switch(n){case 1:if(n=2,4==s){e.push(i.charAt(0).toUpperCase()+i.slice(1));break};case 2:n=3,e.push(i.toUpperCase());break;default:e.push(i)}}if(!("zh"!=e[0]||1<e.length&&4==e[1].length)){t="Hans",n=1<e.length?e[1]:null;if("TW"===n||"MO"===n||"HK"===n)t="Hant";e.splice(1,0,t)}return e}function n(e,t){for(var r in t)t.hasOwnProperty(r)&&(null==e[r]?e[r]=t[r]:"object"==typeof t[r]&&"object"==typeof e[r]&&n(e[r],t[r]))}var r=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;define("ojL10n",["module"],function(i){var s=i.config?i.config():{};return{version:"2.0.1+",load:function(i,o,u,a){a=a||{},a.locale&&(s.locale=a.locale);var f=r.exec(i),l=f[1],c,h=f[5],p,d=[],v={},m,g="",w,E,S,T,N,C;f[5]?(l=f[1],i=l+h,c=f[4]):(h=f[4],c=s.locale,"undefined"!=typeof document?(c||(c=a.isBuild?"root":document.documentElement.lang)||(c=void 0===navigator?"root":navigator.language||navigator.userLanguage||"root"),s.locale=c):c="root"),p=t(c),w=s.noOverlay,E=s.defaultNoOverlayLocale;if(f=s.merge)if(S=f[l+h])f=r.exec(S),T=f[1],N=f[4];C=[];for(m=0;m<p.length;m++)f=p[m],g+=(g?"-":"")+f,C.push(g);a.isBuild?(d.push(i),S&&d.push(S),o(d,function(){u()})):("query"==s.includeLocale&&(i=o.toUrl(i+".js"),i+=(-1===i.indexOf("?")?"?":"&")+"loc="+c),a=[i],S&&a.push(S),o(a,function(t,r){var i=[],s,a=!1,f=w||!0===t.__noOverlay,c=E||t.__defaultNoOverlayLocale;for(m=C.length-1;0<=m&&(!a||!f);m--)a=e(C[m],t,i,d,l,h);f&&!a&&c&&e(c,t,i,d,l,h),e("root",t,i,d,l,h),s=i.length;if(r){a=!1,f=!0===r.__noOverlay,c=r.__defaultNoOverlayLocale;for(m=C.length-1;0<=m&&(!a||!f);m--)a=e(C[m],r,i,d,T,N);f&&!a&&c&&e(c,r,i,d,T,N),e("root",r,i,d,T,N)}o(d,function(){var e,a,f;for(e=s;e<i.length&&i[e];e++){f=i[e],a=r[f];if(!0===a||1===a)a=o(T+f+"/"+N);n(v,a)}for(e=0;e<s&&i[e];e++){f=i[e],a=t[f];if(!0===a||1===a)a=o(l+f+"/"+h);n(v,a)}v._ojLocale_=p.join("-"),u(v)})}))}}})}(),define("text!pcs/identityBrowser/view/idBrowser.html",[],function(){return"<!-- parent VM which consumes this should have USer Defined idbConfig object with configuration details -->\n\n<select  data-bind=\"attr: {id: idbID, placeholder : placeholder}, ojComponent: { component: 'ojIdentity', value: value,\n		options: $.proxy(getIdentities, $data),\n		multiple: multiple, selectAll: true,\n		defaultScope: scope}\">\n</select>\n"}),define("pcs/identityBrowser/viewModel/Identity",[],function(){"use strict";function e(e){this.id=e.id||e.identityName,this.type=e.type||e.identityType,this.title=e.title,this.firstName=e.firstName||e.userFirstName,this.lastName=e.lastName||e.userLastName,this.email=e.email,this.mobile=e.mobile||e.userMobile}return e.prototype={getId:function(){return this.id},getType:function(){return this.type},getTitle:function(){return this.title},getFirstName:function(){return this.title},getLastName:function(){return this.title},getFullName:function(){return this.firstName+" "+this.lastName},getEmail:function(){return this.email},getMobile:function(){return this.email}},e}),define("pcs/identityBrowser/viewModel/Identities",[],function(){"use strict";function e(){this._identities=[],this._selectedIdentities=[]}return e.prototype={setIdentities:function(e){this._identities=e},getIdentities:function(){return this._identities},setSelectedIdentities:function(e){this._selectedIdentities=e},getSelectedIdentities:function(){return this._selectedIdentities}},e}),define("pcs/identityBrowser/viewModel/IdentityService",["pcs/identityBrowser/viewModel/Identity","pcs/identityBrowser/viewModel/Identities","pcs/data-services/DataServices"],function(e,t,n){"use strict";function s(){this._identities=new t}var r={identities:"/identities"},i=n.getInstance();return s.prototype={getIdentity:function(e){return this._identities.getIdentities[e]},setIdentities:function(e){this._identities.setIdentities(this.parseIdentity(e))},getIdentities:function(){return[].concat(this._identities.getIdentities())},setSelectedIdentities:function(e){this._identities.setSelectedIdentities(this.parseIdentity(e))},getSelectedIdentities:function(){return this._identities.getSelectedIdentities()},parseIdentity:function(t){var n=[];if(t&&Array.isArray(t))for(var r=0,i=t.length;r<i;r++)n.push(new e(t[r]));return n},restCall:function(e){var t=this;return new Promise(function(n,s){var o=r.identities,u={contentType:"application/json; charset=utf-8",queryParams:e};i.get(o,u,null,e).then(function(e){t.setIdentities(e.items||[]),n(t.getIdentities())}).fail(function(e){s(t.getIdentities())})})}},s}),define("pcs/composer/idBrowser/ojidentity.min",["require","ojs/ojcore","jquery","ojs/ojeditablevalue"],function(e){var t=e("ojs/ojcore"),n=e("jquery");e("ojs/ojeditablevalue");var r={GENERATED_OPTIONS_SELECTOR:"oj-select-options-generated",KEY:{TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isControl:function(e){var t=e.which;switch(t){case r.KEY.SHIFT:case r.KEY.CTRL:case r.KEY.ALT:return!0}return!!e.metaKey||!!e.ctrlKey},isFunctionKey:function(e){return e=e.which?e.which:e,e>=112&&e<=123}},DEFAULT_QUERY_DELAY:70,ValueChangeTriggerTypes:{ENTER_PRESSED:"enter_pressed",OPTION_SELECTED:"option_selected",OPTION_REMOVED:"option_removed",BLUR:"blur",SEARCH_ICON_CLICKED:"search_icon_clicked"},lastMousePosition:{x:0,y:0},nextUid:function(){var e=1;return function(){return e++}}(),scrollBarDimensions:null,each2:function(e,t){for(var r=n(n.isFunction(e[0])?e[0]():e[0]),i=-1,s=e.length;++i<s&&(r.context=r[0]=n.isFunction(e[0])?e[i]():e[i])&&t.call(r[0],i,r)!==!1;);return e},measureScrollbar:function(){var e=n("<div class='oj-listbox-measure-scrollbar'></div>");e.appendTo("body");var t={width:e.width()-e[0].clientWidth,height:e.height()-e[0].clientHeight};return e.remove(),t},splitVal:function(e,t){var r,i,s;if(null===e||e.length<1)return[];for(r=e.split(t),i=0,s=r.length;i<s;i+=1)r[i]=n.trim(r[i]);return r},getSideBorderPadding:function(e){return e.outerWidth(!1)-e.width()},installKeyUpChangeEvent:function(e){var t="keyup-change-value";e.on("keydown",function(){void 0===n.data(e,t)&&n.data(e,t,e.val())}),e.on("keyup",function(i){if(i.which===r.KEY.ENTER)return void i.stopPropagation();var s=n.data(e,t);void 0!==s&&e.val()!==s&&(n.removeData(e,t),e.trigger("keyup-change"))})},installFilteredMouseMove:function(e){e.on("mousemove",function(e){var t=r.lastMousePosition;void 0!==t&&t.x===e.pageX&&t.y===e.pageY||(n(e.target).trigger("mousemove-filtered",e),r.lastMousePosition.x=e.pageX,r.lastMousePosition.y=e.pageY)})},thunk:function(e){var t,n=!1;return function(){return n===!1&&(t=e(),n=!0),t}},_focus:function(e){e[0]!==document.activeElement&&window.setTimeout(function(){var t,n=e[0],r=e.val().length;e.focus(),e.is(":visible")&&n===document.activeElement&&(n.setSelectionRange?n.setSelectionRange(r,r):n.createTextRange&&(t=n.createTextRange(),t.collapse(!1),t.select()))},40)},getCursorInfo:function(e){e=n(e)[0];var t=0,r=0;if("selectionStart"in e)t=e.selectionStart,r=e.selectionEnd-t;else if("selection"in document){e.focus();var i=document.selection.createRange();r=document.selection.createRange().text.length,i.moveStart("character",-e.value.length),t=i.text.length-r}return{offset:t,length:r}},killEvent:function(e){e.preventDefault(),e.stopPropagation()},killEventImmediately:function(e){e.preventDefault(),e.stopImmediatePropagation()},defaultEscapeMarkup:function(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return String(e).replace(/[&<>"'\\]/g,function(e){return t[e]})},local:function(e,t){var i,s,o=e,u=function(e){return""+e.label};n.isArray(o)&&(s=o,o={results:s}),n.isFunction(o)===!1&&(s=o,o=function(){return s});var a=o();return a&&a.text&&(u=a.text,n.isFunction(u)||(i=a.text,u=function(e){return e[i]})),function(e){var i=e.term,s={results:[]};return""!==i||t?(o()&&r.each2(n(o().results),function(n,i){r._processData(e,i,s.results,t,!0,u)}),void e.callback(s)):void e.callback(o())}},cleanupResults:function(e){e.children().remove(),e.removeClass("oj-listbox-result-with-children")},remote:function(e,i){return function(s){var o={},u=this,a=function(e){var t={results:[]};u.inputSearch=o.searchPattern,r.each2(n(e),function(e,n){r._processData(s,n,t.results,i,!1)}),s.callback(t)};if(s.value)a(s.value);else{var f=n.trim(s.term);if(f&&(o.searchPattern="*"!==f?"*"+s.term+"*":f),n.extend(!0,o,{scope:this.defaultScope}),!o.searchPattern)return void a(this.results||[]);this.inputSearch&&this.inputSearch===o.searchPattern?a(this.results):(clearTimeout(this.queryTimer),this.queryTimer=setTimeout(function(){u.loading.hasClass("identity-show-inline")||u.loading.addClass("identity-show-inline"),e(o).then(function(e){u.results=e&&Array.isArray(e)?e:[],a(u.results),u.loading.removeClass("identity-show-inline"),u.ojContext._setOption("messagesCustom",[])})["catch"](function(e){u.loading.removeClass("identity-show-inline"),u.ojContext._setOption("messagesCustom",[new t.Message(e)])})},1e3))}}},_processData:function(e,t,i,s,o,u){var a,f,l={};if(n.extend(!0,l,t[0]),t[0].label&&s&&s.label&&"label"!==s.label&&(l[s.label]=t[0].label,delete l.label),t[0].value&&s&&s.value&&"value"!==s.label&&(l[s.value]=t[0].value,delete l.value),!l.children&&s&&s.children&&(l.children=l[s.children],delete l[s.children]),l.children){a={};for(f in l)l.hasOwnProperty(f)&&(a[f]=l[f]);a.children=[],r.each2(n(l.children),function(t,n){r._processData(e,n,a.children,s&&s.childKeys?s.childKeys:null,o,u)}),(!o||a.children.length||e.matcher(e.term,a[s.label],l))&&i.push(a)}else o&&!e.matcher(e.term,l[s.label],l)||i.push(l)},clazz:function(e,r){var i=function(){};return t.Object.createSubclass(i,e,""),i.prototype=n.extend(i.prototype,r),i},LAST_QUERY_RESULT:"last-query-result",getLastQueryResult:function(e){var t=n.data(e.container,e._classNm+"-"+r.LAST_QUERY_RESULT);return t},saveLastQueryResult:function(e,t){n.data(e.container,e._classNm+"-"+r.LAST_QUERY_RESULT,t)}},i=r.clazz(Object,{_bind:function(e){var t=this;return function(){e.apply(t,arguments)}},_init:function(e){var t,i,s=this._classNm,o=this._elemNm,u=".oj-listbox-results";this.ojContext=e.ojContext,this.opts=e=this._prepareOpts(e),this.id=e.id,this.headerInitialized=!1,void 0!==e.element.data(o)&&null!==e.element.data(o)&&e.element.data(o)._destroy(),this.container=this._createContainer();var a=this.opts.rootAttributes;this.containerId=a&&a.id?a.id:"ojChoiceId_"+(e.element.attr("id")||"autogen"+r.nextUid()),this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.body=r.thunk(function(){return n("#__oj_zorder_container").size()?n("#__oj_zorder_container"):e.element.closest("body")}),this.container.attr("style",e.element.attr("style")),this.elementTabIndex=this.opts.element.attr("tabindex"),this.opts.showScopeFilter&&(this.container.addClass("hasFilter"),this.container.find(".oj-identity-filter").addClass("showFilter")),this.opts.element.data(o,this).attr("tabindex","-1").before(this.container),this.container.data(o,this),this.dropdown=this.container.find(".oj-listbox-drop"),this.dropdown.data("ojlistbox",this),this.opts.showScopeFilter&&this.container.on("click",".oj-identity-filter",n.proxy(this._showFilter,this)),this.opts.loading=this.container.find(".oj-identity-loading-container");var f=this.containerId;if(this.dropdown.attr("data-oj-containerid",f),this.results=t=this.container.find(u),this.results.on("click",r.killEvent),e.list&&n("#"+e.list).is("ul")){var l=n("#"+e.list);this.dropdownListParent=l.parent(),l.addClass("oj-listbox-results").attr("role","listbox"),this.results.replaceWith(l),this.results=t=this.container.find(u),this.results.css("display","")}i="oj-select"==s?this.container.find("input.oj-listbox-input"):this.container.find("input."+s+"-input"),this.search=i,this.queryCount=0,this.resultsPage=0,this.context=null,this._initContainer(),this.container.on("click",r.killEvent),r.installFilteredMouseMove(this.results),this.dropdown.on("mousemove-filtered touchstart touchmove touchend",u,this._bind(this._highlightUnderEvent)),n(this.container).on("change","."+s+"-input",function(e){e.stopPropagation()}),n(this.dropdown).on("change","."+s+"-input",function(e){e.stopPropagation()});var c=this;r.installKeyUpChangeEvent(i),i.on("keyup-change input paste",this._bind(this._updateResults)),i.on("focus",function(){i.addClass(s+"-focused"),"oj-select"!==s&&c.container.addClass("oj-focus")}),i.on("blur",function(){i.removeClass(s+"-focused"),"oj-select"!==s&&c.container.removeClass("oj-focus")}),this.dropdown.on("mouseup",u,this._bind(function(e){var t=n(e.target);if(this._selectionEvent=e,t.closest(".oj-listbox-result-selectable").length>0)if(this.opts.multiple&&this.opts.selectAll&&t.hasClass("oj-identity-checkbox")){var i=this.getVal(),s=t.closest(".oj-listbox-result").data(this._elemNm),o=i?i.slice(0):[],u={optionMetadata:{trigger:r.ValueChangeTriggerTypes.OPTION_SELECTED}};t.hasClass("selected")?(o.splice(this.opts.indexOf.call(o,s),1),u.optionMetadata.trigger=r.ValueChangeTriggerTypes.OPTION_REMOVED,t.attr("checked",!1)):o.push(s),this.opts.contains.call(this.opts.results,o)?this.opts.checkAll.addClass("selected"):this.opts.checkAll.removeClass("selected"),t.toggleClass("selected"),this.setVal(o,e,u)}else this._highlightUnderEvent(e),this._selectHighlighted(null,e);else if(this.opts.multiple&&this.opts.selectAll&&t.hasClass("oj-identity-checkbox")){var a=t.parent().nextAll().find(".oj-identity-checkbox"),f=this,i=this.getVal(),o=i?i.slice(0):[],u={optionMetadata:{trigger:r.ValueChangeTriggerTypes.OPTION_SELECTED}};t.toggleClass("selected");var l=t.hasClass("selected");a.each(function(){var e=n(this.parentNode).data(f._elemNm);l?o.push(e):o.splice(f.opts.indexOf.call(o,e),1)}),l?a.addClass("selected"):(u.optionMetadata.trigger=r.ValueChangeTriggerTypes.OPTION_REMOVED,t.attr("checked",!1),a.removeClass("selected")),this.setVal(o,e,u)}})),this.dropdown.on("click mouseup mousedown",function(e){e.stopPropagation()}),n.isFunction(this.opts.initSelection)&&this._initSelection();var h=e.element.prop("disabled");void 0===h&&(h=!1),this._enable(!h);var p=e.element.prop("readonly");void 0===p&&(p=!1),this._readonly(p),r.scrollBarDimensions=r.scrollBarDimensions||r.measureScrollbar(),this.autofocus=e.element.prop("autofocus"),e.element.prop("autofocus",!1),this.autofocus&&this._focus()},_showFilter:function(e){var t=e.target;if(e=n.Event(e),this._enabled){if(!this.filterDropdown){var i=this,s=this.opts.scopesOptions||[],o=r.nextUid();this.filterDropdown=n('<div class="oj-identity-filter-drop"></div>'),this.filterDropdown.appendTo(document.body),this.filterDropdown.ojPopup(),this.filterDropdown.ojPopup("option",{tail:"none",modality:"modeless"});for(var u=0,a=s.length;u<a;u++){var f=n('<div><input type="radio" name="oj-identity-'+o+'" value="'+s[u].value+'" '+(s[u].value==i.opts.defaultScope?"checked ":"")+"/> "+s[u].label+"</div>");this.filterDropdown.append(f)}this.filterDropdown.on("click","input",function(){i.opts.defaultScope=n(this).val()})}this.filterDropdown.ojPopup("open",t)}},_clickAwayHandler:function(e){var t,r=this.dropdown;n(e.target).closest(r).length||n(e.target).closest("#"+r.attr("data-oj-containerid")).length||r.length>0&&(t=r.data("ojlistbox"),t&&t.close(e))},_surrogateRemoveHandler:function(){this.dropdown&&this.dropdown.remove()},_destroy:function(){var e=this._closeDelayTimer;isNaN(e)||(delete this._closeDelayTimer,window.clearTimeout(e));var t=this.opts.element,n=t.data(this._elemNm);this.close(),this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.opts.list&&this.results&&(this._cleanupList(this.results),this.dropdownListParent&&this.dropdownListParent.append(this.results)),void 0!==n&&(n.container.remove(),n.dropdown.remove(),t.removeAttr("aria-hidden").removeData(this._elemNm).off("."+this._classNm).prop("autofocus",this.autofocus||!1),this.elementTabIndex?t.attr({tabindex:this.elementTabIndex}):t.removeAttr("tabindex"),t.show())},_cleanupList:function(e){if(e&&e.is("ul")){e.removeClass("oj-listbox-results oj-listbox-result-sub"),e.removeAttr("role");for(var t=e.children().length-1;t>=0;t--)this._cleanupList(n(e.children()[t]))}else if(e.is("li")){(e.hasClass("oj-listbox-placeholder")||e.hasClass("oj-listbox-no-results"))&&e.remove(),e.attr("class")&&e.attr("class",e.attr("class").replace(/\oj-listbox-\S+/g,""));var r=e.children(".oj-listbox-result-label");r&&r.contents().unwrap(),"none"==e.css("display")&&e.css("display",""),this._cleanupList(e.children("ul"))}},_optionToData:function(e){if(e.is("option"))return{value:e.prop("value"),label:e.text(),element:e.get(),css:e.attr("class"),disabled:e.prop("disabled"),locked:"locked"===e.attr("locked")||e.data("locked")===!0};if(e.is("optgroup"))return{label:e.attr("label"),children:[],element:e.get(),css:e.attr("class")};if(e.is("li")){var t,n=null,r=e.children();return r&&r.length>0&&r.is("ul")?(t=e.attr("oj-data-label")?e.attr("oj-data-label"):e.clone().children().remove().end().text().trim(),n=[]):t=e.attr("oj-data-label")?e.attr("oj-data-label"):e.text().trim(),{value:e.attr("oj-data-value"),label:t,element:e.get(),css:e.attr("class"),children:n}}},_prepareOpts:function(e){var t,i,o=this;e.options&&Array.isArray(e.options)&&e.optionsKeys&&(e.options=n.extend(!0,[],e.options)),t=e.element;var u=t.get(0).tagName.toLowerCase();return"input"===u&&t.attr("list")?this.datalist=i=n("#"+t.attr("list")):"select"===u&&t.children().length>0?this.datalist=i=t:e.list&&(this.datalist=i=n("#"+e.list)),e=n.extend({},{populateResults:function(t,i,s,o){var u,a=n.proxy(this.opts.id,this),f=this,l=this.opts.optionRenderer;"function"!=typeof l&&(l=null),(u=function(t,i,o,c,h){var p,d,v,m,g,y,w,E,S=function(e,t){if(t.children&&t.children.length>0){var r=t.element&&n(t.element[0]).is("li")&&n(t.element[0]).children("ul"),i=r?n(t.element[0]).children("ul"):n("<ul></ul>");i.hasClass("oj-listbox-result-sub")||i.addClass("oj-listbox-result-sub"),u(t,t.children,i,c+1,!1),r||e.append(i)}},x=function(e,t,n){function r(e,n){var i=0;if(3===e.nodeType){var s=e.data.toUpperCase().indexOf(n);if(s>=0){var o=document.createElement("span");o.className=t;var u=e.splitText(s),a=(u.splitText(n.length),u.cloneNode(!0));o.appendChild(a),u.parentNode.replaceChild(o,u),i=1}}else if(1===e.nodeType&&e.childNodes&&!/(script|style)/i.test(e.tagName))for(var f=0;f<e.childNodes.length;++f)f+=r(e.childNodes[f],n);return i}e.length&&n&&n.length&&e.each(function(){r(this,n.toUpperCase())})},T=function(n,r){if(l){var i={index:p,depth:c,leaf:!r.children,parent:t,data:r,component:e.ojContext,parentElement:n.get(0)},o=l.call(e.ojContext,i);null!==o&&(null===o.parentNode||o.parentNode instanceof DocumentFragment)&&n.appendChild(o)}else E=e.formatResult(r),void 0!==E&&n.text(E);if(s.initial!==!0){var u=n.find(".oj-listbox-highlighter-section");u.length||(u=n),x(u,"oj-listbox-highlighter",s.term)}},N=function(t){e._placeholderData||(v={},v[e.optionsKeys.label]=t,e.optionsKeys.label!==e.optionsKeys.value&&(v[e.optionsKeys.value]=""),e._placeholderData=v),y=n("<li></li>"),y.addClass("oj-listbox-placeholder oj-listbox-results-depth-0 oj-listbox-result oj-listbox-result-selectable"),y.attr("role","presentation"),w=n(document.createElement("div")),w.addClass("oj-listbox-result-label"),w.attr("id","oj-listbox-result-label-"+r.nextUid()),w.attr("role","option"),w.text(e._placeholderData[e.optionsKeys.label]),y.append(w),y.data(f._elemNm,e._placeholderData),o.prepend(y)},C=f._getPlaceholder(),L=f.getVal();L&&0!==L.length&&(h&&C&&!s.term?N(C):e.multiple||(N(""),e.placeholder=""));var A=e.multiple&&e.selectAll;if(e.results=i,L=f.getVal(),A){var O=n("<li class='oj-listbox-results-depth-0' role='presentation'></li>"),M=r.nextUid(),_=n(document.createElement("input")),D=!1;L&&Array.isArray(L)&&(D=e.contains.call(i,L));var P=n(document.createElement("span"));P.addClass("oj-listbox-result-label"),P.attr("id","oj-listbox-result-label-"+M),P.attr("role","option"),P.text(e.selectLabel),_.attr({id:"oj-checkbox-"+M,"class":"oj-identity-checkbox",type:"checkbox",checked:D});var H=n(document.createElement("label"));H.attr({"for":"oj-checkbox-"+M,"class":"oj-identity-checkbox"+(D?" selected":""),"aria-label":D?"selected":"unselected"}),e.checkAll=H,O.append([H,P]),o.prepend(O)}var B=!!e.resultTemplateKeys&&!!Array.isArray(e.resultTemplateKeys);for(p=0,d=i.length;p<d;p+=1){v=i[p],g=v.disabled===!0,m=!g&&void 0!==a(v);var F=v.element&&n(v.element[0]).is("li");if(y=n(F?v.element[0]:"<li></li>"),y.hasClass("oj-listbox-result"))v.children&&v.children.length>0&&S(y,v),n(v.element[0]).css("display","");else{var I=r.nextUid();if(y.addClass("oj-listbox-results-depth-"+c),y.addClass("oj-listbox-result"),y.addClass(m?"oj-listbox-result-selectable":"oj-listbox-result-unselectable"),g&&y.addClass("oj-disabled"),v.children&&y.addClass("oj-listbox-result-with-children"),y.attr("role","presentation"),A){var D=!1;L&&Array.isArray(L)&&(D=e.indexOf.call(L,v)!==-1);var H=n(document.createElement("label"));H.attr({"for":"oj-checkbox-"+I,"class":"oj-identity-checkbox"+(D?" selected":""),"aria-label":D?"selected":"unselected"}),y.append(H)}var q=v.identityType?v.identityType:"";if(q||(q=v.type||""),q){var R=n(document.createElement("span"));R.attr("class","oj-identity-type "+q),y.append(R)}if(w=n(document.createElement("div")),w.addClass("oj-listbox-result-label"),w.attr("id","oj-listbox-result-label-"+I),w.attr("role","option"),g&&w.attr("aria-disabled","true"),!F){if(T(w,v),B)for(var U=e.resultTemplateKeys,z=0,W=U.length;z<W;z++)v.hasOwnProperty(U[z])&&v[U[z]]&&w.append([n("<span> | </span>"),n("<span class='info'> "+v[U[z]]+"</span>")]);else v.email&&w.append([n("<span> | <span>"),n("<span class='info'> "+v.email+"</span>")]);w[0].title=w.text(),y.append(w)}v.children&&v.children.length>0&&S(y,v),y.data(f._elemNm,v),F?(n(v.element[0]).contents().filter(function(){return"UL"!==this.tagName}).wrapAll(w),n(v.element[0]).css("display","")):o.append(y)}}})(null,i,t,0,o)}},s,e),e.id=function(e){return e[this.opts.optionsKeys.value]},e.formatResult=function(e){return isNaN(e[this.optionsKeys.label])?e[this.optionsKeys.label]:this.ojContext._formatValue(e[this.optionsKeys.label])},e.formatSelection=function(e){return e&&e[this.optionsKeys.label]?isNaN(e[this.optionsKeys.label])?e[this.optionsKeys.label]:this.ojContext._formatValue(e[this.optionsKeys.label]):void 0},"select"!==u&&null!==e.manageNewEntry&&(e.manageNewEntry=function(t){var r={};return r[e.optionsKeys.value]=r[e.optionsKeys.label]=n.trim(t),r}),i?e.query=this._bind(function(e){var t,n,s={results:[],more:!1},u=e.term;n=function(t,i){var s,a=t.children()&&t.children().length>0&&t.children().is("ul");t.is("option")||t.is("li")&&!a?e.matcher(u,t.text(),t)&&i.push(o._optionToData(t)):(t.is("optgroup")||t.is("li")&&a)&&(s=o._optionToData(t),r.each2(t.is("optgroup")?t.children():t.children("ul").children(),function(e,t){n(t,s.children)}),s.children.length>0&&i.push(s))},t=i.children(),void 0!==this._getPlaceholder()&&t.length>0&&""==t.first().attr("value")&&(t=t.slice(1)),r.each2(t,function(e,t){n(t,s.results)}),e.callback(s)}):"options"in e&&(n.isFunction(e.options)?e.query=r.remote(e.options,e.optionsKeys?e.optionsKeys:null):e.query=r.local(e.options,e.optionsKeys?e.optionsKeys:null)),e},_createHeader:function(){var e=this.opts.element.find(".oj-listbox-header");if(e.length){this.header=n("<li>",{"class":"oj-listbox-result-header oj-listbox-result-unselectable",role:"presentation"}),this.header.append(e.children()),this._initializeHeaderItems();var t=n("<ul>",{"class":"oj-listbox-results-with-header",role:"listbox"});t.append(this.header),t.appendTo(this.results.parent());var r=n("<li>",{role:"presentation"});t.append(r),this.results.attr("role","presentation"),this.results.appendTo(r)}this.headerInitialized=!0},_initializeHeaderItems:function(){this.headerItems=this.header.find("li[role='option'], li:not([role])"),this.headerItems.uniqueId(),this.header.find("ul").attr("role","presentation"),this.header.find("li:not([role])").attr("role","option");var e="a, input, select, textarea, button, object, .oj-component-initnode";this.header.find(e).each(function(){n(this).attr("tabIndex",-1)})},_isHeaderItem:function(e){var t=!1;return this.headerItems.each(function(){if(n(this).attr("id")===e)return t=!0,!1}),t},_getNextHeaderItem:function(e){if(!this.headerItems)return null;if(!e)return this.headerItems.first();var t=!1,r=null;return this.headerItems.each(function(){return t?(r=n(this),!1):void (t=n(this).attr("id")===e)}),r},_getPreviousHeaderItem:function(e){if(!this.headerItems)return null;var t=null;return this.headerItems.each(function(){return n(this).attr("id")!==e&&void (t=n(this))}),t},_setFocusOnHeaderItem:function(e){var t=e.find(".oj-component .oj-enabled").first();if(0===t.length){var n="a, input, select, textarea, button, object, .oj-component-initnode";t=e.find(n).first(),0===t.length&&(t=e.children().first())}t&&t.addClass("oj-focus")},_removeHighlightFromHeaderItems:function(){this.headerItems&&this.headerItems.find(".oj-focus").removeClass("oj-focus")},_triggerSelect:function(e){var t=n.Event(this._elemNm+"-selecting",{val:this.id(e),object:e});return this.opts.element.trigger(t),!t.isDefaultPrevented()},_isInterfaceEnabled:function(){return this.enabledInterface===!0},_enableInterface:function(){var e=this._enabled&&!this._readonly,t=!e;return e!==this.enabledInterface&&(this.container.toggleClass("oj-disabled",t),this.close(),this.enabledInterface=e,!0)},_enable:function(e){void 0===e&&(e=!0),this._enabled!==e&&(this._enabled=e,this.opts.element.prop("disabled",!e),this.container.toggleClass("oj-enabled",e),this.container.find(".oj-identity-filter").toggleClass("disabled-filter",!e),this._enableInterface())},_disable:function(){this._enable(!1)},_readonly:function(e){return void 0===e&&(e=!1),this._readonly!==e&&(this._readonly=e,this.opts.element.prop("readonly",e),this._enableInterface(),!0)},_opened:function(){return this.container.hasClass("oj-listbox-dropdown-open")},_usingHandler:function(e,t){if(d(t))return void (this._closeDelayTimer=window.setTimeout(n.proxy(this.close,this),1));var r=this.container,i=t.element.element;i.css(e),"bottom"===t.vertical?(r.addClass("oj-listbox-drop-above"),i.addClass("oj-listbox-drop-above")):(r.removeClass("oj-listbox-drop-above"),i.removeClass("oj-listbox-drop-above"))},_getDropdownPosition:function(){var e={my:"start top",at:"start bottom",of:this.container.children().first(),collision:"flip",using:n.proxy(this._usingHandler,this)},t="rtl"===c();return v(e,t)},_positionDropdown:function(){this.dropdown.css("width",this.container.outerWidth()),this.dropdown.position(this._getDropdownPosition())},_shouldOpen:function(e){if(this._opened())return n.isFunction(this.opts.options);if(this._enabled===!1||this._readonly===!0)return!1;var t={component:this.opts.element};return this.ojContext._trigger("beforeExpand",e,t)},_clearDropdownAlignmentPreference:function(){this.container.removeClass("oj-listbox-drop-above"),this.dropdown.removeClass("oj-listbox-drop-above")},open:function(e,t){return!!this._shouldOpen(e)&&(this._opening(e,t),!0)},_opening:function(){this.headerInitialized||this._createHeader(),this.container.addClass("oj-listbox-dropdown-open")},_showDropDown:function(){if(this._opened()){this.windowEventBind=n.proxy(this._positionDropdown,this),this.documentEventBind=n.proxy(this._clickAwayHandler,this),window.addEventListener("resize",this.windowEventBind,!0),window.addEventListener("scroll",this.windowEventBind,!0),document.documentElement.addEventListener("mousedown",this.documentEventBind,!0);var e=this._getActiveContainer().attr("aria-expanded");if("true"!==e){this._clearDropdownAlignmentPreference(),this.dropdown[0]!==this.body().children().last()[0]&&this.dropdown.detach().appendTo(this.body()),this.dropdown.appendTo(this.body()),this.header&&(this.dropdown.find(".oj-listbox-results-with-header").prepend(this.header),this.header.show()),this.dropdown.position(this._getDropdownPosition()).show(),n("#oj-listbox-drop").removeAttr("id"),this.dropdown.attr("id","oj-listbox-drop");var t=this.containerId;this.dropdown.attr("data-oj-containerid",t),this._positionDropdown(),this._getActiveContainer().attr("aria-expanded",!0)}}},close:function(e){if(this._opened()){if(this._selectionEvent&&this._selectionEvent.target&&n(this._selectionEvent.target).hasClass("oj-identity-checkbox"))return void (this._selectionEvent=null);this.container.removeClass("oj-listbox-dropdown-open");var t=this._getActiveContainer().attr("aria-expanded");if(t&&"false"!==t){window.removeEventListener("resize",this.windowEventBind,!0),window.removeEventListener("scroll",this.windowEventBind,!0),document.documentElement.removeEventListener("mousedown",this.documentEventBind,!0);var r=this.containerId,i="scroll."+r,s="resize."+r,o="orientationchange."+r;this.container.parents().add(window).each(function(){n(this).off(i).off(s).off(o)}),this._clearDropdownAlignmentPreference(),this.header&&(this.header.hide(),this.header.appendTo(this.container)),this.dropdown.removeAttr("data-oj-containerid"),this.dropdown.removeAttr("id"),this.opts.list?this._removeHighlight():(this.dropdown.detach(),this.results.empty()),this._getActiveContainer().attr("aria-expanded",!1),this.ojContext._IsRequired()&&this.ojContext.validate()}}},_clearSearch:function(){},_ensureHighlightVisible:function(){var e,t,r,i,s,o,u,a=this.results;if(t=this._highlight(),!(t<0)){if(0==t)return void a.scrollTop(0);e=this._findHighlightableChoices().find(".oj-listbox-result-label"),r=n(e[t]),i=r.offset().top+r.outerHeight(!0),t===e.length-1&&(u=a.find("li.oj-listbox-more-results"),u.length>0&&(i=u.offset().top+u.outerHeight(!0))),s=a.offset().top+a.outerHeight(!0),i>s&&a.scrollTop(a.scrollTop()+(i-s)),o=r.offset().top-a.offset().top,o<0&&"none"!=r.css("display")&&a.scrollTop(a.scrollTop()+o)}},_findHighlightableChoices:function(){return this.results.find(".oj-listbox-result-selectable:not(.oj-disabled, .oj-selected)").filter(function(){return"none"!=n(this).css("display")})},_moveHighlight:function(e){var t=this._findHighlightableChoices(),r=this._highlight();if(this.header&&(r<=0||r===t.length-1)){var i=this._getActiveContainer().attr("aria-activedescendant"),s=this._isHeaderItem(i);s||(i=null);var o=null;if(e>0&&(r<0||r===t.length-1)?o=this._getNextHeaderItem(i):e<0&&(s&&r<0||0===r)&&(o=this._getPreviousHeaderItem(i)),o)return this._removeHighlight(),this._setFocusOnHeaderItem(o),void this._getActiveContainer().attr("aria-activedescendant",o.attr("id"));s&&e<0&&(r=0)}for(;r>=-1&&r<t.length;){r+=e,r==t.length?r=0:r==-1&&(r=t.length-1);var u=n(t[r]);if(u.hasClass("oj-listbox-result-selectable")&&!u.hasClass("oj-disabled")&&!u.hasClass("oj-selected")){this._highlight(r);break}}},_highlight:function(e){var t,r=this._findHighlightableChoices();if(0===arguments.length){var i=r.filter(".oj-hover");return i.length||(i=r.children(".oj-hover").closest(".oj-listbox-result")),r.get().indexOf(i[0])}e>=r.length&&(e=r.length-1),e<0&&(e=0),this._removeHighlight(),t=n(r[e]),t.hasClass("oj-listbox-result-with-children")?t.children(".oj-listbox-result-label").addClass("oj-hover"):t.addClass("oj-hover"),this._getActiveContainer().attr("aria-activedescendant",t.find(".oj-listbox-result-label").attr("id")),this._ensureHighlightVisible()},_removeHighlight:function(){this.results.find(".oj-hover").removeClass("oj-hover"),this._removeHighlightFromHeaderItems()},_highlightUnderEvent:function(e){var t=n(e.target).closest(".oj-listbox-result-selectable");if(t.length>0&&!t.is(".oj-hover")){var r=this._findHighlightableChoices();this._highlight(r.index(t))}else 0==t.length&&this._removeHighlight()},_updateResults:function(e){var t=this.search,i=this,s=t.val(),o=n.data(this.container,this._classNm+"-last-term");if((e===!0||!o||s!==o)&&(o||s||!e||"input"!==e.type)){n.data(this.container,this._classNm+"-last-term",s);var u=this.opts.minLength||0;s.length>=u?(clearTimeout(this.queryTimer),e&&e!==!0?this.queryTimer=setTimeout(function(){i._queryResults(e)},r.DEFAULT_QUERY_DELAY):this._queryResults(e)):this.close()}},_queryResults:function(e){function t(){if(f._positionDropdown(),f.header&&f.headerItems.length){var e=f._findHighlightableChoices(),t=f.headerItems.length+e.length;if(f.headerItems.attr("aria-setsize",t),e.length){var n=e.children("[role='option']");n.attr("aria-setsize",t),n.first().attr("aria-posinset",f.headerItems.length+1)}}}var i,s,o=this.search,u=this.results,a=this.opts,f=this,l=o.val(),c=a.minLength||0;return c>l.length?void this.close():(this.open(null,!0),s=++this.queryCount,this._removeHighlight(),i=this.search.val(),l=void 0!==i&&null!==i&&(e!==!0||a.inputSearch||a.minLength>0)?i:"",this.resultsPage=1,void a.query({element:a.element,term:l,page:this.resultsPage,context:null,matcher:a.matcher,callback:this._bind(function(i){if(this._opened())if(this.context=i&&void 0!==i.context?i.context:null,i&&0!==i.results.length)r.saveLastQueryResult(this,i.results),this._showDropDown(),this._preprocessResults(u),f.opts.populateResults.call(this,u,i.results,{term:o.val(),page:this.resultsPage,context:null,initial:e},this._showPlaceholder()),this._postprocessResults(i,e),t();else if("oj-select"===this._classNm&&this.opts.multiple!==!0||this.opts.inputSearch&&""!==n.trim(this.opts.inputSearch)||this.header){var s=n("<li>");s.addClass("oj-listbox-no-results"),s.text(a.noMatchesFound),this._showDropDown(),this._preprocessResults(u),u.append(s),t()}})}))},_preprocessResults:function(e){if(this.opts.list){var t=e.children();this._hideResultList(t)}else e.empty()},_hideResultList:function(e){for(var t=0;t<e.length;t++){n(e[t]).is("LI")&&((n(e[t]).hasClass("oj-listbox-no-results")||n(e[t]).hasClass("oj-listbox-placeholder"))&&n(e[t]).remove(),n(e[t]).css("display","none"),n(e[t]).hasClass("oj-selected")&&n(e[t]).removeClass("oj-selected"));var r=n(e[t]).children("ul");r&&r.children()&&this._hideResultList(r.children())}},_cancel:function(e){this.close(e)},_focusSearch:function(){r._focus(this.search)},_selectHighlighted:function(e,t){if(this.header){var i=this._getActiveContainer().attr("aria-activedescendant");if(this._isHeaderItem(i)){var s=n("#"+i),o="a, input, select, textarea, button, object",u=s.find(o).first();return 0===u.length&&(u=s.children()),u.length&&u[0].click(),void this.close(t)}}var a=this._highlight(),f=this.results.find(".oj-hover"),l=f.closest(".oj-listbox-result").data(this._elemNm);l?(this._highlight(a),e=e||{},e.trigger=r.ValueChangeTriggerTypes.OPTION_SELECTED,l!==this.opts._placeholderData?this._onSelect(l,e,t):this._onSelect([],e,t)):e&&e.noFocus&&this.close(t)},_getPlaceholder:function(){return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder},_setPlaceholder:function(){var e=this._getPlaceholder();e&&(this.search.attr("placeholder",e),this.container.removeClass(this._classNm+"-allowclear"))},_initContainerWidth:function(){function e(){var e,t,n,r,i,s;if(e=this.opts.element.attr("style"),void 0!==e)for(t=e.split(";"),r=0,i=t.length;r<i;r+=1)if(s=t[r].replace(/\s/g,""),n=s.match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i),null!==n&&n.length>=1)return n[1]}var t=e.call(this);null!==t&&this.container.css("width",t)},getVal:function(){return this.ojContext.option("value")},setVal:function(e,t,n){var r={doValueChangeCheck:!1};n&&(r._context=n),"string"!=typeof e&&Array.isArray(e)||(e=[e]),this.opts.element.val(0!==e.length?e:null),this.ojContext._updateValue(e,t,r)},_showPlaceholder:function(){return!1},_getActiveContainer:function(){return this.search},_hasSearchBox:function(){return void 0!==this.opts.minimumResultsForSearch&&void 0!==this.container._hasSearchBox},_findItem:function(e,t){for(var r=0;r<e.length;r++)if(n(e[r]).data(this._elemNm).value===t)return e[r];return null}}),s={closeOnSelect:!0,openOnEnter:!0,id:function(e){return e.id},matcher:function(e,t){return(""+t).toUpperCase().indexOf((""+e).toUpperCase())>=0},separator:","},o=r.clazz(i,{_enableInterface:function(){o.superclass._enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this._isInterfaceEnabled())},_focus:function(){this._opened()&&this.close()},_destroy:function(){n("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id")),o.superclass._destroy.apply(this,arguments)},_clear:function(e){this.selection.data(this._elemNm),this.search.val(""),this.selection.removeData(this._elemNm),this._setPlaceholder()},_initSelection:function(){var e=this.opts.element;this.opts.initSelection.call(null,e,this._bind(this._updateSelectedOption))},_containerKeydownHandler:function(e){if(this._isInterfaceEnabled()){if(e.which===r.KEY.PAGE_UP||e.which===r.KEY.PAGE_DOWN)return void r.killEvent(e);switch(e.which){case r.KEY.UP:case r.KEY.DOWN:return this._opened()?this._moveHighlight(e.which===r.KEY.UP?-1:1):this.open(e),void r.killEvent(e);case r.KEY.ENTER:return this._selectHighlighted(null,e),r.killEvent(e),void (this._opened()||(this._userTyping=!1));case r.KEY.TAB:return this.close(e),void (this._userTyping=!1);case r.KEY.ESC:return this._opened()&&(this._cancel(e),r.killEvent(e)),void (this._userTyping=!1)}this._userTyping=!0}},_containerKeyupHandler:function(e){this._isInterfaceEnabled()&&(this._opened()||this.open(e))},_initContainer:function(){var e,t,i=this.container,s=(this.dropdown,this.opts.rootAttributes),o=s&&s.id?s.id:this.opts.element.attr("id")||r.nextUid();this.selection=e=i.find("."+this._classNm+"-choice"),e.attr("id",this._classNm+"-choice-"+o),t=n("label[for='"+this.opts.element.attr("id")+"']"),t.attr("id")||t.attr("id",this._classNm+"-label-"+o),e.find("."+this._classNm+"-input").attr("id",this._classNm+"-input-"+o),this.results.attr("id")||this.results.attr("id","oj-listbox-results-"+o),this.search.attr("aria-owns",this.results.attr("id")),this.search.attr("aria-labelledby",t.attr("id")),this.opts.element.attr("aria-labelledby",t.attr("id")),this.search.attr("id")&&t.attr("for",this.search.attr("id")),this.opts.element.attr("aria-label")&&this.search.attr("aria-label",this.opts.element.attr("aria-label")),this.opts.element.attr("aria-controls")&&this.search.attr("aria-controls",this.opts.element.attr("aria-controls")),e.on("keydown",this._bind(this._containerKeydownHandler)),e.on("mousedown","abbr",this._bind(function(e){this._isInterfaceEnabled()&&(this._clear(e),r.killEventImmediately(e),this.close(e),this.selection.focus())})),e.on("mousedown",this._bind(function(e){this.opts.element.prop("disabled")&&r.killEvent(e),this._opened()?this.close(e):this._isInterfaceEnabled()&&this.open(e);var t=this.search.parent().attr("aria-hidden");t&&"true"==t?this.selection.focus():this.search.focus(),this.container.addClass("oj-active")})),e.on("mouseup",this._bind(function(e){this.container.removeClass("oj-active")})),e.on("focus",this._bind(function(e){r.killEvent(e)})),this.search.on("blur keyup",this._bind(function(e){if("keyup"!==e.type||10===e.keyCode||13===e.keyCode){if(void 0!==this.search.val()&&this.results.find(".oj-hover").length<=0)if(this.opts.manageNewEntry){var t=this.selection.data(this._elemNm);if(!t&&""!==this.search.val()||t&&(t.label!==this.search.val()||!this.ojContext.isValid())){var n=this.opts.manageNewEntry(this.search.val()),i="blur"===e.type?r.ValueChangeTriggerTypes.BLUR:r.ValueChangeTriggerTypes.ENTER_PRESSED,s={trigger:i};this._onSelect(n,s,e)}}else if(null==this.opts.manageNewEntry){var n=this.selection.data(this._elemNm);if(""==this.search.val())this._clear(e);else if("oj-select"!==this._classNm){var o=this.opts.formatSelection(n);void 0!==o&&this.search.val(o)}}this.search.removeClass(this._classNm+"-focused"),this.container.removeClass("oj-focus")}})),this._initContainerWidth(),this.opts.element.hide().attr("aria-hidden",!0),this._setPlaceholder()},_prepareOpts:function(){var e=o.superclass._prepareOpts.apply(this,arguments),t=this,i=this.getVal(),s=e.element.get(0).tagName.toLowerCase();if("input"===s&&e.element.attr("list")||"select"===s&&e.element.children().length>0||e.list){var u=e.list?"li":"option";e.initSelection=function(e,n){var r,i=t.getVal();Array.isArray(i)&&(i=i[0]),r=void 0!==i&&null!==i?t._optionToData(e.find(u).filter(function(){return"li"==u?this.getAttribute("oj-data-value")===i:"option"==u?this.value===i:void 0})):t._optionToData(e.find(u).filter(function(){return"li"==u?this.getAttribute("oj-data-selected")===!0:"option"==u?this.selected:void 0})),n(r)},e.validate=function(e,n){var r;return void 0!==n&&null!==n&&(r=t._optionToData(e.find(u).filter(function(){return"li"==u?this.getAttribute("oj-data-value")===n:"option"==u?this.value===n:void 0}))),!!r}}else("options"in e||i&&i.length>0)&&(n.isFunction(e.options)?(e.initSelection=function(s,o){var u=function(e,t){for(var n=0,r=e.length;n<r;n++){var i=e[n];if(JSON.stringify(t)===JSON.stringify(i))return i;if(i.children){var s=u(i.children,t);if(s)return s}}return null};i=t.getVal();var a="";i&&i.length&&(a=i[0]);var f=null;if(!a)return void o(f);var l=r.getLastQueryResult(t);if(l&&(f=u(l,a)),!f){var c=t.currentItem;c&&c.length&&a===c[0]&&(f=c[0])}f||t.valueChangeTrigger?o(f):e.query({value:[a],callback:n.isFunction(o)?function(e){e&&e.results&&(f=u(e.results,a)),o(f)}:n.noop})},e.validate||(e.validate=function(e,t){return!0})):(e.initSelection=function(r,o){var u="";i=t.getVal(),i&&i.length&&(u=i[0]);var a="select"==s&&t.ojContext._HasPlaceholderSet()&&!t.ojContext._IsRequired(),f=a?t._getPlaceholder():null,l=null;e.query({matcher:function(e,t,n){var r=JSON.stringify(u)===JSON.stringify(n);return r&&(l=n),null==f&&(f=n),r},callback:n.isFunction(o)?function(){l||"select"!==s||(l=f),o(l)}:n.noop})},e.validate=function(t,r){var i=r,s=null;return e.query({matcher:function(e,t,n){var r=JSON.stringify(i)===JSON.stringify(n);return r&&(s=n),r},callback:n.noop}),!!s}));return e},_postprocessResults:function(e,t,n){var i,s=-1,o=this;i=this._findHighlightableChoices(),r.each2(i,function(e,t){var n=o.getVal();if(n&&n[0]===o.id(t.data(o._elemNm)))return s=e,!1}),n!==!1&&t===!0&&s>=0&&this._highlight(s)},_onSelect:function(e,t,n){if(this._triggerSelect(e)){var r;t&&t.trigger&&(r={optionMetadata:{trigger:t.trigger}}),this.setVal(e?e:[],n,r),this.close(n),this._focusSearch()}},_clearSearch:function(){this.search.val("")}}),u=r.clazz(o,{_elemNm:"ojidentity",_classNm:"oj-select",_userTyping:!1,_createContainer:function(){var e=n(document.createElement("div")).attr({"class":"oj-identity oj-select oj-component"}).html(["<div class='oj-select-choice' tabindex='0' role='combobox' ","     aria-autocomplete='none' aria-expanded='false' aria-ready='true'>","  <span class='oj-select-chosen'></span>","  <abbr class='oj-select-search-choice-close' role='presentation'></abbr>","  <a class='oj-select-arrow oj-component-icon oj-clickable-icon-nocontext oj-select-open-icon' role='presentation'>","</a></div>","<span class='oj-identity-filter'></span>","<div class='oj-listbox-drop oj-identity-container' style='display:none' role='presentation'>","  <div class='oj-listbox-search-wrapper'>","  <div class='oj-listbox-search'>","    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off'","           spellcheck='false' class='oj-listbox-input' title='Search field' ","           role='combobox' aria-expanded='false' aria-autocomplete='list' />","    <span class='oj-listbox-spyglass-box'>","      <span class='oj-component-icon oj-clickable-icon-nocontext oj-listbox-search-icon' role='presentation'>","       <b role='presentation'></b></span>","    </span>","    <span class='oj-identity-loading-container oj-select-loading'>","      <span class='oj-identity-loading' role='presentation'>","       &nbsp;</span>","    </span>","  </div>","  </div>","   <ul class='oj-listbox-results' role='listbox'>","   </ul>","</div>"].join(""));return e},_enable:function(e){u.superclass._enable.apply(this,arguments),this._enabled?(this.container.find(".oj-select-choice").attr("tabindex","0"),this.container.find(".oj-select-arrow").removeClass("oj-disabled")):(this.container.find(".oj-select-choice").attr("tabindex","-1"),this.container.find(".oj-select-arrow").addClass("oj-disabled"))},close:function(e){this._opened()&&(u.superclass.close.apply(this,arguments),this.container.find(".oj-select-choice").attr("aria-expanded",!1),this._testClear(e)||this._clearSearch(),e instanceof MouseEvent&&e.target!=this.selection&&e.target!=this.search||r._focus(this.selection),this.container.find(".oj-listbox-spyglass-box").off("mouseup click"))},_opening:function(e,t){u.superclass._opening.apply(this,arguments);var n;e&&"keydown"==e.type&&e.which!=r.KEY.UP&&e.which!=r.KEY.DOWN&&e.which!=r.KEY.LEFT&&e.which!=r.KEY.RIGHT&&(n=String.fromCharCode(e.which),r.killEvent(e)),this._opened()&&(n=this.search.val()),this._showSearchBox(n),t||(n?this._updateResults():this._updateResults(!0))},_showDropDown:function(){if(this._opened()){u.superclass._showDropDown.apply(this,arguments),this.container.find(".oj-select-choice").attr("aria-expanded",!0);var e,t,n;this._hasSearchBox()&&(e=this.search.get(0),e.createTextRange?(t=e.createTextRange(),t.collapse(!1),t.select()):e.setSelectionRange&&(n=this.search.val().length,e.setSelectionRange(n,n)))}},_initContainer:function(){var e=this.containerId+"_selected";this.text=this.container.find(".oj-select-chosen").attr("id",e),u.superclass._initContainer.apply(this,arguments),this.container.find(".oj-select-choice").attr({"aria-owns":this.search.attr("aria-owns"),"aria-labelledby":this.search.attr("aria-labelledby"),"aria-describedby":e});var t=this.opts.element.attr("aria-label");t&&this.selection.attr("aria-label",t),this.search.on("keydown",this._bind(this._containerKeydownHandler)),this.search.on("keyup-change input",this._bind(this._containerKeyupHandler));var n=this;this.selection.on("blur",function(e){n._testClear(e)})},_initSelection:function(){this._isPlaceholderOptionSelected()?(this._updateSelection(null),this.close(),this._setPlaceholder()):u.superclass._initSelection.apply(this,arguments)},_updateSelectedOption:function(e){if(void 0!==e&&null!==e){var t=this.getVal();t=Array.isArray(t)?t[0]:t,JSON.stringify(t)!==JSON.stringify(e)&&(void 0===t||null===t?this.ojContext.options.value=Array.isArray(e)?e:[e]:this.setVal(Array.isArray(e)?e:[e])),this._updateSelection(e),this.close()}},_updateSelection:function(e){this.selection.data(this._elemNm,e),null!==e&&this.text.text(e[this.opts.optionsKeys.label]),e&&""!=e.id&&this.text.removeClass(this._classNm+"-default"),this.opts.allowClear&&this.container.addClass(this._classNm+"-allowclear")},_getActiveContainer:function(){var e=this.search.attr("aria-expanded");return e&&this._hasSearchBox()?this.search:this.selection},_isPlaceholderOptionSelected:function(){if(null===this._getPlaceholder())return!1;var e=this.getVal();return e=Array.isArray(e)?e[0]:e,""===e||void 0===e||null===e},_getPlaceholder:function(){return this.opts.placeholder},_showPlaceholder:function(){return!0},_setPlaceholder:function(){var e=this._getPlaceholder();this._isPlaceholderOptionSelected()&&void 0!==e&&(void 0===e&&(e=""),this.text.text(e).addClass(this._classNm+"-default"),this.container.removeClass(this._classNm+"-allowclear"))},setVal:function(e,t,n){u.superclass.setVal.call(this,e,t,n),this.selection.data("selectVal",e)},_containerKeydownHandler:function(e){if(!(r.KEY.isControl(e)&&e.which!=r.KEY.SHIFT||r.KEY.isFunctionKey(e))){switch(e.which){case r.KEY.TAB:return this.close(e),this.selection.focus(),void this._testClear(e);case r.KEY.ENTER:if(e.target===this.selection[0]&&!this._opened())return this.open(e),void r.killEvent(e)}var t=this._hasSearchBox();if(u.superclass._containerKeydownHandler.apply(this,arguments),this._userTyping&&!this._opened()&&this.open(e),!t&&this._userTyping){var n;e.which!=r.KEY.LEFT&&e.which!=r.KEY.RIGHT&&(n=String.fromCharCode(e.which)),this._showSearchBox(n),this._updateResults(),r.killEvent(e)}}},_testClear:function(e){return""==this.text.text()&&(this._clear(e),!0)},_showSearchBox:function(e){var t=!1,i=this.dropdown.find(".oj-listbox-search");if(i&&(this._hasSearchBox()?(this.dropdown.find(".oj-listbox-search-wrapper").removeClass("oj-helper-hidden-accessible"),n(i).removeAttr("aria-hidden"),this.search.val(e),t=!0):(this.dropdown.find(".oj-listbox-search-wrapper").addClass("oj-helper-hidden-accessible"),n(i).attr("aria-hidden","true"))),r._focus(t?this.search:this.selection),t){var s=this;i.find(".oj-listbox-spyglass-box").on("mouseup click",function(e){s.search.focus(),e.stopPropagation()})}},_hasSearchBox:function(){var e,t=this.opts.minimumResultsForSearch;return e=this.opts.list?n("#"+this.opts.list).find("li").length:this.datalist?this.datalist[0].length:this.opts.options?this.opts.options.length:0,e>t||this._userTyping||n.isFunction(this.opts.options)}}),a=r.clazz(i,{_prepareOpts:function(){var e=a.superclass._prepareOpts.apply(this,arguments),t=this,i=e.element.get(0).tagName.toLowerCase();if("input"===i&&e.element.attr("list")||"select"===i&&e.element.children().length>0||e.list){var s=e.list?"li":"option";e.initSelection=function(e,n){var o,u=[],a=t.getVal();if(a)for(var f=a,l=0;l<f.length;l++){var c=f[l];o=e.find(s).filter(function(){return"option"===s?this.value===c:"li"===s?this.getAttribute("oj-data-value")===c:void 0}),o&&o.length?u.push(t._optionToData(o)):u.push({value:c,label:c})}else"select"!==i&&(o=e.find(s).filter(function(){return"option"===s?this.selected:"li"===s?this.getAttribute("oj-data-selected")===!0:void 0}),r.each2(o,function(e,n){u.push(t._optionToData(n))}));n(u)}}else"options"in e&&(n.isFunction(e.options)?e.initSelection=function(i,s){var o=function(t,r){for(var i=[],s=0,u=t.length;s<u;s++){var a=t[s],f=e.indexOf.call(t,a);if(f>=0&&i.push(a),a.children){var l=o(a.children,r);l&&l.length&&n.merge(i,l)}}return i},u=t.getVal(),a=[],f=r.getLastQueryResult(t);f&&(a=o(f,u));var l=function(){for(var e=[],n=0;n<u.length;n++){for(var r=u[n],i=!1,o=0;o<a.length;o++){var f=a[o];if(JSON.stringify(r)===JSON.stringify(f)){e.push(f),a.splice(o,1),i=!0;break}}if(!i){var l=t.currentItem;if(l&&l.length)for(var c=0;c<l.length;c++)if(JSON.stringify(r)===JSON.stringify(l[c])){e.push(l[c]),i=!0;break}i||e.push(r)}}s(e)};t.valueChangeTrigger?l():e.query({value:u,callback:function(e){if(e&&e.results){var t=o(e.results,u);t&&t.length&&n.merge(a,t)}l()}})}:e.initSelection=e.initSelection||function(r,i){var s=t.getVal(),o=[];e.query({matcher:function(e,t,r){var i=n.grep(s,function(e){return JSON.stringify(e)===JSON.stringify(r)}).length;return i&&o.push(r),i},callback:n.isFunction(i)?function(){for(var e=[],t=0;t<s.length;t++){for(var n=s[t],r=!1,u=0;u<o.length;u++){var a=o[u];if(JSON.stringify(n)===JSON.stringify(a)){e.push(a),o.splice(u,1),r=!0;break}}r||e.push(n)}i(e)}:n.noop})});return e},_selectChoice:function(e){var t=this.container.find("."+this._classNm+"-selected-choice.oj-focus");t.length&&e&&e[0]==t[0]||(t.length&&this.opts.element.trigger("choice-deselected",t),t.removeClass("oj-focus"),e&&e.length&&(this.close(),e.addClass("oj-focus"),this.container.find("."+this._classNm+"-description").text(e.attr("valueText")+". Press back space to delete.").attr("aria-live","assertive"),this.opts.element.trigger("choice-selected",e)))},_destroy:function(){n("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id")),a.superclass._destroy.apply(this,arguments)},_initContainer:function(){var e,t,i="."+this._classNm+"-choices",s=r.nextUid();this.searchContainer=this.container.find("."+this._classNm+"-search-field"),this.selection=e=this.container.find(i);var o=this;this.selection.on("click","."+this._classNm+"-selected-choice:not(."+this._classNm+"-locked)",function(e){o.search[0].focus(),o._selectChoice(n(this))}),t=n("label[for='"+this.opts.element.attr("id")+"']"),t.attr("id")||t.attr("id",this._classNm+"-label-"+s),e.find("."+this._classNm+"-input").attr("id",this._classNm+"-input-"+s),this.results.attr("id")||this.results.attr("id","oj-listbox-results-"+s),this.search.attr("aria-owns",this.results.attr("id")),this.search.attr("aria-labelledby",t.attr("id")),this.opts.element.attr("aria-labelledby",t.attr("id")),this.search.attr("id")&&t.attr("for",this.search.attr("id")),this.opts.element.attr("aria-label")&&this.search.attr("aria-label",this.opts.element.attr("aria-label")),this.opts.element.attr("aria-controls")&&this.search.attr("aria-controls",this.opts.element.attr("aria-controls")),this.search.attr("tabindex",this.elementTabIndex),this.keydowns=0,this.search.on("keydown",this._bind(function(t){if(this._isInterfaceEnabled()){++this.keydowns;var n=e.find("."+this._classNm+"-selected-choice.oj-focus"),i=n.prev("."+this._classNm+"-selected-choice:not(."+this._classNm+"-locked)"),s=n.next("."+this._classNm+"-selected-choice:not(."+this._classNm+"-locked)"),o=r.getCursorInfo(this.search);if(!(!n.length||t.which!=r.KEY.LEFT&&t.which!=r.KEY.RIGHT&&t.which!=r.KEY.BACKSPACE&&t.which!=r.KEY.DELETE&&t.which!=r.KEY.ENTER)){var u=n;return t.which==r.KEY.LEFT&&i.length?u=i:t.which==r.KEY.RIGHT?u=s.length?s:null:t.which===r.KEY.BACKSPACE?(this._unselect(n.first(),t),this.search.width(10),u=i.length?i:s):t.which==r.KEY.DELETE?(this._unselect(n.first(),t),this.search.width(10),u=s.length?s:null):t.which==r.KEY.ENTER&&(u=null),this._selectChoice(u),r.killEvent(t),void (u&&u.length||this.open())}if((t.which===r.KEY.BACKSPACE&&1==this.keydowns||t.which==r.KEY.LEFT)&&0==o.offset&&!o.length)return this._selectChoice(e.find("."+this._classNm+"-selected-choice:not(."+this._classNm+"-locked)").last()),void r.killEvent(t);if(this._selectChoice(null),this._opened())switch(t.which){case r.KEY.UP:case r.KEY.DOWN:return this._moveHighlight(t.which===r.KEY.UP?-1:1),void r.killEvent(t);case r.KEY.ENTER:return this._selectHighlighted(null,t),void r.killEvent(t);case r.KEY.TAB:return void this.close(t);case r.KEY.ESC:return this._cancel(t),void r.killEvent(t)}if(!(t.which===r.KEY.TAB||r.KEY.isControl(t)||r.KEY.isFunctionKey(t)||t.which===r.KEY.ESC||t.which===r.KEY.ENTER&&this.search.val()&&"ojcombobox"===this._elemNm))switch(t.which){case r.KEY.UP:case r.KEY.DOWN:return this.open(),void r.killEvent(t);case r.KEY.PAGE_UP:case r.KEY.PAGE_DOWN:return void r.killEvent(t);case r.KEY.ENTER:return void r.killEvent(t)}}})),this.search.on("keyup",this._bind(function(e){this.keydowns=0})),this.search.on("blur keyup",this._bind(function(e){if("keyup"!==e.type||10===e.keyCode||13===e.keyCode){if(this.opts.manageNewEntry&&this.search.val()&&this.results.find(".oj-hover").length<=0){var t=this.opts.manageNewEntry(this.search.val()),n="blur"===e.type?r.ValueChangeTriggerTypes.BLUR:r.ValueChangeTriggerTypes.ENTER_PRESSED,i={trigger:n};this._onSelect(t,i,e)}this.search.removeClass(this._classNm+"-focused"),this.container.removeClass("oj-focus"),this._selectChoice(null),this._opened()||this._clearSearch(),e.stopImmediatePropagation()}})),this.container.on("click touchstart",i,this._bind(function(e){this._isInterfaceEnabled()&&(n(e.target).closest("."+this._classNm+"-selected-choice").length>0||(this._selectChoice(null),this._opened()?this.close(e):(this.open(),this._focusSearch()),e.preventDefault()))})),this.container.on("focus",i,this._bind(function(){!this._isInterfaceEnabled()})),this._initContainerWidth(),this.opts.element.hide().attr("aria-hidden",!0),this._clearSearch()},_enableInterface:function(){a.superclass._enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this._isInterfaceEnabled())},_initSelection:function(){var e=this.getVal();if(null!==e&&0!==e.length||"oj-select"!==this._classNm&&""!==this.opts.element.text()||(this._updateSelection([]),this.close(),this._clearSearch()),null!==e&&e.length){var t=this,n=this.opts.element;this.opts.initSelection.call(null,n,function(e){void 0!==e&&null!==e&&0!==e.length&&(t._updateSelection(e),t.close(),t._clearSearch())})}},_clearSearch:function(){var e=this._getPlaceholder(),t=this._getMaxSearchWidth(),n=this.getVal();void 0===e||n&&0!==n.length?(this.search.attr("placeholder",""),this.search.val("").width(10),this.searchContainer.width("auto")):(this.search.attr("placeholder",e),this.search.val("").width(t>0?t:this.container.css("width")),this.searchContainer.width("100%"))},_opening:function(e,t){this._resizeSearch(),a.superclass._opening.apply(this,arguments),this._focusSearch(),t||this._updateResults(!0),this.search.focus()},close:function(e){this._opened()&&a.superclass.close.apply(this,arguments)},_focus:function(){this.close(),this.search.focus()},_updateSelection:function(e){var t=[],r=[],i=this;n(e).each(function(){i.opts.indexOf.call(t,this)<0&&(t.push(this),r.push(this))}),e=r,this.selection.find("."+this._classNm+"-selected-choice").remove(),n(e).each(function(){i._addSelectedChoice(this)}),this.currentItem=e,this.opts.element.val(0===t.length?[]:t),i._postprocessResults(),setTimeout(function(){i._positionDropdown()},0)},_onSelect:function(e,t,r){if(this._triggerSelect(e)){var i,s=this;t&&t.trigger&&(i={optionMetadata:{trigger:t.trigger}});var o=this.getVal(),u=o?o.slice(0):[];n(e).each(function(){s.opts.indexOf.call(u,this)<0&&u.push(this)}),this.setVal(u,r,i),!this.select&&this.opts.closeOnSelect||this._postprocessResults(e,!1,this.opts.closeOnSelect===!0),this.opts.closeOnSelect&&(this.close(r),this.search.width(10)),t&&t.noFocus||this._focusSearch()}},_cancel:function(e){this.close(e),this._focusSearch()},_addSelectedChoice:function(e){var t,i=!e.locked,s=n("<li class='"+this._classNm+"-selected-choice'>    <div></div>    <a href='#' onclick='return false;' role='button' aria-label='remove' class='"+this._classNm+"-clear-entry       oj-component-icon oj-clickable-icon-nocontext "+this._classNm+"-clear-entry-icon' tabindex='-1'>    </a></li>"),o=n("<li class='"+this._classNm+"-selected-choice "+this._classNm+"-locked'><div></div></li>"),u=i?s:o;this.id(e),t=this.opts.formatSelection(e),void 0!==t&&(u.find("div").addClass(this._classNm+"-selected-choice-label").text(t),u.find("."+this._classNm+"-clear-entry").attr("aria-label",t+" remove"),u.attr("valueText",t)),i&&u.find("."+this._classNm+"-clear-entry").on("mousedown",r.killEvent).on("click dblclick",this._bind(function(e){this._isInterfaceEnabled()&&(n(e.target).closest("."+this._classNm+"-selected-choice").fadeOut("fast",this._bind(function(){this._unselect(n(e.target),e),this.selection.find("."+this._classNm+"-selected-choice.oj-focus").removeClass("oj-focus"),this.close(e),this._focusSearch()})).dequeue(),r.killEvent(e))})),u.data(this._elemNm,e),u.insertBefore(this.searchContainer)},_unselect:function(e,t){var n,r,i=this.getVal(),s=i?i.slice(0):[],o=this;if(e=e.closest("."+this._classNm+"-selected-choice"),0===e.length)throw"Invalid argument: "+e+". Must be ."+this._classNm+"-selected-choice";if(n=e.data(this._elemNm)){for(var u;(r=o.opts.indexOf.call(s,n))>=0;)u=s.splice(r,1),this.setVal(s,t),this.select&&this._postprocessResults();this.ojContext._IsRequired()&&0===s.length||e.remove(),this.ojContext._IsRequired()&&this.ojContext.validate()}},_postprocessResults:function(e,t,n){var i=this.getVal(),s=i&&(this.opts.element.val()||this.ojContext.isValid())?i:[],o=this.results.find(".oj-listbox-result"),u=this;r.each2(o,function(e,t){var n=u.id(t.data(u._elemNm));s&&u.opts.indexOf.call(s,n)>=0&&(t.addClass("oj-selected"),t.find(".oj-listbox-result-selectable").addClass("oj-selected"))}),!o.filter(".oj-listbox-result:not(.oj-selected)").length>0&&this.close()},_getMaxSearchWidth:function(){return this.selection.width()-r.getSideBorderPadding(this.search)},_textWidth:function(e){var t=document.createElement("span"),r=document.createTextNode(e);t.style.display="none",t.appendChild(r),n("body").append(t);var i=n("body").find("span:last").width();return n("body").find("span:last").remove(),i},_resizeSearch:function(){var e,t,n,i,s,o=r.getSideBorderPadding(this.search);e=this._textWidth(this.search.val())+10,t=this.search.offset().left,n=this.selection.width(),i=this.selection.offset().left,s=n-(t-i)-o,s<e&&(s=n-o),s<40&&(s=n-o),s<=0&&(s=e),this.search.width(Math.floor(s))},setVal:function(e,t,n){var i=[],s=this;"string"==typeof e&&(e=r.splitVal(e,this.opts.separator));for(var o=0;o<e.length;o++)s.opts.indexOf.call(i,e[o])<0&&i.push(e[o]);var u={doValueChangeCheck:!1};n&&(u._context=n),this.opts.element.val(0!==e.length?e:null),this.ojContext._updateValue(i,t,u),this.search.attr("aria-activedescendant",this.opts.element.attr("id"))}}),f=r.clazz(a,{_elemNm:"ojidentity",_classNm:"oj-select",_createContainer:function(){var e=n(document.createElement("div")).attr({"class":"oj-identity oj-select oj-select-multi oj-component"}).html(["<div class='oj-identity-select'>","  <ul class='oj-select-choices'>","    <li class='oj-select-search-field'>","      <input type='text' role='combobox' aria-expanded='false' aria-autocomplete='list' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='oj-listbox-input'>","    <span class='oj-identity-loading-container oj-multi-loading'>","      <span class='oj-identity-loading' role='presentation'>","       &nbsp;</span>","    </li>","  </ul>","</div>","<span class='oj-identity-filter multiple'></span>","<div class='oj-select-description oj-helper-hidden-accessible'/>","<div class='oj-listbox-drop oj-identity-container oj-listbox-drop-multi' style='display:none'>","   <ul class='oj-listbox-results' role='listbox'>","   </ul>","</div>"].join(""));return e}}),l=function(e,t,r,i){if(n.widget(e,t,r),i){var s=e.split(".")[1];delete n.fn[s]}if("oj.oj"===e.substring(0,5)||"oj._oj"===e.substring(0,6))var o=e.split(".");var u,a=o[0],f=o[1],l=a+"-"+f,c="_"===f.substring(0,1);u=c?"_"+a+"-"+f.substring(3):a+"-"+f.substring(2),n.expr[":"][u.toLowerCase()]=function(e){return!!n.data(e,l)}},c=function(){var e=document.documentElement.getAttribute("dir");return e&&(e=e.toLowerCase()),"rtl"===e?"rtl":"ltr"},h=function(){var e=20;if(n.isNumeric(e))return e;var t=n("<div />");n(document.body).append(t),t.width(50).height(50).css({overflow:"scroll",visibility:"hidden",position:"absolute"});var r=n("<div />");r.height(1),t.append(r);var i=r.width(),s=t.width();return t.remove(),e=s-i}(),p=function(e,t){function r(e,t){if(e.bottom-t.top<-1)return!1;var n="auto"===t.overflowY||"scroll"===t.overflowY?h:0;return!(t.bottom-n-e.top<1)&&(n="auto"!==t.overflowX&&"scroll"!==t.overflowX||"rtl"!==c()?0:h,!(e.right-(t.left+n)<-1)&&(n="auto"!==t.overflowX&&"scroll"!==t.overflowX||"ltr"!==c()?0:h,!(e.left-(t.right-n)>-1)))}function i(e){return"visible"!==e.css("overflow-x")||"visible"!==e.css("overflow-y")}function s(e){var t=e[0];if(1===t.nodeType){var r=t.getBoundingClientRect();return r.overflowX=e.css("overflow-x"),r.overflowY=e.css("overflow-y"),r}if(n.isWindow(t)){var r={width:t.innerWidth,height:t.innerHeight,top:0,bottom:t.innerHeight,left:0,right:t.innerWidth};return r}return{height:0,width:0}}if(!e)return!1;var o=s(e);if(t&&!r(o,s(n(window))))return!1;for(var u=!0,a=e.parent();u&&a&&a.length>0&&1===a[0].nodeType;){if(i(a)){var f=s(a);f.height>0&&f.width>0&&(u=r(o,f))}a=a.parent()}return u},d=function(e){if(e.target&&e.target.height>0&&e.target.width>0){var t=e.target.element;return!p(t)}return!1},v=function(e,t){for(var r=n.extend({},e),i=0;i<m.length;i++){var s=m[i],o=r[s];o&&(r[s]=o.replace("start",t?"right":"left").replace("end",t?"left":"right").replace("<",t?"+":"-").replace(">",t?"-":"+"))}return r},m=["my","at"],g={defaultElement:"<select>",widgetEventPrefix:"oj",options:{minimumResultsForSearch:10,noMatchesFound:"No matches found",placeholder:null,list:void 0,multiple:!0,options:null,optionsKeys:{label:"id",value:"id"},beforeExpand:null,selectAll:!0,selectLabel:"Select All",defaultScope:"user",showScopeFilter:!1,scopesOptions:[{label:"All",value:"all"},{label:"User",value:"user"},{label:"Group",value:"group"},{label:"Role",value:"role"}],indexOf:function(e){if(!e)return-1;var t=this.length,n=0;for(e=JSON.stringify(e);n<t;n++){var r=JSON.stringify(this[n]);if(r===e)return n}return-1},contains:function(e){if(!e)return!1;for(var t=e.length,n=this.length,r=0,i=0,s=0;r<n;r++){var o=JSON.stringify(this[r]);for(i=0;i<t;i++){var u=JSON.stringify(e[i]);if(o===u){++s;break}}}return s===n}},widget:function(){return this.select?this.select.container:this.element.parent()},_ComponentCreate:function(){this._super(),this._setup()},_nativeSetDisabled:function(e){e?(this.element.attr("disabled",""),this.element.parent().addClass("oj-disabled").removeClass("oj-enabled")):(this.element.removeAttr("disabled"),this.element.parent().removeClass("oj-disabled").addClass("oj-enabled"))},_nativeChangeHandler:function(e){},_jetSetup:function(){var e={},t=this.options.multiple;e.element=this.element,e.ojContext=this,e=n.extend(this.options,e),this.select=t?new f:new u,this.select._init(e),this.select.container.addClass("oj-select-jet oj-form-control"),this.element.val=function(e){return arguments.length&&this.data("selected-value",e),this.data("selected-value")||[]}},_setup:function(){this._jetSetup()},refresh:function(){this._super(),this._cleanup(),this._setup()},_destroy:function(){this._super(),this._cleanup()},_NotifyDetached:function(){this.select.close()},_NotifyHidden:function(){this.select.close()},_SetPlaceholder:function(e){},_updateValue:function(e,t,r){t&&(r._context=r._context||{},n.extend(!0,r._context,{optionMetadata:{trigger:"option_selected",writeback:"shouldWrite"},originalEvent:t.originalEvent||t}),this.valueUpdated=!0,this.option({value:e},r),this.select._initSelection()),this._IsRequired()&&0!==e.length&&(this.select.container.removeClass("oj-invalid"),this.select.container.find(".oj-messaging-inline-container").remove())},_SetPlaceholderOption:function(e){this._super(e)},_HasPlaceholderSet:function(){return"string"==typeof this.options.placeholder},_IsRequired:function(){return this.options.required},_ClearPlaceholder:function(){this._SetPlaceholderOption(null),this._SetPlaceholder(null)},_InitOptions:function(e,n){var i=[{attribute:"disabled",validateOption:!0},{attribute:"placeholder"},{attribute:"required",coerceDomValue:!0,validateOption:!0},{attribute:"title"}];if(this._super(e,n),t.EditableValueUtils.initializeOptionsFromDom(i,n,this),void 0===this.options.value)this.options.value=void 0!==this.element.attr("value")?r.splitVal(this.element.val(),","):null;else{var s=this.options.value;Array.isArray(s)&&(s=s.slice(0)),this.options.value=s}},_SetDisplayValue:function(e){},_updateDisplayValue:function(){this.valueUpdated?this.valueUpdated=!1:this.select._initSelection()},_setOption:function(e,t,n){if("value"===e){var r=this.select.opts.element;t||(t=[]),Array.isArray(t)||(t=[t]);for(var i=[],s=0;s<t.length;s++)(this.options.multiple||this.select.opts.validate(r,t[s]))&&i.push(t[s]);return this._super(e,i,n),void this._updateDisplayValue()}"placeholder"===e?(this.select.opts.placeholder=t?t:null,this.select._setPlaceholder()):"minimumResultsForSearch"===e?this.select.opts.minimumResultsForSearch=t:"multiple"===e&&(this.options.multiple=t,this.refresh()),"disabled"===e?t?this.select._disable():this.select._enable():"options"===e?(this.select.opts.options=t,this.select.opts=this.select._prepareOpts(this.select.opts),this._super("value",this.select.getVal())):this._super(e,t,n)},_getDropdown:function(){if(this.select&&this.select._opened()){var e=this.select.dropdown;if(e&&e.attr("data-oj-containerid")===this.select.containerId)return e}return null},_cleanup:function(){this.select._destroy(),this.select=void 0},getNodeBySubId:function(e){var t,r=null;if(null==e){var i=this.widget();return i?i[0]:null}if(this._isNative())return null;if(r=this._super(e),!r){var s=this._getDropdown();switch(t=e.subId){case"oj-select-drop":s&&(r=s[0]);break;case"oj-select-results":s&&(r=s.find(".oj-listbox-results")[0]);break;case"oj-select-search":s&&(r=s.find(".oj-listbox-search")[0]);break;case"oj-select-input":case"oj-listbox-input":this.options.multiple===!0?r=this.widget().find(".oj-listbox-input")[0]:s&&(r=s.find(".oj-listbox-input")[0]);break;case"oj-select-choice":case"oj-select-chosen":case"oj-select-arrow":r=this.widget().find("."+t)[0];break;case"oj-listitem":if(s){var o=s.find(".oj-listbox-result");r=this.select._findItem(o,e.value)}break;case"oj-select-remove":var u=this.widget().find(".oj-select-selected-choice"),a=this.select._findItem(u,e.value);r=a?n(a).find(".oj-select-clear-entry-icon")[0]:null;break;case"oj-listbox-result-label":if(s){var f=n("#"+this.select.results.attr("id")).children(),l=e.index;f.length&&l<f.length&&(r=f.eq(l).find("."+t)[0])}}}return r||null},getSubIdByNode:function(e){if(this._isNative())return this._super(e);var t=null;if(null!=e){var r=n(e);r.hasClass("oj-listbox-input")?t={subId:"oj-select-input"}:r.hasClass("oj-select-arrow")?t={subId:"oj-select-arrow"}:r.hasClass("oj-listbox-result")?t={subId:"oj-listitem",value:r.data("ojidentity").value}:r.hasClass("oj-select-clear-entry-icon")&&(t={subId:"oj-select-remove",value:r.closest(".oj-select-selected-choice").data("ojidentity").value})}return t},_GetDefaultStyleClass:function(){return"oj-select"},_GetMessagingLauncherElement:function(){return this.select?this.select.selection:this.element}};l("oj.ojIdentity",n.oj.editableValue,g)}),define("pcs/identityBrowser/viewModel/IdentityViewModel",["knockout","pcs/identityBrowser/viewModel/IdentityService","pcs/composer/idBrowser/ojidentity.min"],function(e,t){"use strict";function n(n){var r=this;r.bundle=require("ojL10n!pcsMsg/nls/pcsSnippetsResource"),r.service=new t,r.value=n.hasOwnProperty("value")?n.value:e.observableArray([]),r.valueSubscription=r.value.subscribe(function(e){r.service.setSelectedIdentities(e)}),r.multiple=n.hasOwnProperty("multiple")&&e.utils.unwrapObservable(n.multiple)===!0,r.scope=n.hasOwnProperty("scope")?e.utils.unwrapObservable(n.scope):"user",r.scope||(r.scope="all"),r.placeholder=n.hasOwnProperty("placehoderTxt")?e.utils.unwrapObservable(n.placehoderTxt):r.bundle.pcs.idBrowser.placeholderTxt,r.idbID=n.hasOwnProperty("idbID")?e.utils.unwrapObservable(n.idbID):"identityBrowser",r.dispose=function(){console.log("dispose in IVM"),r.valueSubscription.dispose()}}return n.prototype={setValue:function(e){this.value(e)},getValue:function(){return this.service.getSelectedIdentities()},getUserIDs:function(){var e=this.service.getSelectedIdentities();return e.map(function(e){return e.id})},getUserTypes:function(){var e=this.service.getSelectedIdentities();return e.map(function(e){return e.type})},getIdentities:function(e){return this.service.restCall(e)},getIdentityIndex:function(e,t){if(!Array.isArray(e))throw"argument type in not array";if(!t)return-1;var n=e.length,r=0,i=JSON.stringify(t);for(;r<n;r++){var s=JSON.stringify(e[r]);if(s===i)return r}return-1}},n}),define("pcs/identityBrowser/loader",["ojs/ojcore","knockout","text!./view/idBrowser.html","./viewModel/IdentityViewModel"],function(e,t,n,r){"use strict";t.components.isRegistered("pcs-identity-browser")||(t.components.register("pcs-identity-browser",{template:{require:"text!pcs/identityBrowser/view/idBrowser.html"},viewModel:{createViewModel:function(e,t){return new r(e,t)}}}),console.log("pcs-idBrowser registered"))}),define("pcs/pcs.identitybrowser",["ojs/ojcore","knockout","jquery","ojL10n!pcsMsg/nls/pcsSnippetsResource","ojs/ojknockout","pcs/identityBrowser/loader"],function(e){"use strict";console.log("loaded identity browser file")}),define("pcs/tasklistActions/viewModel/reassignVM",["jquery","ojs/ojcore","knockout","pcs/tasklist/viewModel/Task","pcs/tasklistActions/viewModel/TaskAction","ojs/ojdialog","ojs/ojradioset","ojs/ojinputtext","pcs/pcs.identitybrowser"],function(e,t,n,r,i){"use strict";function s(t,r){var s=this;s.rootElement=e(r.element),s.bundle=require("ojL10n!pcsMsg/nls/pcsSnippetsResource"),s.TaskAction=i(),s.paths={task:"tasks/{taskNumber}"},s.loadingOverlay=e("#pcs-reassign-overlay",s.rootElement),s.showInline=n.observable(t.showInline),s.tasks=t.tasks,s.isVisible=t.isVisible,s.comments=n.observable(""),s.action=n.observable("REASSIGN"),s.placeholder=n.computed(function(){return s.action()==="REASSIGN"?s.bundle.pcs.taskActions.searchAll:s.bundle.pcs.taskActions.searchUsers}),s.scope=n.computed(function(){return s.action()==="REASSIGN"?"all":"user"}),s.idbConfig={multiple:!0},s.idbID="pcs-reassign-idb",s.init=function(){s.showInline()||(e("#pcs-reassign-dialog-content").append(e("#pcs-reassign-inline-content")),e("#pcs-reassign-dialog-footer").append(e("#pcs-reassign-inline-footer")))}(),s.handleClose=function(){s.comments(""),s.isVisible(!1)},s.isVisibleSubscription=s.isVisible.subscribe(function(t){var n=e("#pcs-reassign-modalDialog");!s.showInline()&&t?n.ojDialog("open"):n.ojDialog("close")}),s.handleSubmit=function(){var e=n.contextFor(document.getElementById("pcs-reassign-idb")).$data;try{s.loadingOverlay.addClass("pcs-common-load-overlay");var t={identityId:e.getUserIDs(),identityType:e.getUserTypes(),userComment:s.comments(),reassignType:s.action()};s.TaskAction.reassignTasks(s.tasks(),t).then(function(){s.loadingOverlay.removeClass("pcs-common-load-overlay"),s.handleClose(),e.setValue([]),s.rootElement.trigger("tasklistAction:refresh",[]),s.rootElement.trigger("taskAction:submit",[s.action()])})}catch(r){console.log("Error - to be handled")}},s.dispose=function(){console.log("dispose in ReassignVM"),s.isVisibleSubscription.dispose(),s.placeholder.dispose(),s.scope.dispose()}}return s}),define("text!pcs/tasklistActions/templates/pcs-requestInfo.html",[],function(){return'<div id="pcs-requestinfo-container">\n	<div id="pcs-requestinfo-modalDialog"\n		 data-bind="visible: !showInline(), ojComponent:{component: \'ojDialog\', title: bundle.pcs.taskActions.reqInfoHeader, close: handleClose,\n		 	rootAttributes: { style: \'width: 450px; min-width: 100px; max-width 450px;\'}}">\n		<div class="oj-dialog-body" id="pcs-requestinfo-dialog-content">\n		</div>\n		<div class="oj-dialog-footer" id="pcs-requestinfo-dialog-footer">\n		</div>\n	</div>\n\n	<div data-bind="visible: showInline() && isVisible()" class="oj-panel oj-margin">\n		<div id="pcs-requestinfo-inline-content">\n			<div id="pcs-requestInfo-overlay"></div>\n			<div id="form-container" class="oj-form-layout">\n				<div class="oj-form">\n					<div class="oj-flex">\n						<div class="oj-flex-item">\n							<text for="username" class="oj-label oj-label-nocomp" data-bind="text:bundle.pcs.taskActions.username"></text>\n							<div class="oj-flex-item">\n								<div id="username" data-bind=\'component: {\n								name: "pcs-identity-browser" , params: {multiple: false, placeholderTxt: placeholder(), scope: scope, idbID: idbID}\n							}\'></div>\n							</div>\n						</div>\n					</div>\n					<div class="oj-flex">\n						<div class="oj-flex-item">\n							<label for="comments" data-bind="text:bundle.pcs.taskActions.comments"></label>\n							<textarea id="comments" style="resize: both" data-bind="ojComponent:\n                   {component: \'ojTextArea\',rootAttributes: {style:\'min-width:100%\'}, value:comments, required: false}">\n							</textarea>\n						</div>\n					</div>\n					<!--<br/>-->\n					<!--<div class="oj-flex">-->\n						<!--<div class="oj-flex-item">-->\n							<!--<div id="radiosetBasicDemoId1" aria-labelledby="mainlabelid1"-->\n								 <!--data-bind="ojComponent: {-->\n									  <!--component: \'ojRadioset\',-->\n									  <!--value: action}" >-->\n								<!--<span class="oj-choice-row">-->\n									<!--<input id="back1" type="radio" name="rbb1" value="back">-->\n									<!--<label for="back1">Route directly back to me</label>-->\n								<!--</span>-->\n								<!--<span class="oj-choice-row">-->\n									<!--<input id="forward1" type="radio" name="rbb1" value="forward">-->\n									<!--<label for="forward1">Require subsequent participants to retake action</label>-->\n								<!--</span>-->\n							<!--</div>-->\n						<!--</div>-->\n					<!--</div>-->\n				</div>\n			</div>\n		</div>\n		<br/>\n		<div id="pcs-requestinfo-inline-footer">\n			<button id="okButton" data-bind="ojComponent: {component: \'ojButton\', label: bundle.pcs.taskActions.submit}, click: handleSubmit"> </button>\n			<button id="cancelButton" data-bind="ojComponent: {component: \'ojButton\', label: bundle.pcs.taskActions.cancel}, click: handleClose"> </button>\n		</div>\n	</div>\n</div>\n'}),define("pcs/tasklistActions/viewModel/requestInfoVM",["jquery","ojs/ojcore","knockout","pcs/tasklist/viewModel/Task","pcs/tasklistActions/viewModel/TaskAction","ojs/ojdialog","ojs/ojradioset","ojs/ojinputtext","pcs/pcs.identitybrowser"],function(e,t,n,r,i){"use strict";function s(t,r){var s=this;s.rootElement=e(r.element),s.bundle=require("ojL10n!pcsMsg/nls/pcsSnippetsResource"),s.TaskAction=i(),s.paths={task:"tasks/{taskNumber}"},s.loadingOverlay=e("#pcs-requestInfo-overlay",s.rootElement),s.showInline=n.observable(t.showInline),s.tasks=t.tasks,s.isVisible=t.isVisible,s.idbConfig={multiple:!1},s.username=n.observable("weblogic"),s.comments=n.observable(""),s.action=n.observable("INFO_REQUEST"),s.placeholder=n.observable(s.bundle.pcs.taskActions.searchUsers),s.idbID="pcs-requestInfo-idb",s.scope="user",s.init=function(){s.showInline()||(e("#pcs-requestinfo-dialog-content").append(e("#pcs-requestinfo-inline-content")),e("#pcs-requestinfo-dialog-footer").append(e("#pcs-requestinfo-inline-footer")))}(),s.handleClose=function(){s.comments(""),s.isVisible(!1)},s.isVisibleSubscription=s.isVisible.subscribe(function(t){var n=e("#pcs-requestinfo-modalDialog");!s.showInline()&&t?n.ojDialog("open"):n.ojDialog("close")}),s.handleSubmit=function(){var e=n.contextFor(document.getElementById("pcs-requestInfo-idb")).$data;try{s.loadingOverlay.addClass("pcs-common-load-overlay"),s.TaskAction.requestInfo(s.tasks(),e.getUserIDs(),e.getUserTypes(),s.comments()).then(function(){s.loadingOverlay.removeClass("pcs-common-load-overlay"),s.handleClose(),e.setValue(null),s.rootElement.trigger("tasklistAction:refresh",[]),s.rootElement.trigger("taskAction:submit",[s.action()])})}catch(t){console.log("Error - to be handled")}},s.dispose=function(){console.log("dispose in ReqInfoVM"),s.isVisibleSubscription.dispose()}}return s}),define("text!pcs/tasksearch/templates/tasksearchContainer.html",[],function(){return'<div id="pcs-task-search-container" data-bind="visible : mode() === \'Search\'" class="oj-flex pcs-task-advance-search-container">\n	<div class="oj-flex-item oj-md-justify-content-center">\n    <input id="searchInpputText" type="text" class="pcs-ts-advance-search-input-text"\n		   data-bind="attr:{placeholder: bundle.pcs.tasksearch.search}, ojComponent:{component: \'ojInputText\', rootAttributes: {style:\'min-width:350px\'}},\n		   suggestItems: autoSuggestions, value: keyword,\n           valueUpdate:[\'afterkeypress\',\'propertychange\',\'input\']"/>\n		<div class="pcs-ts-arrowhead-icon" data-bind="click: showAdvanceSearchPopup, attr: {title: bundle.pcs.tasksearch.show_advance_search}">\n		</div>\n	</div>\n</div>\n<div id="pcs-task-simple-search-container" data-bind="visible : mode() === \'Filter\'" class="oj-flex pcs-task-simple-search-container">\n	<div class="oj-flex-item oj-md-justify-content-center">\n		<input id="simpleSearchInpputText" type="text" class="pcs-ts-simple-search-input-text"\n			   data-bind="attr:{placeholder: bundle.pcs.tasksearch.search},ojComponent:{component: \'ojInputText\', rootAttributes: {style:\'min-width:350px\'}}, value: keyword, event:{keyup: onKeyUpSearchTextBox}"/>\n		<div class="pcs-ts-filter-icon" data-bind="visible: showFilter, click: showAdvanceSearchPopup , attr: {title: bundle.pcs.tasksearch.show_filters}">\n		</div>\n	</div>\n</div>\n    <!-- Advanced Search popup -->\n    <div class="pcs-ts-advance-search" id="advanceSearchPopup"\n         data-bind="ojComponent:{component: \'ojDialog\', \'initialFocus\' : \'firstFocusable\',\n                    title : mode() === \'Search\' ? bundle.pcs.tasksearch.advanced_search :  bundle.pcs.tasksearch.filters,\n                    rootAttributes : {style: \'min-width: 600px; height: inherit\', id: \'advSearchDialog\'}}">\n		<!-- ko template: {name: \'advanceSearchTemplate\'} -->\n		<!-- /ko -->\n    </div>\n    <script type="text/html" id="menuItemTemplate">\n        <li>\n            <a data-bind="text: item.displayName"></a>\n            <span style="display: none" data-bind="text: ko.toJSON($data)"></span>\n            <!-- ko if: item.items -->\n           	 	<ul data-bind="template: {name: \'menuItemTemplate\', foreach: item.items, as: \'item\'}">\n            	</ul>\n            <!-- /ko -->\n        </li>\n    </script>\n    <script type="text/html" id="advanceSearchTemplate">\n		<div id="advsrchbody" class="oj-flex oj-md-flex-direction-column oj-dialog-body">\n			<div class="oj-flex-item oj-flex oj-sm-flex-items-initial oj-md-justify-content-center">\n				<div class="oj-flex-item" data-bind="visible: showAdvancedOptions">\n					<div id="matchSet" data-bind="ojComponent: {component: \'ojButtonset\', checked: matchCriteria}"\n						 aria-label="Choose only one match criteria.">\n						<!-- ko foreach: matchCriterias -->\n						<label data-bind="attr: {for: id}">Match </label>\n						<input type="radio" name="match"\n							   data-bind="value: id, attr: {id: id},\n                                  ojComponent: { component: \'ojButton\', label: label }"/>\n						<!-- /ko -->\n					</div>\n				</div>\n			</div>\n			<div id="formlayout" class="oj-flex-item oj-form-layout">\n				<div class="oj-form oj-sm-odd-cols-12 oj-md-odd-cols-3 oj-md-labels-inline" id="form">\n					<div class="oj-flex" id="row1" data-bind="visible : mode() === \'Search\'">\n						<div class="oj-flex-item pcs-ts-contains-text" id="col1">\n							<input id="text-input"\n								   type="text" placeholder="Contains The Text"\n								   data-bind="ojComponent: {component: \'ojInputText\' , rootAttributes: {style:\'min-width:100%\'}, value: containsText}"/>\n						</div>\n					</div>\n					<div class="oj-flex" id="row2">\n						<div class="oj-flex-item pcs-ts-advanced-search-form-label" id="row2Col1">\n							<label id="statusLabel" for="status" class="pcs-ts-advance-search-label"\n								   data-bind="text: bundle.pcs.tasksearch.status"></label>\n						</div>\n						<div class="oj-flex-item" id="row2Col2">\n							<select id="status" data-bind="ojComponent: {component: \'ojSelect\',\n                                                          multiple: mode() === \'Search\',\n                                                          value: selectedStatus, rootAttributes: {style:\'max-width:100%\'},\n                                                          options: availableStatus}">\n							</select>\n						</div>\n					</div>\n					<div class="oj-flex" id="row3">\n						<div class="oj-flex-item pcs-ts-advanced-search-form-label" id="row3Col1">\n							<label id="assigneeLabel" for="assignes" class="pcs-ts-advance-search-label"\n								   data-bind="text: bundle.pcs.tasksearch.assignee"></label>\n						</div>\n						<div class="oj-flex-item" id="row3Col2">\n							<select id="assignes" aria-label="Assigne" data-bind="ojComponent: {component: \'ojSelect\',\n                                                          multiple: false,\n                                                          value: selectedAssignees,\n                                                          options: availableAssignees}">\n							</select>\n						</div>\n					</div>\n					<div class="oj-flex" id="row4">\n						<div class="oj-flex-item pcs-ts-advanced-search-form-label" id="row4Col1">\n							<label id="fromUserLabel" for="identityBrowser" class="pcs-ts-advance-search-label"\n								   data-bind="text: bundle.pcs.tasksearch.fromuser"></label>\n						</div>\n						<div class="oj-flex-item" id="row4Col2">\n							<pcs-identity-browser id="fromUser" class="pcs-ts-idb"></pcs-identity-browser>\n						</div>\n					</div>\n					<div class="oj-flex">\n						<div class="oj-flex-item pcs-ts-advanced-search-form-label">\n							<label id="inputgrouplabel" class="pcs-ts-advance-search-label"\n								   data-bind="text: dueDateFilter().displayName"></label>\n						</div>\n						<div class="oj-flex-item">\n							<div class="oj-form-control-group" aria-labelledby="inputgrouplabel" role="group">\n								<select id="dueDateFilter" data-bind="ojComponent: {component: \'ojSelect\',\n                                                          multiple: false,\n                                                          value: dueDateFilter().filterOperator,\n                                                          optionChange: dueDateFilter().handleFilterOperatorChange,\n                                                          rootAttributes: {style:\'max-width:25%\'},\n                                                          options: dueDateFilter().filterOperators}">\n\n								</select>\n								<div id="content" class="pcs-ts-filter-values"  data-bind="foreach : dueDateFilter().values"  >\n									<!-- ko if: type() === $parent.filterValueType.valueTypes.DATE -->\n									<input data-bind="ojComponent: {component: \'ojInputDate\' ,value: value, rootAttributes: {style:\'width:5vw\'}}" />\n									<!-- /ko -->\n									<!-- ko if: type()=== $parent.filterValueType.valueTypes.STRING -->\n									<input  data-bind="ojComponent: {component: \'ojInputText\', rootAttributes: {style:\'width:30%\'}, value: value}" />\n									<!-- /ko -->\n									<!-- ko if: type() === $parent.filterValueType.valueTypes.INTEGER  -->\n									<input  placeholder="Enter Numbers"  data-bind="ojComponent: {component: \'ojInputText\',\n									rootAttributes: {style:\'width:30%\'} , displayOptions: {messages: [\'notewindow\']},\n									 validators : [{type: \'regExp\', options : {pattern: \'\'^\\\\d+$\',\n								 	messageSummary: \'Value \\\'{value}\\\' Invalid\',messageDetail: \'You must enter a Number.\'}}],\n								  	value: value}" />\n									<!-- /ko -->\n									<!-- ko if: type() === $parent.filterValueType.valueTypes.LIST  -->\n									<select    data-bind="ojComponent: {component: \'ojSelect\',\n                                                      multiple: false,\n                                                      rootAttributes: {style:\'width:30%\'},\n                                                      value: value,\n                                                      options: listOfValues()}">\n									</select>\n									<!-- /ko -->\n								</div>\n							</div>\n						</div>\n					</div>\n					<div class="oj-flex" id="row6">\n						<div class="oj-flex-item pcs-ts-advanced-search-form-label" id="row6Col1">\n							<label for="application" id="applicationLabel" class="pcs-ts-advance-search-label"\n								   data-bind="text: bundle.pcs.tasksearch.application"></label>\n						</div>\n						<div class="oj-flex-item" id="row6Col2">\n							<select id="application" data-bind="ojComponent: {component: \'ojSelect\',\n                                                      multiple: true,\n                                                      value: selectedApplications,\n                                                      rootAttributes: {style:\'max-width:100%\'},options: availableApplications}">\n							</select>\n						</div>\n					</div>\n					<hr style="margin: 20px 0" data-bind="visible: selectedSearchableFields().length > 0"/>\n\n					<!-- ko foreach: selectedSearchableFields -->\n\n					<div class="oj-flex">\n						<div class="oj-flex-item pcs-ts-advanced-search-form-label">\n							<label id="inpgroup" data-bind="text: displayName" class="pcs-ts-advance-search-label"> </label>\n						</div>\n						<div class="oj-flex-item"  style="max-width: 55%;">\n							<div class="oj-form-control-group" aria-labelledby="inputgrouplabel" role="group">\n								<!-- ko if: filterOperators().length > 0 -->\n								<select data-bind="attr{id: name},ojComponent: {component: \'ojSelect\',\n                                                      multiple: false,\n                                                      value: filterOperator,\n                                                      optionChange: handleFilterOperatorChange,\n                                                      rootAttributes: {style:\'max-width:25%\'},\n                                                      options: filterOperators}">\n								</select>\n								<!-- /ko -->\n								<!-- ko if: type() === $parent.filterType.filterTypes.USER -->\n								<!-- <idb  databind="attr: {id: $parent.generateUniqueIdForSearchableFieldOfTypeUser($index()) }" class="pcs-ts-idb"></idb>-->\n								<div data-bind=\'attr: {id: $parent.generateUniqueIdForSearchableFieldOfTypeUser($index())}, component: {name: "pcs-identity-browser"}\' class="pcs-ts-idb"></div>\n								<!-- /ko -->\n								<div class="pcs-ts-filter-values" data-bind="foreach : { data: values(), as: \'filterValue\'}">\n									<!-- ko if: filterValue.type() === \'Date\' -->\n									<input data-bind="ojComponent: {component: \'ojInputDate\', rootAttributes: {style:\'width:5vw\'}, value: value}"/>\n									<!-- /ko -->\n									<!-- ko if: filterValue.type() ===  \'String\' -->\n									<input data-bind="ojComponent: {component: \'ojInputText\',rootAttributes: {style:\'max-width:30%\'}, value: value}"/>\n									<!-- /ko -->\n									<!-- ko if: filterValue.type() === \'Integer\'  -->\n									<input placeholder="Enter Numbers" data-bind="ojComponent: {component: \'ojInputText\',\n                                	rootAttributes: {style:\'max-width:30%\'}, value: value,\n                                	displayOptions: {messages: [\'notewindow\']},\n									validators : [{type: \'regExp\', options : {pattern: \'^\\\\d+$\',\n									messageSummary: \'Value \\\'{value}\\\' Invalid\',\n									messageDetail:  \'You must enter a Integer.\'}}]}"/>\n									<!-- /ko -->\n									<!-- ko if: filterValue.type() === \'Long\'  -->\n									<input placeholder="Enter Numbers" data-bind="ojComponent: {component: \'ojInputText\',\n									rootAttributes: {style:\'max-width:30%\'}, value: value,\n									displayOptions: {messages: [\'notewindow\']},\n									validators : [{type: \'regExp\', options : {pattern: \'^\\\\d+$\',\n									messageSummary: \'Value \\\'{value}\\\' Invalid\',\n									messageDetail: \'You must enter a Long.\'}}]}"/>\n									<!-- /ko -->\n									<!-- ko if: filterValue.type() === \'Double\'  -->\n									<input placeholder="Enter Numbers" data-bind="ojComponent: {component: \'ojInputText\',\n									rootAttributes: {style:\'max-width:30%\'}, value: value,\n									displayOptions: {messages: [\'notewindow\']}\n									validators : [{type: \'regExp\', options : {pattern: \'[0-9.]{1,}\',\n									messageSummary: \'Value \\\'{value}\\\' Invalid\',\n									messageDetail: \'You must enter a Number.\'}}]}"/>\n									<!-- /ko -->\n									<!-- ko if: filterValue.type() === \'Float\'  -->\n									<input placeholder="Enter Numbers" data-bind="ojComponent: {component: \'ojInputText\',\n									rootAttributes: {style:\'max-width:30%\'}, value: value,\n									displayOptions: {messages: [\'notewindow\']}\n									validators : [{type: \'regExp\', options : {pattern: \'[0-9.]{1,}\',\n									messageSummary: \'Value \\\'{value}\\\' Invalid\',\n									messageDetail: \'You must enter a Number.\'}}]}"/>\n									<!-- /ko -->\n									<!-- ko if: filterValue.type() === \'List\' -->\n									<select data-bind="ojComponent: {component: \'ojSelect\',\n                                                      multiple: false,\n                                                      value: value,\n                                                      rootAttributes: {style:\'max-width:30%\'},\n                                                      options: listOfValues}">\n									</select>\n									<!-- /ko -->\n								</div>\n							</div>\n						</div>\n						<div class="oj-flex-item" style="max-width: 10%;">\n							<!--<div data-bind=" visible: $parent.showAdvancedOptions, ojComponent: {component: \'ojButtonset\', checked: $data.isMust(), display:\'icons\', icons: {start:\'oj-fwk-icon oj-fwk-icon-clock\'}}">\n                                <input type="checkbox" id="must" value="Must"/>\n                            </div>-->\n							<button  data-bind="visible: canDelete,click: $parent.removeSelectedSearchableField.bind($data, $index()), ojComponent: {\n                                                    component:\'ojButton\', chroming: \'half\', label: \'Remove\', display: \'icons\',\n                                                    icons: {start:\'oj-fwk-icon pcs-ts-removefilter-icon\'}\n                                                }">\n							</button>\n						</div>\n					</div>\n\n					<!-- /ko -->\n				</div>\n				<div class="oj-flex" id="row7" data-bind="visible : mode() === \'Search\'">\n					<button id="addFilter"\n							data-bind=" click: onClickAddFilter, ojComponent: {component: \'ojButton\',\n                                                                               label: \'Add Filter\',\n                                                                               chroming: \'half\',\n                                                                               menu: \'#filterMenu\',\n                                                                               icons: {start: \'oj-fwk-icon pcs-ts-add-filter-menu\'}}">\n					</button>\n					<ul id="filterMenu" data-bind="ojComponent: {component: \'ojMenu\', select: handleFilterMenuSelection}"\n						class="pcs-ts-serachable-fields-menu">\n						<!-- ko template: {name: \'menuItemTemplate\', foreach: availableSearchableFields, as: \'item\'} -->\n						<!-- /ko -->\n					</ul>\n				</div>\n			</div>\n		</div>\n		<div class="oj-flex oj-sm-flex-items-initial oj-dialog-footer pcs-ts-advanced-search-footer" id="row8">\n			<!--<div class="oj-flex-item">\n				<a data-bind="click: handleAdvancedOptions, text : showAdvancedOptions() ? bundle.pcs.tasksearch.hide_advanced_options :  bundle.pcs.tasksearch.show_advanced_options"></a>\n			</div>-->\n			<div class="oj-helper-margin-start-auto oj-flex-item" id="row7Col1">\n				<button id="cancelBtn"\n						data-bind="click: closeAdvanceSearchPopup, ojComponent: { component: \'ojButton\', label: bundle.pcs.tasksearch.cancel}"></button>\n				<button id="searchBtn"\n						class="oj-button-primary"\n						data-bind="click: handleSearch, ojComponent: { component: \'ojButton\', label:  mode() === \'Search\' ? bundle.pcs.tasksearch.search : bundle.pcs.tasksearch.ok }"></button>\n			</div>\n		</div>\n   </script>\n\n'}),define("pcs/customBindingHandlers/suggestItems",["knockout","jquery"],function(e,t){"use strict";e.bindingHandlers.suggestItems={init:function(e,n,r,i){function f(n,r){n.hover(function(){n.removeClass("pcs-ts-autosuggestion-menuitem-selected"),t(this).addClass("pcs-ts-autosuggestion-menuitem-selected"),u=n.index(this)+1}).mousedown(function(){r[u-1].action({element:t(e),selectedAutoSuggestion:r[u-1]})})}function l(n){var r="";if(n){n.forEach(function(e){var t=e.label,n=e.styleClass;r+="<li class='pcs-ts-autosuggestion-menu-items'><span class='"+n+"'></span>"+"<span class='pcs-ts-autosuggestion-menu-item'>"+t+"</span></li>"});var i=t(e).parent().find("ul");t(i).empty().append(r)}var s=t(e).parent().find("li");f(s,n)}var s=n()||[],o=s.length,u=0,a=t(e);t(e).parent().append("<div id='srchmenuroot' class='pcs-ts-autosuggestion-menu-root'><ul  class='pcs-ts-autosuggestion-menu-ul'></ul></div>"),t(e).siblings().css({top:26}),t(e).focus(function(){t(this).siblings().width(t(this).width()+5),t("#srchmenuroot").show()}).blur(function(){t(this).siblings().hide()}),a.keyup(function(n){var r=a.parent().find("li"),f=n.keyCode||n.which;switch(f){case 13:if(t(e).siblings().css("display")!=="none"){var c={},h=u;t("li:nth-child("+u+")",t(e).parent()).removeClass("pcs-ts-autosuggestion-menuitem-selected"),u=0,t(e).siblings().hide(),c.element=t(e),h===0?(c.selectedAutoSuggestion=s[h],s[h].action(c)):(c.selectedAutoSuggestion=s[h-1],s[h-1].action(c))}break;case 27:t("li:nth-child("+u+")",t(e).parent()).removeClass("pcs-ts-autosuggestion-menuitem-selected"),u=0,t(e).siblings().hide();break;case 38:t(e).siblings().css("display")!=="none"&&(u=u>1?u-1:o,r.removeClass("pcs-ts-autosuggestion-menuitem-selected"),t("li:nth-child("+u+")",t(e).parent()).addClass("pcs-ts-autosuggestion-menuitem-selected"));break;case 40:t(e).siblings().css("display")!=="none"&&(u=u<o?u+1:1,r.removeClass("pcs-ts-autosuggestion-menuitem-selected"),t("li:nth-child("+u+")",t(e).parent()).addClass("pcs-ts-autosuggestion-menuitem-selected"));break;default:var p=typeof i.refreshAutoSuggestions=="function";if(p){var d=i.refreshAutoSuggestions(n.currentTarget.value);s=d||{},u=0,o=s.length}l(s)}})}}}),define("pcs/tasksearch/filter/filterType",[],function(){"use strict";var e={DATE:"Date",STRING:"String",INTEGER:"Integer",DOUBLE:"Double",Number:"Number",FLOAT:"Float",LONG:"Long",USER:"User"};return{filterTypes:e}}),define("pcs/tasksearch/filter/filterOperator",["ojL10n!pcsMsg/nls/pcsSnippetsResource","pcs/tasksearch/filter/filterType"],function(e,t){"use strict";var n={operator:{OPERATOR_ON:"on",OPERATOR_WITH_IN:"within",OPERATOR_IN_LAST:"inlast",OPERATOR_BEFORE:"before",OPERATOR_AFTER:"after",OPERATOR_BETWEEN:"between",OPERATOR_IS:"is",OPERATOR_CONTAINS:"contains",OPERATOR_GREATER_THAN:"greaterthan",OPERATOR_LESSER_THAN:"lesserthan",OPERATOR_EQUALS:"equals"}},r=[{value:n.operator.OPERATOR_ON,label:e.pcs.tasksearch.on},{value:n.operator.OPERATOR_BEFORE,label:e.pcs.tasksearch.before},{value:n.operator.OPERATOR_AFTER,label:e.pcs.tasksearch.after},{value:n.operator.OPERATOR_BETWEEN,label:e.pcs.tasksearch.between}],i=[{value:n.operator.OPERATOR_IS,label:e.pcs.tasksearch.is},{value:n.operator.OPERATOR_CONTAINS,label:e.pcs.tasksearch.contains}],s=[{value:n.operator.OPERATOR_IS,label:e.pcs.tasksearch.is},{value:n.operator.OPERATOR_GREATER_THAN,label:e.pcs.tasksearch.greater_than},{value:n.operator.OPERATOR_LESSER_THAN,label:e.pcs.tasksearch.lesser_than},{value:n.operator.OPERATOR_BETWEEN,label:e.pcs.tasksearch.between}];return{operators:n,getAvailableDateFilterOperators:function(){return r},getAvailableStringFilterOperators:function(){return i},getFilterOperatorsByType:function(e){if(e&&t.filterTypes.DATE===e)return r;if(e&&t.filterTypes.STRING===e)return i;if(e&&t.filterTypes.NUMBER===e||e&&t.filterTypes.INTEGER===e||e&&t.filterTypes.DOUBLE===e||e&&t.filterTypes.FLOAT===e)return s}}}),define("pcs/tasksearch/filter/filterValueType",[],function(){"use strict";var e={DATE:"Date",STRING:"String",INTEGER:"Integer",DOUBLE:"Double",FLOAT:"Float",LONG:"Long",NUMBER:"Number",LIST:"List"};return{valueTypes:e}}),define("pcs/tasksearch/filter/filterValue",["knockout","pcs/tasksearch/filter/filterValueType"],function(e,t){"use strict";function n(n){var r=this;r.type=e.observable(n.type||"");if(t.valueTypes.LIST===n.type&&n.listOfValues){r.listOfValues=e.observableArray(n.listOfValues);var i=n.listOfValues.length>0?n.listOfValues[0].value:"";r.value=e.observableArray([i])}else r.listOfValues=e.observableArray(),r.value=e.observable("")}return n}),define("pcs/tasksearch/filter/filter",["knockout","jquery","ojL10n!pcsMsg/nls/pcsSnippetsResource","pcs/tasksearch/filter/filterOperator","pcs/tasksearch/filter/filterType","pcs/tasksearch/filter/filterValue","pcs/tasksearch/filter/filterValueType"],function(e,t,n,r,i,s,o){"use strict";function u(u){function l(e,i){var u="#"+e.currentTarget.id,f=t(u).siblings(".pcs-ts-filter-values"),l=i.value[0];if(r.operators.operator.OPERATOR_IN_LAST===l||r.operators.operator.OPERATOR_WITH_IN===l){t(f).empty(),a.values.removeAll();var c=[{value:"Days",label:n.pcs.tasksearch.days},{value:"Months",label:n.pcs.tasksearch.months},{value:"years",label:n.pcs.tasksearch.years}];a.values([new s({type:o.valueTypes.DATE}),new s({type:o.valueTypes.LIST,listOfValues:c})])}if(r.operators.operator.OPERATOR_BEFORE===l||r.operators.operator.OPERATOR_AFTER===l||r.operators.operator.OPERATOR_ON===l)t(f).empty(),a.values.removeAll(),a.values([new s({type:o.valueTypes.DATE})]);r.operators.operator.OPERATOR_BETWEEN===l&&(t(f).empty(),a.values.removeAll(),a.values([new s({type:o.valueTypes.DATE}),new s({type:o.valueTypes.DATE})]))}function c(e,n,i){var o="#"+e.currentTarget.id,u=t(o).siblings(".pcs-ts-filter-values"),f=n.value[0];if(r.operators.operator.OPERATOR_IS===f||r.operators.operator.OPERATOR_GREATER_THAN===f||r.operators.operator.OPERATOR_LESSER_THAN===f||r.operators.operator.OPERATOR_CONTAINS===f)t(u).empty(),a.values.removeAll(),a.values([new s({type:i})]);r.operators.operator.OPERATOR_BETWEEN===f&&(t(u).empty(),a.values.removeAll(),a.values([new s({type:i}),new s({type:i})]))}var a=this;a.name=u.name||"",a.displayName=u.displayName||"",a.type=e.observable(u.type||""),a.filterOperator=e.observableArray(u.filterOperator||[]);var f=u.filterOperators?u.filterOperators:r.getFilterOperatorsByType(u.type);a.filterOperators=e.observableArray(f||[]),a.values=e.observableArray([]),a.canDelete=u.canDelete||!1,a.isMust=e.observableArray([]),u.values?a.values(u.values):(a.type()===i.filterTypes.DATE&&(a.filterOperator([r.operators.operator.OPERATOR_ON]),a.values([new s({type:o.valueTypes.DATE})])),a.type()===i.filterTypes.STRING&&(a.filterOperator([r.operators.operator.OPERATOR_IS]),a.values([new s({type:o.valueTypes.STRING})])),a.type()===i.filterTypes.DOUBLE&&(a.filterOperator([r.operators.operator.OPERATOR_IS]),a.values([new s({type:o.valueTypes.DOUBLE})])),a.type()===i.filterTypes.INTEGER&&(a.filterOperator([r.operators.operator.OPERATOR_IS]),a.values([new s({type:o.valueTypes.INTEGER})]))),a.handleFilterOperatorChange=function(t,n){a.type()===i.filterTypes.DATE&&l(t,n),(a.type()===i.filterTypes.INTEGER||a.type()===i.filterTypes.DOUBLE)&&c(t,n,a.type())}}return u}),define("pcs/tasksearch/viewModel/process",[],function(){"use strict";return function(e){return{getProcessDefId:function(){return e.processDefId},getProcessName:function(){return e.hasOwnProperty("processName")?e.processName:""},getRevision:function(){return e.revision}}}}),define("pcs/tasksearch/viewModel/searchableField",[],function(){"use strict";return function(e){return{getFieldName:function(){return e.searchFieldName},getDisplayName:function(){return e.displayName},getDataType:function(){return e.dataType},getCategory:function(){return e.category},getProcessName:function(){return e.processName}}}}),define("pcs/tasksearch/viewModel/searchMetadata",["pcs/tasksearch/viewModel/process","pcs/tasksearch/viewModel/searchableField","pcs/data-services/DataServices"],function(e,t,n){"use strict";var r={processdefinitions:"/process-definitions",searchablefields:"/searchfields"},i=n.getInstance();return{getProcessDefinitions:function(){var t=r.processdefinitions;return new Promise(function(n,r){i.get(t).done(function(t){var r=t.items.map(function(t){return new e(t)});n(r)}).fail(function(e){r(e)})})},getSearchableFields:function(e){var n=r.searchablefields;return new Promise(function(r,s){var o={queryParams:e};i.get(n,o).done(function(e){var n=e.fields.map(function(e){return new t(e)});r(n)}).fail(function(e){s(e)})})}}}),define("pcs/tasksearch/viewModel/status",[],function(){"use strict";var e={ASSIGNED:"ASSIGNED",INFO_REQUESTED:"INFO_REQUESTED",WITHDRAWN:"WITHDRAWN",SUSPENDED:"SUSPENDED",ALERTED:"ALERTED",ERRORED:"ERRORED",EXPIRED:"EXPIRED",COMPLETED:"COMPLETED"};return{statusType:e}}),define("pcs/tasksearch/viewModel/assingee",[],function(){"use strict";var e={MY:"MY",MY_AND_GROUP:"MY_AND_GROUP",MY_AND_GROUP_ALL:"MY_AND_GROUP_ALL",REPORTEES:"REPORTEES",CREATOR:"CREATOR",REVIEWER:"REVIEWER",PREVIOUS:"PREVIOUS",ADMIN:"ADMIN",OWNER:"OWNER"};return{assigneeType:e}}),define("pcs/tasksearch/query/query",[],function(){"use strict";function e(e){var t=this;t.queryClauses=[],t.operator=e.operator||"MUST"}return e}),define("pcs/tasksearch/query/queryClause",[],function(){"use strict";function e(){var e=this;e.queryClauses=[],e.operator="MUST"}return e}),define("pcs/tasksearch/query/stringQueryClause",[],function(){"use strict";function e(e){var t=this;t.fieldName=e.fieldName||"",t.values=e.values||[],e.boost&&(t.boost=e.boost)}return e}),define("pcs/tasksearch/query/textQueryClause",[],function(){"use strict";function e(e){var t=this;t.fieldName=e.fieldName||"",t.values=e.values||[],e.boost&&(t.boost=e.boost)}return e}),define("pcs/tasksearch/query/wildcardQueryClause",[],function(){"use strict";function e(e){var t=this;t.fieldName=e.fieldName||"",t.expression=e.values||"",e.boost&&(t.boost=e.boost)}return e}),define("pcs/tasksearch/query/numericRangeQueryClause",[],function(){"use strict";function e(e){var t=this;t.fieldName=e.fieldName,t.minInclusive=e.minInclusive,t.maxInclusive=e.maxInclusive,t.numericRanges=e.numericRanges,e.boost&&(t.boost=e.boost)}return e}),define("pcs/tasksearch/query/numericRange",[],function(){"use strict";function e(e){var t=this;t.type=e.type,t.minValue=e.minValue,t.maxValue=e.maxValue,t.primitiveType=e.primitiveType}return e}),define("pcs/tasksearch/query/numericRangeType",[],function(){"use strict";var e={Integer:"IntegerRange",Long:"LongRange",Float:"FloatRange",Date:"LongRange",Double:"DoubleRange"},t={Integer:"Integer",Long:"Long",Float:"Float",Date:"Long",Double:"Double"};return{getNumericRangeTypeBasedOnType:function(n){return e[n]},getNumericRangePrimitiveTypeBasedOnType:function(n){return t[n]}}}),define("pcs/tasksearch/viewModel/taskSearchVM",["ojs/ojcore","knockout","jquery","ojL10n!pcsMsg/nls/pcsSnippetsResource","pcs/customBindingHandlers/suggestItems","pcs/tasksearch/filter/filter","pcs/tasksearch/filter/filterOperator","pcs/tasksearch/filter/filterType","pcs/tasksearch/filter/filterValueType","pcs/tasksearch/viewModel/searchMetadata","pcs/tasksearch/viewModel/status","pcs/tasksearch/viewModel/assingee","pcs/tasksearch/filter/filterValue","pcs/tasksearch/query/query","pcs/tasksearch/query/queryClause","pcs/tasksearch/query/stringQueryClause","pcs/tasksearch/query/textQueryClause","pcs/tasksearch/query/wildcardQueryClause","pcs/tasksearch/query/numericRangeQueryClause","pcs/tasksearch/query/numericRange","pcs/tasksearch/query/numericRangeType","pcs/pcs.identitybrowser","ojs/ojselectcombobox","ojs/ojbutton","ojs/ojmenu","ojs/ojknockout","ojs/ojpopup","ojs/ojdialog","ojs/ojdatetimepicker"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";return function(i,d){function N(){var e={};e.keyword=g.keyword(),g.selectedStatus().length>0&&(e.status=g.selectedStatus()),g.selectedAssignees()&&(e.assignees=g.selectedAssignees());var r=n("#fromUser"),i=r.find("#identityBrowser"),s=t.contextFor(i[0]);if(s){var o=s.$data,u=o.getUserIDs();u.length>0&&(e.fromUser=u)}g.selectedApplications().length>0&&(e.applications=g.selectedApplications());if(g.dueDateFilter().values()){var a=[],f=g.dueDateFilter().filterOperator()[0];g.dueDateFilter().values().forEach(function(e){(f===g.filterOperator.operators.operator.OPERATOR_ON||f===g.filterOperator.operators.operator.OPERATOR_BETWEEN||f===g.filterOperator.operators.operator.OPERATOR_AFTER||f===g.filterOperator.operators.operator.OPERATOR_BEFORE)&&e.type()===g.filterValueType.valueTypes.DATE&&e.value()&&a.push(e.value()),(f===g.filterOperator.operators.operator.OPERATOR_IN_LAST||f===g.filterOperator.operators.operator.OPERATOR_WITH_IN)&&e.value()&&(e.type()===g.filterValueType.valueTypes.INTEGER&&a.push(e.value()),e.type()===g.filterValueType.valueTypes.LIST&&a.push(e.value()[0]))}),a.length>0&&(f===g.filterOperator.operators.operator.OPERATOR_ON&&(e.toDueDate=a[0],e.fromDueDate=a[0]),f===g.filterOperator.operators.operator.OPERATOR_BETWEEN&&(e.fromDueDate=a[0],e.toDueDate=a[1]),f===g.filterOperator.operators.operator.OPERATOR_AFTER&&(e.fromDueDate=a[0],e.toDueDate=null),f===g.filterOperator.operators.operator.OPERATOR_BEFORE&&(e.fromDueDate=null,e.toDueDate=a[0]))}g.rootElement.trigger("taskSearch:searchByStandardFilters",[e])}function C(){var e=new p({operator:"MUST"}),r,i;if(g.containsText()){i={fieldName:x.PUBLIC_INFO_FIELD,values:[g.containsText()]};var s=new m(i);e.queryClauses.push({textQuery:s,operator:"MUST"})}g.selectedStatus().length>0&&(i={fieldName:x.SYSTEM_ATTRIBUTES_STATE,values:g.selectedStatus()},r=new v(i),e.queryClauses.push({stringQuery:r,operator:g.selectedStatus().length>1?"SHOULD":"MUST"})),g.selectedAssignees()&&(i={fieldName:x.ASSIGNEES,values:g.selectedAssignees()},r=new v(i),e.queryClauses.push({stringQuery:r,operator:"MUST"}));var o=n("#fromUser"),u=o.find("#identityBrowser"),a=t.contextFor(u[0]);if(a){var f=a.$data,l=f.getUserIDs();l.length>0&&(i={fieldName:x.SYSTEM_ATTRIBUTES_FROM_USER_ID,values:l},r=new v(i),e.queryClauses.push({stringQuery:r,operator:l.length>1?"SHOULD":"MUST"}))}g.selectedApplications().length>0&&(i={fieldName:x.PROCESS_DEF_ID,values:g.selectedApplications()},r=new v(i),e.queryClauses.push({stringQuery:r,operator:g.selectedApplications().length>1?"SHOULD":"MUST"}));var c=L(g.dueDateFilter());c&&e.queryClauses.push(c),g.selectedSearchableFields().forEach(function(t,n){var r=k(t,n);r&&e.queryClauses.push(r)});var h={query:e,start:0,offset:30,sorts:[],fields:E,language:"en"},d=JSON.stringify(h);console.log(d),g.rootElement.trigger("taskSearch:searchBySearchableFields",[h])}function k(e,t){if(e.type()===u.filterTypes.STRING)return A(e);if(e.type()===u.filterTypes.DATE)return L(e);if(e.type()===u.filterTypes.INTEGER||e.type()===u.filterTypes.DOUBLE||e.type()===u.filterTypes.FLOAT||e.type()===u.filterTypes.LONG)return M(e);if(e.type()===u.filterTypes.USER)return O(e,t)}function L(e){if(e.values()){var t=[],n=e.filterOperator()[0];e.values().forEach(function(e){(n===g.filterOperator.operators.operator.OPERATOR_ON||n===g.filterOperator.operators.operator.OPERATOR_BETWEEN||n===g.filterOperator.operators.operator.OPERATOR_AFTER||n===g.filterOperator.operators.operator.OPERATOR_BEFORE)&&e.type()===g.filterValueType.valueTypes.DATE&&e.value()&&t.push(e.value()),(n===g.filterOperator.operators.operator.OPERATOR_IN_LAST||n===g.filterOperator.operators.operator.OPERATOR_WITH_IN)&&e.value()&&(e.type()===g.filterValueType.valueTypes.INTEGER&&t.push(e.value()),e.type()===g.filterValueType.valueTypes.LIST&&t.push(e.value()[0]))});if(t.length>0){var r,i,s,o,u,a,f,l,c;r=w.getNumericRangeTypeBasedOnType(e.type()),i=w.getNumericRangePrimitiveTypeBasedOnType(e.type());if(n===g.filterOperator.operators.operator.OPERATOR_ON)return s=t[0]?t[0]:null,o=t[0]?t[0]:null,s&&(s=(new Date(s)).getTime()),o&&(o=(new Date(o)).getTime()),l={type:r,minValue:s,maxValue:o,primitiveType:i},u=new b(l),f=JSON.stringify(u).replace("type","@type"),u=JSON.parse(f),c={fieldName:e.name,minInclusive:!0,maxInclusive:!0,numericRanges:[u]},a=new y(c),{numericRangeQuery:a,operator:"MUST"};if(n===g.filterOperator.operators.operator.OPERATOR_BEFORE)return s=null,o=t[0]?t[0]:null,o&&(o=(new Date(o)).getTime()),l={type:r,minValue:s,maxValue:o,primitiveType:i},u=new b(l),f=JSON.stringify(u).replace("type","@type"),u=JSON.parse(f),c={fieldName:e.name,minInclusive:!0,maxInclusive:!0,numericRanges:[u]},a=new y(c),{numericRangeQuery:a,operator:"MUST"};if(n===g.filterOperator.operators.operator.OPERATOR_AFTER)return s=t[0]?t[0]:null,o=null,s&&(s=(new Date(s)).getTime()),l={type:r,minValue:s,maxValue:o,primitiveType:i},u=new b(l),f=JSON.stringify(u).replace("type","@type"),u=JSON.parse(f),c={fieldName:e.name,minInclusive:!0,maxInclusive:!0,numericRanges:[u]},a=new y(c),{numericRangeQuery:a,operator:"MUST"};if(n===g.filterOperator.operators.operator.OPERATOR_BETWEEN)return s=t[0]?t[0]:null,o=t[1]?t[1]:null,s&&(s=(new Date(s)).getTime()),o&&(o=(new Date(o)).getTime()),l={type:r,minValue:s,maxValue:o,primitiveType:i},u=new b(l),f=JSON.stringify(u).replace("type","@type"),u=JSON.parse(f),c={fieldName:e.name,minInclusive:!0,maxInclusive:!0,numericRanges:[u]},a=new y(c),{numericRangeQuery:a,operator:"MUST"}}}}function A(e){if(e.values()){var t=[];e.values().forEach(function(e){e.value()&&t.push(e.value())});if(t.length>0){var n={fieldName:e.name,values:t},r=new m(n);return{textQuery:r,operator:"MUST"}}}}function O(e,r){var i="#"+S+r,s=n(i),o=s.find("#identityBrowser"),u=t.contextFor(o[0]);if(u){var a=u.$data,f=a.getUserIDs();if(f.length>0){var l={fieldName:e.name,values:f},c=new v(l);return{stringQuery:c,operator:f.length>1?"SHOULD":"MUST"}}}}function M(e){if(e.values()){var t=[];e.values().forEach(function(e){e.value()&&t.push(e.value())});if(t.length>0){var n,r,i,s,o,u,a,f,l,c=e.filterOperator()[0];n=w.getNumericRangeTypeBasedOnType(e.type()),r=w.getNumericRangePrimitiveTypeBasedOnType(e.type());if(c===g.filterOperator.operators.operator.OPERATOR_IS)return i=t[0],s=t[0],f={type:n,minValue:i,maxValue:s,primitiveType:r},o=new b(f),a=JSON.stringify(o).replace("type","@type"),o=JSON.parse(a),l={fieldName:e.name,minInclusive:!0,maxInclusive:!0,numericRanges:[o]},u=new y(l),{numericRangeQuery:u,operator:"MUST"};if(c===g.filterOperator.operators.operator.OPERATOR_LESSER_THAN)return i=null,s=t[0],f={type:n,minValue:i,maxValue:s,primitiveType:r},o=new b(f),a=JSON.stringify(o).replace("type","@type"),o=JSON.parse(a),l={fieldName:e.name,minInclusive:!0,maxInclusive:!1,numericRanges:[o]},u=new y(l),{numericRangeQuery:u,operator:"MUST"};if(c===g.filterOperator.operators.operator.OPERATOR_GREATER_THAN)return i=t[0],s=null,f={type:n,minValue:i,maxValue:s,primitiveType:r},o=new b(f),a=JSON.stringify(o).replace("type","@type"),o=JSON.parse(a),l={fieldName:e.name,minInclusive:!1,maxInclusive:!0,numericRanges:[o]},u=new y(l),{numericRangeQuery:u,operator:"MUST"};if(c===g.filterOperator.operators.operator.OPERATOR_BETWEEN)return i=t[0],s=t[1],f={type:n,minValue:i,maxValue:s,primitiveType:r},o=new b(f),a=JSON.stringify(o).replace("type","@type"),o=JSON.parse(a),l={fieldName:e.name,minInclusive:!0,maxInclusive:!0,numericRanges:[o]},u=new y(l),{numericRangeQuery:u,operator:"MUST"}}}}var g=this;g.rootElement=n(d.element),g.bundle=r,g.filterOperator=o,g.filterValueType=a,g.filterType=u,g.showFilter=i.showFilter,g.mode=t.observable(i.mode||"Search"),g.idbID="pcs-search-idb";var E=[{"@type":"LongField",name:"systemAttributes.assignedDate",type:"Long",analyzed:!1},{"@type":"StringField",name:"systemAttributes.fromUser.displayName",type:"String",analyzed:!1},{"@type":"StringField",name:"systemAttributes.fromUser.id",type:"String",analyzed:!1},{"@type":"IntegerField",name:"systemAttributes.taskNumber",type:"Integer",analyzed:!1},{"@type":"IntegerField",name:"priority",type:"Integer",analyzed:!1},{"@type":"StringField",name:"systemAttributes.state",type:"String",analyzed:!1},{"@type":"StringField",name:"ownerRole",type:"String",analyzed:!1},{"@type":"LongField",name:"systemAttributes.updatedDate",type:"Long",analyzed:!1},{"@type":"StringField",name:"hasSubTasksFlag",type:"String",analyzed:!1},{"@type":"StringField",name:"isDocsEnabledFlag",type:"String",analyzed:!1},{"@type":"StringField",name:"isConversationEnabledFlag",type:"String",analyzed:!1},{"@type":"StringField",name:"creatorDisplayName",type:"String",analyzed:!1},{"@type":"StringField",name:"creator",type:"String",analyzed:!1},{"@type":"StringField",name:"processName",type:"String",analyzed:!0},{"@type":"StringField",name:"processId",type:"String",analyzed:!1},{"@type":"LongField",name:"dueDate",type:"Long",analyzed:!1},{"@type":"LongField",name:"systemAttributes.createdDate",type:"Long",analyzed:!1},{"@type":"DoubleField",name:"percentageComplete",type:"Double",analyzed:!1},{"@type":"StringField",name:"applicationContext",type:"String",analyzed:!1},{"@type":"StringField",name:"systemAttributes.acquiredBy",type:"String",analyzed:!1},{"@type":"StringField",name:"systemAttributes.updatedBy.id",type:"String",analyzed:!1},{"@type":"StringField",name:"systemAttributes.taskDefinitionName",type:"String",analyzed:!1},{"@type":"StringField",name:"sca.applicationName",type:"String",analyzed:!1},{"@type":"StringField",name:"sca.componentName",type:"String",analyzed:!1},{"@type":"StringField",name:"sca.compositeDN",type:"String",analyzed:!1},{"@type":"StringField",name:"sca.compositeName",type:"String",analyzed:!1},{"@type":"StringField",name:"sca.compositeVersion",type:"String",analyzed:!1},{"@type":"StringField",name:"workflowPattern",type:"String",analyzed:!1},{"@type":"StringField",name:"systemAttributes.taskNamespace",type:"String",analyzed:!1},{"@type":"StringArrayField",name:"comments",type:"String",analyzed:!1,value:[]},{"@type":"StringArrayField",name:"custom_actions",type:"String",analyzed:!1,value:[]},{"@type":"StringArrayField",name:"system_actions",type:"String",analyzed:!1,value:[]},{"@type":"StringField",name:"TaskDefinitionId",type:"String",analyzed:!1},{"@type":"StringField",name:"taskId",type:"String",analyzed:!1},{"@type":"StringField",name:"type",type:"String",analyzed:!1},{"@type":"StringArrayField",name:"updatedBy_history",type:"String",analyzed:!1,value:[]},{"@type":"StringArrayField",name:"assignee_user",type:"String",analyzed:!1,value:[]},{"@type":"StringArrayField",name:"assignee_application_role",type:"String",analyzed:!1,value:[]},{"@type":"StringField",name:"processDefId",type:"String",analyzed:!1}],S="generatedIdForSearchableFieldOfTypeUser",x={DUE_DATE:"dueDate",SYSTEM_ATTRIBUTES_STATE:"systemAttributes.state",SYSTEM_ATTRIBUTES_FROM_USER_ID:"systemAttributes.fromUser.id",SYSTEM_ATTRIBUTES_ASSIGNEES:"systemAttributes.assignees",ASSIGNEES:"assignees",PROCESS_DEF_ID:"processDefId",PRIORITY:"priority",PUBLIC_INFO_FIELD:"public_info_field"},T=[x.DUE_DATE,x.SYSTEM_ATTRIBUTES_STATE,x.SYSTEM_ATTRIBUTES_ASSIGNEES,x.SYSTEM_ATTRIBUTES_FROM_USER_ID];g.init=function(){g.matchCriterias=[{id:"All",label:r.pcs.tasksearch.all},{id:"Any",label:r.pcs.tasksearch.any}],g.matchCriteria=t.observable("All"),g.keyword=i.tasklistFilter&&i.tasklistFilter.keyword?t.observableArray([i.tasklistFilter.keyword]):t.observable(""),g.containsText=t.observable(""),g.showAdvancedOptions=t.observable(i.showAdvancedOptions||!1),g.selectedFilter=t.observable(),g.selectedStatus=i.tasklistFilter&&i.tasklistFilter.status?t.observableArray([i.tasklistFilter.status]):t.observableArray([l.statusType.ASSIGNED]),g.selectedAssignees=i.tasklistFilter&&i.tasklistFilter.assignees?t.observableArray([i.tasklistFilter.assignees]):t.observableArray([c.assigneeType.MY_AND_GROUP_ALL]),g.selectedApplications=i.tasklistFilter&&i.tasklistFilter.applications?t.observableArray([i.tasklistFilter.applications]):t.observableArray();var e={name:x.DUE_DATE,displayName:r.pcs.tasksearch.duedate,type:u.filterTypes.DATE},n=new s(e);g.dueDateFilter=t.observable(n),g.selectedSearchableFields=t.observableArray(),g.availableSearchableFields=t.observableArray(),g.autoSuggestionsOnTextEntered=[{value:"SHOW_ADVANCE_SEARCH",label:r.pcs.tasksearch.show_advance_search,styleClass:"advanced-icon",action:g.hanldeAutoSuggestionSelection}],g.availableStatus=[{value:l.statusType.ASSIGNED,label:r.pcs.tasksearch.assigned},{value:l.statusType.INFO_REQUESTED,label:r.pcs.tasksearch.info_requested},{value:l.statusType.WITHDRAWN,label:r.pcs.tasksearch.withdrawn},{value:l.statusType.SUSPENDED,label:r.pcs.tasksearch.suspended},{value:l.statusType.ALERTED,label:r.pcs.tasksearch.alerted},{value:l.statusType.ERRORED,label:r.pcs.tasksearch.errored},{value:l.statusType.EXPIRED,label:r.pcs.tasksearch.expired},{value:l.statusType.COMPLETED,label:r.pcs.tasksearch.completed}];var o=[{value:"1",label:r.pcs.tasksearch.lowest},{value:"2",label:r.pcs.tasksearch.low},{value:"3",label:r.pcs.tasksearch.normal},{value:"4",label:r.pcs.tasksearch.high},{value:"5",label:r.pcs.tasksearch.highest}];g.availableAssignees=[{value:c.assigneeType.MY,label:r.pcs.tasksearch.my_tasks},{value:c.assigneeType.MY_AND_GROUP,label:r.pcs.tasksearch.me_and_my_group},{value:c.assigneeType.MY_AND_GROUP_ALL,label:r.pcs.tasksearch.me_and_my_group_all},{value:c.assigneeType.CREATOR,label:r.pcs.tasksearch.started_by_me},{value:c.assigneeType.REPORTEES,label:r.pcs.tasksearch.reportees},{value:c.assigneeType.PREVIOUS,label:r.pcs.tasksearch.related},{value:c.assigneeType.REVIEWER,label:r.pcs.tasksearch.reviewed_by_me}],g.availableApplications=t.observableArray(),f.getProcessDefinitions().then(function(e){e.map(function(e){g.mode()==="Search"?g.availableApplications.push({label:e.getProcessName(),value:e.getProcessDefId()}):g.availableApplications.push({label:e.getProcessName(),value:e.getProcessName()})})}),g.mode()==="Search"&&f.getSearchableFields().then(function(e){var t={},n=[],r={};e.map(function(e){var i=!1;for(var u=0;u<n.length;u++)if(n[u].name===e.getCategory()){i=!0,r={name:e.getFieldName(),displayName:e.getDisplayName(),type:e.getDataType(),canDelete:!0},e.getFieldName()===x.PRIORITY&&(r={name:e.getFieldName(),displayName:e.getDisplayName(),type:e.getDataType(),canDelete:!0,filterOperators:[],values:[new h({type:a.valueTypes.LIST,listOfValues:o})]}),t=new s(r),T.indexOf(e.getFieldName())===-1&&n[u].items.push(t);break}i||(r={name:e.getFieldName(),displayName:e.getDisplayName(),type:e.getDataType(),canDelete:!0},e.getFieldName()===x.PRIORITY&&(r={name:e.getFieldName(),displayName:e.getDisplayName(),type:e.getDataType(),canDelete:!0,filterOperators:[],values:[new h({type:a.valueTypes.LIST,listOfValues:o})]}),t=new s(r),T.indexOf(e.getFieldName())===-1&&n.push({displayName:e.getCategory(),name:e.getCategory(),items:[t]}))}),g.availableSearchableFields(n)})},g.init(),g.onKeyUpSearchTextBox=function(e,t){var n=t.which?t.which:t.keyCode;n===13&&N()},g.handleFilterMenuSelection=function(e,t){var n=t.item.children("span").text(),r=JSON.parse(n),i=[];r.values.forEach(function(e){i.push(new h(e))}),r.values=i;var o=new s(r);g.selectedSearchableFields.push(o)},g.removeSelectedSearchableField=function(e){var t=g.selectedSearchableFields()[e];g.selectedSearchableFields.remove(t)},g.handleAdvancedOptions=function(){var e=g.showAdvancedOptions();e?g.showAdvancedOptions(!1):g.showAdvancedOptions(!0)},g.closeAdvanceSearchPopup=function(){n("#advanceSearchPopup").ojDialog("close")},g.refreshAutoSuggestions=function(e){return e.length===0?g.autoSuggestions:[{value:e,label:r.pcs.tasksearch.task_containing+" '"+e+" '",styleClass:"advanced-icon",action:g.hanldeAutoSuggestionSelection},{value:"SHOW_ADVANCE_SEARCH",label:r.pcs.tasksearch.show_advance_search,styleClass:"advanced-icon",action:g.hanldeAutoSuggestionSelection}]},g.generateUniqueIdForSearchableFieldOfTypeUser=function(e){return S+e},g.showAdvanceSearchPopup=function(e,t){n("#advanceSearchPopup").ojDialog("open"),n("#advSearchDialog").css({top:0}),window.setTimeout(function(){g.rootElement.trigger("taskSearch:loaded")},100)},g.hanldeAutoSuggestionSelection=function(e){var t=e.selectedAutoSuggestion.value;e.element.blur();if(t==="SHOW_ADVANCE_SEARCH")g.selectedFilter(""),n("#advanceSearchPopup").ojDialog("open"),n("#advSearchDialog").css({top:0});else{var r=new p({operator:"MUST"}),i,s;if(t===c.assigneeType.MY_AND_GROUP_ALL||t===c.assigneeType.CREATOR||t===c.assigneeType.ADMIN)s={fieldName:x.ASSIGNEES,values:[t]},i=new v(s),r.queryClauses.push({stringQuery:i,operator:"MUST"}),s={fieldName:x.SYSTEM_ATTRIBUTES_STATE,values:[l.statusType.ASSIGNED,l.statusType.INFO_REQUESTED]},i=new v(s),r.queryClauses.push({stringQuery:i,operator:"MUST"});else if(t==="DUE_SOON"){var o=new Date,a=new Date;a.setDate(a.getDate()+6),o&&(o=(new Date(o)).getTime()),a&&(a=(new Date(a)).getTime());var f={type:w.getNumericRangeTypeBasedOnType(u.filterTypes.DATE),minValue:o,maxValue:a,primitiveType:w.getNumericRangePrimitiveTypeBasedOnType(u.filterTypes.DATE)},h=new b(f),d=JSON.stringify(h).replace("type","@type");h=JSON.parse(d);var S={fieldName:x.DUE_DATE,minInclusive:!0,maxInclusive:!0,numericRanges:[h]},T=new y(S);r.queryClauses.push({numericRangeQuery:T,operator:"MUST"}),s={fieldName:x.SYSTEM_ATTRIBUTES_STATE,values:[l.statusType.ASSIGNED,l.statusType.INFO_REQUESTED]},i=new v(s),r.queryClauses.push({stringQuery:i,operator:"MUST"})}else s={fieldName:x.PUBLIC_INFO_FIELD,values:[t]},i=new m(s),r.queryClauses.push({textQuery:i,operator:"MUST"});var N={query:r,start:0,offset:30,sorts:[],fields:E,language:"en"};console.log(JSON.stringify(N)),g.rootElement.trigger("taskSearch:searchBySearchableFields",[N])}},g.autoSuggestions=[{value:c.assigneeType.CREATOR,label:r.pcs.tasksearch.tasks_i_created,styleClass:"created-tasks-icon",action:g.hanldeAutoSuggestionSelection}],i.isManager&&g.autoSuggestions.push({value:c.assigneeType.MY_AND_GROUP_ALL,label:r.pcs.tasksearch.tasks_assigned_to_my_team,styleClass:"team-tasks-icon",action:g.hanldeAutoSuggestionSelection}),g.autoSuggestions.push({value:"DUE_SOON",label:r.pcs.tasksearch.tasks_due_soon,styleClass:"due-icon",action:g.hanldeAutoSuggestionSelection}),i.showAdvancedSearch&&g.autoSuggestions.push({value:"SHOW_ADVANCE_SEARCH",label:r.pcs.tasksearch.show_advance_search,styleClass:"advanced-icon",action:g.hanldeAutoSuggestionSelection}),g.mode()==="Search"&&g.selectedApplications.subscribe(function(e){var t=g.availableSearchableFields();g.availableSearchableFields().forEach(function(e,n){e.name==="BusinessData"&&t.splice(n,1)});if(e.length>0){var n=[];e.forEach(function(e){n.push({processDN:e})}),f.getSearchableFields(n).then(function(e){var n={},r={};e.map(function(e){var i=!1,o="";for(var u=0;u<t.length;u++){o=e.getProcessName();if(t[u].name===e.getCategory()){i=!0,r={name:e.getFieldName(),displayName:e.getDisplayName(),type:e.getDataType(),canDelete:!0},n=new s(r);if(o){var a=t[u].items,f=!1;for(var l=0;l<a.length;l++)a[l].name===o&&(f=!0,a[l].items.push(n));if(!f){var c={name:o,displayName:o,items:[n]};t[u].items.push(c)}}break}}if(!i){r={name:e.getFieldName(),displayName:e.getDisplayName(),type:e.getDataType(),canDelete:!0},n=new s(r);if(o){var h={name:o,displayName:o,items:[n]};t.push({displayName:e.getCategory(),name:e.getCategory(),items:[h]})}}}),g.availableSearchableFields(t)})}else g.availableSearchableFields(t)}),g.onClickAddFilter=function(t,r){var i="#"+r.currentTarget.id,s=n(i).siblings(".pcs-ts-serachable-fields-menu");n(s).ojMenu("refresh")},g.handleSearch=function(){g.mode()==="Search"?C():N(),g.closeAdvanceSearchPopup()}}}),define("pcs/pcs.taskactions",["ojs/ojcore","knockout","jquery","text!pcs/tasklistActions/templates/pcs-task-actions.html","pcs/tasklistActions/viewModel/taskActionsVM","text!pcs/tasklistActions/templates/pcs-reassign.html","pcs/tasklistActions/viewModel/reassignVM","text!pcs/tasklistActions/templates/pcs-requestInfo.html","pcs/tasklistActions/viewModel/requestInfoVM","text!pcs/tasksearch/templates/tasksearchContainer.html","pcs/tasksearch/viewModel/taskSearchVM","pcs/pcs.identitybrowser","ojL10n!pcsMsg/nls/pcsSnippetsResource","jqueryui-amd/widget"],function(e,t,n,r,i){"use strict";n.widget("pcs.taskactions",{options:{hideSystemActions:!1,hideCustomActions:!1,systemActions:"SUSPEND,ESCALATE,RENEW,REASSIGN,INFO_REQUEST,WITHDRAW,ACQUIRE,PURGE,DELETE,RESUME,RELEASE",taskNumbers:"200007,200020,200022"},_create:function(){var e=this,n=this.options;n.rootElement=e.element;var s={taskactionParams:n};this.element.html(r);var o=new i(s);this.model=o,t.applyBindings(o,this.element[0])},destroy:function(){n.Widget.prototype.destroy.call(this)},_destroy:function(){console.log("Destroying taskactions"),this.model&&this.model.dispose()},_setOption:function(e,t){this.options[e]=t,n.Widget.prototype._setOption.apply(this,arguments)}})});