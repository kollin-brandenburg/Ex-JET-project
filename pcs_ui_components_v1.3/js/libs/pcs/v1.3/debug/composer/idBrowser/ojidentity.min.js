"use strict";define(function(require){var a=require("ojs/ojcore"),b=require("jquery");require("ojs/ojeditablevalue");var c={GENERATED_OPTIONS_SELECTOR:"oj-select-options-generated",KEY:{TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isControl:function(a){var b=a.which;switch(b){case c.KEY.SHIFT:case c.KEY.CTRL:case c.KEY.ALT:return!0}return!(!a.metaKey&&!a.ctrlKey)},isFunctionKey:function(a){return a=a.which?a.which:a,a>=112&&a<=123}},DEFAULT_QUERY_DELAY:70,ValueChangeTriggerTypes:{ENTER_PRESSED:"enter_pressed",OPTION_SELECTED:"option_selected",OPTION_REMOVED:"option_removed",BLUR:"blur",SEARCH_ICON_CLICKED:"search_icon_clicked"},lastMousePosition:{x:0,y:0},nextUid:function(){var a=1;return function(){return a++}}(),scrollBarDimensions:null,each2:function(a,c){for(var d=b(b.isFunction(a[0])?a[0]():a[0]),e=-1,f=a.length;++e<f&&(d.context=d[0]=b.isFunction(a[0])?a[e]():a[e])&&c.call(d[0],e,d)!==!1;);return a},measureScrollbar:function(){var a=b("<div class='oj-listbox-measure-scrollbar'></div>");a.appendTo("body");var c={width:a.width()-a[0].clientWidth,height:a.height()-a[0].clientHeight};return a.remove(),c},splitVal:function(a,c){var d,e,f;if(null===a||a.length<1)return[];for(d=a.split(c),e=0,f=d.length;e<f;e+=1)d[e]=b.trim(d[e]);return d},getSideBorderPadding:function(a){return a.outerWidth(!1)-a.width()},installKeyUpChangeEvent:function(a){var d="keyup-change-value";a.on("keydown",function(){void 0===b.data(a,d)&&b.data(a,d,a.val())}),a.on("keyup",function(e){if(e.which===c.KEY.ENTER)return void e.stopPropagation();var f=b.data(a,d);void 0!==f&&a.val()!==f&&(b.removeData(a,d),a.trigger("keyup-change"))})},installFilteredMouseMove:function(a){a.on("mousemove",function(a){var d=c.lastMousePosition;void 0!==d&&d.x===a.pageX&&d.y===a.pageY||(b(a.target).trigger("mousemove-filtered",a),c.lastMousePosition.x=a.pageX,c.lastMousePosition.y=a.pageY)})},thunk:function(a){var b,c=!1;return function(){return c===!1&&(b=a(),c=!0),b}},_focus:function(a){a[0]!==document.activeElement&&window.setTimeout(function(){var b,c=a[0],d=a.val().length;a.focus(),a.is(":visible")&&c===document.activeElement&&(c.setSelectionRange?c.setSelectionRange(d,d):c.createTextRange&&(b=c.createTextRange(),b.collapse(!1),b.select()))},40)},getCursorInfo:function(a){a=b(a)[0];var c=0,d=0;if("selectionStart"in a)c=a.selectionStart,d=a.selectionEnd-c;else if("selection"in document){a.focus();var e=document.selection.createRange();d=document.selection.createRange().text.length,e.moveStart("character",-a.value.length),c=e.text.length-d}return{offset:c,length:d}},killEvent:function(a){a.preventDefault(),a.stopPropagation()},killEventImmediately:function(a){a.preventDefault(),a.stopImmediatePropagation()},defaultEscapeMarkup:function(a){var b={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return String(a).replace(/[&<>"'\\]/g,function(a){return b[a]})},local:function(a,d){var e,f,g=a,h=function(a){return""+a.label};b.isArray(g)&&(f=g,g={results:f}),b.isFunction(g)===!1&&(f=g,g=function(){return f});var i=g();return i&&i.text&&(h=i.text,b.isFunction(h)||(e=i.text,h=function(a){return a[e]})),function(a){var e=a.term,f={results:[]};return""!==e||d?(g()&&c.each2(b(g().results),function(b,e){c._processData(a,e,f.results,d,!0,h)}),void a.callback(f)):void a.callback(g())}},cleanupResults:function(a){a.children().remove(),a.removeClass("oj-listbox-result-with-children")},remote:function(d,e){return function(f){var g={},h=this,i=function(a){var d={results:[]};h.inputSearch=g.searchPattern,c.each2(b(a),function(a,b){c._processData(f,b,d.results,e,!1)}),f.callback(d)};if(f.value)i(f.value);else{var j=b.trim(f.term);if(j&&(g.searchPattern="*"!==j?"*"+f.term+"*":j),b.extend(!0,g,{scope:this.defaultScope}),!g.searchPattern)return void i(this.results||[]);this.inputSearch&&this.inputSearch===g.searchPattern?i(this.results):(clearTimeout(this.queryTimer),this.queryTimer=setTimeout(function(){h.loading.hasClass("identity-show-inline")||h.loading.addClass("identity-show-inline"),d(g).then(function(a){h.results=a&&Array.isArray(a)?a:[],i(h.results),h.loading.removeClass("identity-show-inline"),h.ojContext._setOption("messagesCustom",[])})["catch"](function(b){h.loading.removeClass("identity-show-inline"),h.ojContext._setOption("messagesCustom",[new a.Message(b)])})},1e3))}}},_processData:function(a,d,e,f,g,h){var i,j,k={};if(b.extend(!0,k,d[0]),d[0].label&&f&&f.label&&"label"!==f.label&&(k[f.label]=d[0].label,delete k.label),d[0].value&&f&&f.value&&"value"!==f.label&&(k[f.value]=d[0].value,delete k.value),!k.children&&f&&f.children&&(k.children=k[f.children],delete k[f.children]),k.children){i={};for(j in k)k.hasOwnProperty(j)&&(i[j]=k[j]);i.children=[],c.each2(b(k.children),function(b,d){c._processData(a,d,i.children,f&&f.childKeys?f.childKeys:null,g,h)}),(!g||i.children.length||a.matcher(a.term,i[f.label],k))&&e.push(i)}else g&&!a.matcher(a.term,k[f.label],k)||e.push(k)},clazz:function(c,d){var e=function(){};return a.Object.createSubclass(e,c,""),e.prototype=b.extend(e.prototype,d),e},LAST_QUERY_RESULT:"last-query-result",getLastQueryResult:function(a){var d=b.data(a.container,a._classNm+"-"+c.LAST_QUERY_RESULT);return d},saveLastQueryResult:function(a,d){b.data(a.container,a._classNm+"-"+c.LAST_QUERY_RESULT,d)}},d=c.clazz(Object,{_bind:function(a){var b=this;return function(){a.apply(b,arguments)}},_init:function(a){var d,e,f=this._classNm,g=this._elemNm,h=".oj-listbox-results";this.ojContext=a.ojContext,this.opts=a=this._prepareOpts(a),this.id=a.id,this.headerInitialized=!1,void 0!==a.element.data(g)&&null!==a.element.data(g)&&a.element.data(g)._destroy(),this.container=this._createContainer();var i=this.opts.rootAttributes;this.containerId=i&&i.id?i.id:"ojChoiceId_"+(a.element.attr("id")||"autogen"+c.nextUid()),this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.body=c.thunk(function(){return b("#__oj_zorder_container").size()?b("#__oj_zorder_container"):a.element.closest("body")}),this.container.attr("style",a.element.attr("style")),this.elementTabIndex=this.opts.element.attr("tabindex"),this.opts.showScopeFilter&&(this.container.addClass("hasFilter"),this.container.find(".oj-identity-filter").addClass("showFilter")),this.opts.element.data(g,this).attr("tabindex","-1").before(this.container),this.container.data(g,this),this.dropdown=this.container.find(".oj-listbox-drop"),this.dropdown.data("ojlistbox",this),this.opts.showScopeFilter&&this.container.on("click",".oj-identity-filter",b.proxy(this._showFilter,this)),this.opts.loading=this.container.find(".oj-identity-loading-container");var j=this.containerId;if(this.dropdown.attr("data-oj-containerid",j),this.results=d=this.container.find(h),this.results.on("click",c.killEvent),a.list&&b("#"+a.list).is("ul")){var k=b("#"+a.list);this.dropdownListParent=k.parent(),k.addClass("oj-listbox-results").attr("role","listbox"),this.results.replaceWith(k),this.results=d=this.container.find(h),this.results.css("display","")}e="oj-select"==f?this.container.find("input.oj-listbox-input"):this.container.find("input."+f+"-input"),this.search=e,this.queryCount=0,this.resultsPage=0,this.context=null,this._initContainer(),this.container.on("click",c.killEvent),c.installFilteredMouseMove(this.results),this.dropdown.on("mousemove-filtered touchstart touchmove touchend",h,this._bind(this._highlightUnderEvent)),b(this.container).on("change","."+f+"-input",function(a){a.stopPropagation()}),b(this.dropdown).on("change","."+f+"-input",function(a){a.stopPropagation()});var l=this;c.installKeyUpChangeEvent(e),e.on("keyup-change input paste",this._bind(this._updateResults)),e.on("focus",function(){e.addClass(f+"-focused"),"oj-select"!==f&&l.container.addClass("oj-focus")}),e.on("blur",function(){e.removeClass(f+"-focused"),"oj-select"!==f&&l.container.removeClass("oj-focus")}),this.dropdown.on("mouseup",h,this._bind(function(a){var d=b(a.target);if(this._selectionEvent=a,d.closest(".oj-listbox-result-selectable").length>0){if(this.opts.multiple&&this.opts.selectAll&&d.hasClass("oj-identity-checkbox")){var e=this.getVal(),f=d.closest(".oj-listbox-result").data(this._elemNm),g=e?e.slice(0):[],h={optionMetadata:{trigger:c.ValueChangeTriggerTypes.OPTION_SELECTED}};d.hasClass("selected")?(g.splice(this.opts.indexOf.call(g,f),1),h.optionMetadata.trigger=c.ValueChangeTriggerTypes.OPTION_REMOVED,d.attr("checked",!1)):g.push(f),this.opts.contains.call(this.opts.results,g)?this.opts.checkAll.addClass("selected"):this.opts.checkAll.removeClass("selected"),d.toggleClass("selected"),this.setVal(g,a,h)}else this._highlightUnderEvent(a),this._selectHighlighted(null,a)}else if(this.opts.multiple&&this.opts.selectAll&&d.hasClass("oj-identity-checkbox")){var i=d.parent().nextAll().find(".oj-identity-checkbox"),j=this,e=this.getVal(),g=e?e.slice(0):[],h={optionMetadata:{trigger:c.ValueChangeTriggerTypes.OPTION_SELECTED}};d.toggleClass("selected");var k=d.hasClass("selected");i.each(function(){var a=b(this.parentNode).data(j._elemNm);k?g.push(a):g.splice(j.opts.indexOf.call(g,a),1)}),k?i.addClass("selected"):(h.optionMetadata.trigger=c.ValueChangeTriggerTypes.OPTION_REMOVED,d.attr("checked",!1),i.removeClass("selected")),this.setVal(g,a,h)}})),this.dropdown.on("click mouseup mousedown",function(a){a.stopPropagation()}),b.isFunction(this.opts.initSelection)&&this._initSelection();var m=a.element.prop("disabled");void 0===m&&(m=!1),this._enable(!m);var n=a.element.prop("readonly");void 0===n&&(n=!1),this._readonly(n),c.scrollBarDimensions=c.scrollBarDimensions||c.measureScrollbar(),this.autofocus=a.element.prop("autofocus"),a.element.prop("autofocus",!1),this.autofocus&&this._focus()},_showFilter:function(a){var d=a.target;if(a=b.Event(a),this._enabled){if(!this.filterDropdown){var e=this,f=this.opts.scopesOptions||[],g=c.nextUid();this.filterDropdown=b('<div class="oj-identity-filter-drop"></div>'),this.filterDropdown.appendTo(document.body),this.filterDropdown.ojPopup(),this.filterDropdown.ojPopup("option",{tail:"none",modality:"modeless"});for(var h=0,i=f.length;h<i;h++){var j=b('<div><input type="radio" name="oj-identity-'+g+'" value="'+f[h].value+'" '+(f[h].value==e.opts.defaultScope?"checked ":"")+"/> "+f[h].label+"</div>");this.filterDropdown.append(j)}this.filterDropdown.on("click","input",function(){e.opts.defaultScope=b(this).val()})}this.filterDropdown.ojPopup("open",d)}},_clickAwayHandler:function(a){var c,d=this.dropdown;b(a.target).closest(d).length||b(a.target).closest("#"+d.attr("data-oj-containerid")).length||d.length>0&&(c=d.data("ojlistbox"),c&&c.close(a))},_surrogateRemoveHandler:function(){this.dropdown&&this.dropdown.remove()},_destroy:function(){var a=this._closeDelayTimer;isNaN(a)||(delete this._closeDelayTimer,window.clearTimeout(a));var b=this.opts.element,c=b.data(this._elemNm);this.close(),this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.opts.list&&this.results&&(this._cleanupList(this.results),this.dropdownListParent&&this.dropdownListParent.append(this.results)),void 0!==c&&(c.container.remove(),c.dropdown.remove(),b.removeAttr("aria-hidden").removeData(this._elemNm).off("."+this._classNm).prop("autofocus",this.autofocus||!1),this.elementTabIndex?b.attr({tabindex:this.elementTabIndex}):b.removeAttr("tabindex"),b.show())},_cleanupList:function(a){if(a&&a.is("ul")){a.removeClass("oj-listbox-results oj-listbox-result-sub"),a.removeAttr("role");for(var c=a.children().length-1;c>=0;c--)this._cleanupList(b(a.children()[c]))}else if(a.is("li")){(a.hasClass("oj-listbox-placeholder")||a.hasClass("oj-listbox-no-results"))&&a.remove(),a.attr("class")&&a.attr("class",a.attr("class").replace(/\oj-listbox-\S+/g,""));var d=a.children(".oj-listbox-result-label");d&&d.contents().unwrap(),"none"==a.css("display")&&a.css("display",""),this._cleanupList(a.children("ul"))}},_optionToData:function(a){if(a.is("option"))return{value:a.prop("value"),label:a.text(),element:a.get(),css:a.attr("class"),disabled:a.prop("disabled"),locked:"locked"===a.attr("locked")||a.data("locked")===!0};if(a.is("optgroup"))return{label:a.attr("label"),children:[],element:a.get(),css:a.attr("class")};if(a.is("li")){var b,c=null,d=a.children();return d&&d.length>0&&d.is("ul")?(b=a.attr("oj-data-label")?a.attr("oj-data-label"):a.clone().children().remove().end().text().trim(),c=[]):b=a.attr("oj-data-label")?a.attr("oj-data-label"):a.text().trim(),{value:a.attr("oj-data-value"),label:b,element:a.get(),css:a.attr("class"),children:c}}},_prepareOpts:function(a){var d,f,g=this;a.options&&Array.isArray(a.options)&&a.optionsKeys&&(a.options=b.extend(!0,[],a.options)),d=a.element;var h=d.get(0).tagName.toLowerCase();return"input"===h&&d.attr("list")?this.datalist=f=b("#"+d.attr("list")):"select"===h&&d.children().length>0?this.datalist=f=d:a.list&&(this.datalist=f=b("#"+a.list)),a=b.extend({},{populateResults:function(d,e,f,g){var h,i=b.proxy(this.opts.id,this),j=this,k=this.opts.optionRenderer;"function"!=typeof k&&(k=null),(h=function(d,e,g,l,m){var n,o,p,q,r,s,t,u,v=function(a,c){if(c.children&&c.children.length>0){var d=c.element&&b(c.element[0]).is("li")&&b(c.element[0]).children("ul"),e=d?b(c.element[0]).children("ul"):b("<ul></ul>");e.hasClass("oj-listbox-result-sub")||e.addClass("oj-listbox-result-sub"),h(c,c.children,e,l+1,!1),d||a.append(e)}},w=function(a,b,c){function d(a,c){var e=0;if(3===a.nodeType){var f=a.data.toUpperCase().indexOf(c);if(f>=0){var g=document.createElement("span");g.className=b;var h=a.splitText(f),i=(h.splitText(c.length),h.cloneNode(!0));g.appendChild(i),h.parentNode.replaceChild(g,h),e=1}}else if(1===a.nodeType&&a.childNodes&&!/(script|style)/i.test(a.tagName))for(var j=0;j<a.childNodes.length;++j)j+=d(a.childNodes[j],c);return e}a.length&&c&&c.length&&a.each(function(){d(this,c.toUpperCase())})},x=function(b,c){if(k){var e={index:n,depth:l,leaf:!c.children,parent:d,data:c,component:a.ojContext,parentElement:b.get(0)},g=k.call(a.ojContext,e);null!==g&&(null===g.parentNode||g.parentNode instanceof DocumentFragment)&&b.appendChild(g)}else u=a.formatResult(c),void 0!==u&&b.text(u);if(f.initial!==!0){var h=b.find(".oj-listbox-highlighter-section");h.length||(h=b),w(h,"oj-listbox-highlighter",f.term)}},y=function(d){a._placeholderData||(p={},p[a.optionsKeys.label]=d,a.optionsKeys.label!==a.optionsKeys.value&&(p[a.optionsKeys.value]=""),a._placeholderData=p),s=b("<li></li>"),s.addClass("oj-listbox-placeholder oj-listbox-results-depth-0 oj-listbox-result oj-listbox-result-selectable"),s.attr("role","presentation"),t=b(document.createElement("div")),t.addClass("oj-listbox-result-label"),t.attr("id","oj-listbox-result-label-"+c.nextUid()),t.attr("role","option"),t.text(a._placeholderData[a.optionsKeys.label]),s.append(t),s.data(j._elemNm,a._placeholderData),g.prepend(s)},z=j._getPlaceholder(),A=j.getVal();A&&0!==A.length&&(m&&z&&!f.term?y(z):a.multiple||(y(""),a.placeholder=""));var B=a.multiple&&a.selectAll;if(a.results=e,A=j.getVal(),B){var C=b("<li class='oj-listbox-results-depth-0' role='presentation'></li>"),D=c.nextUid(),E=b(document.createElement("input")),F=!1;A&&Array.isArray(A)&&(F=a.contains.call(e,A));var G=b(document.createElement("span"));G.addClass("oj-listbox-result-label"),G.attr("id","oj-listbox-result-label-"+D),G.attr("role","option"),G.text(a.selectLabel),E.attr({id:"oj-checkbox-"+D,"class":"oj-identity-checkbox",type:"checkbox",checked:F});var H=b(document.createElement("label"));H.attr({"for":"oj-checkbox-"+D,"class":"oj-identity-checkbox"+(F?" selected":""),"aria-label":F?"selected":"unselected"}),a.checkAll=H,C.append([H,G]),g.prepend(C)}var I=!(!a.resultTemplateKeys||!Array.isArray(a.resultTemplateKeys));for(n=0,o=e.length;n<o;n+=1){p=e[n],r=p.disabled===!0,q=!r&&void 0!==i(p);var J=p.element&&b(p.element[0]).is("li");if(s=b(J?p.element[0]:"<li></li>"),s.hasClass("oj-listbox-result"))p.children&&p.children.length>0&&v(s,p),b(p.element[0]).css("display","");else{var K=c.nextUid();if(s.addClass("oj-listbox-results-depth-"+l),s.addClass("oj-listbox-result"),s.addClass(q?"oj-listbox-result-selectable":"oj-listbox-result-unselectable"),r&&s.addClass("oj-disabled"),p.children&&s.addClass("oj-listbox-result-with-children"),s.attr("role","presentation"),B){var F=!1;A&&Array.isArray(A)&&(F=a.indexOf.call(A,p)!==-1);var H=b(document.createElement("label"));H.attr({"for":"oj-checkbox-"+K,"class":"oj-identity-checkbox"+(F?" selected":""),"aria-label":F?"selected":"unselected"}),s.append(H)}var L=p.identityType?p.identityType:"";if(L||(L=p.type||""),L){var M=b(document.createElement("span"));M.attr("class","oj-identity-type "+L),s.append(M)}if(t=b(document.createElement("div")),t.addClass("oj-listbox-result-label"),t.attr("id","oj-listbox-result-label-"+K),t.attr("role","option"),r&&t.attr("aria-disabled","true"),!J){if(x(t,p),I)for(var N=a.resultTemplateKeys,O=0,P=N.length;O<P;O++)p.hasOwnProperty(N[O])&&p[N[O]]&&t.append([b("<span> | </span>"),b("<span class='info'> "+p[N[O]]+"</span>")]);else p.email&&t.append([b("<span> | <span>"),b("<span class='info'> "+p.email+"</span>")]);t[0].title=t.text(),s.append(t)}p.children&&p.children.length>0&&v(s,p),s.data(j._elemNm,p),J?(b(p.element[0]).contents().filter(function(){return"UL"!==this.tagName}).wrapAll(t),b(p.element[0]).css("display","")):g.append(s)}}})(null,e,d,0,g)}},e,a),a.id=function(a){return a[this.opts.optionsKeys.value]},a.formatResult=function(a){return isNaN(a[this.optionsKeys.label])?a[this.optionsKeys.label]:this.ojContext._formatValue(a[this.optionsKeys.label])},a.formatSelection=function(a){return a&&a[this.optionsKeys.label]?isNaN(a[this.optionsKeys.label])?a[this.optionsKeys.label]:this.ojContext._formatValue(a[this.optionsKeys.label]):void 0},"select"!==h&&null!==a.manageNewEntry&&(a.manageNewEntry=function(c){var d={};return d[a.optionsKeys.value]=d[a.optionsKeys.label]=b.trim(c),d}),f?a.query=this._bind(function(a){var b,d,e={results:[],more:!1},h=a.term;d=function(b,e){var f,i=b.children()&&b.children().length>0&&b.children().is("ul");b.is("option")||b.is("li")&&!i?a.matcher(h,b.text(),b)&&e.push(g._optionToData(b)):(b.is("optgroup")||b.is("li")&&i)&&(f=g._optionToData(b),c.each2(b.is("optgroup")?b.children():b.children("ul").children(),function(a,b){d(b,f.children)}),f.children.length>0&&e.push(f))},b=f.children(),void 0!==this._getPlaceholder()&&b.length>0&&""==b.first().attr("value")&&(b=b.slice(1)),c.each2(b,function(a,b){d(b,e.results)}),a.callback(e)}):"options"in a&&(b.isFunction(a.options)?a.query=c.remote(a.options,a.optionsKeys?a.optionsKeys:null):a.query=c.local(a.options,a.optionsKeys?a.optionsKeys:null)),a},_createHeader:function(){var a=this.opts.element.find(".oj-listbox-header");if(a.length){this.header=b("<li>",{"class":"oj-listbox-result-header oj-listbox-result-unselectable",role:"presentation"}),this.header.append(a.children()),this._initializeHeaderItems();var c=b("<ul>",{"class":"oj-listbox-results-with-header",role:"listbox"});c.append(this.header),c.appendTo(this.results.parent());var d=b("<li>",{role:"presentation"});c.append(d),this.results.attr("role","presentation"),this.results.appendTo(d)}this.headerInitialized=!0},_initializeHeaderItems:function(){this.headerItems=this.header.find("li[role='option'], li:not([role])"),this.headerItems.uniqueId(),this.header.find("ul").attr("role","presentation"),this.header.find("li:not([role])").attr("role","option");var a="a, input, select, textarea, button, object, .oj-component-initnode";this.header.find(a).each(function(){b(this).attr("tabIndex",-1)})},_isHeaderItem:function(a){var c=!1;return this.headerItems.each(function(){if(b(this).attr("id")===a)return c=!0,!1}),c},_getNextHeaderItem:function(a){if(!this.headerItems)return null;if(!a)return this.headerItems.first();var c=!1,d=null;return this.headerItems.each(function(){return c?(d=b(this),!1):void(c=b(this).attr("id")===a)}),d},_getPreviousHeaderItem:function(a){if(!this.headerItems)return null;var c=null;return this.headerItems.each(function(){return b(this).attr("id")!==a&&void(c=b(this))}),c},_setFocusOnHeaderItem:function(a){var b=a.find(".oj-component .oj-enabled").first();if(0===b.length){var c="a, input, select, textarea, button, object, .oj-component-initnode";b=a.find(c).first(),0===b.length&&(b=a.children().first())}b&&b.addClass("oj-focus")},_removeHighlightFromHeaderItems:function(){this.headerItems&&this.headerItems.find(".oj-focus").removeClass("oj-focus")},_triggerSelect:function(a){var c=b.Event(this._elemNm+"-selecting",{val:this.id(a),object:a});return this.opts.element.trigger(c),!c.isDefaultPrevented()},_isInterfaceEnabled:function(){return this.enabledInterface===!0},_enableInterface:function(){var a=this._enabled&&!this._readonly,b=!a;return a!==this.enabledInterface&&(this.container.toggleClass("oj-disabled",b),this.close(),this.enabledInterface=a,!0)},_enable:function(a){void 0===a&&(a=!0),this._enabled!==a&&(this._enabled=a,this.opts.element.prop("disabled",!a),this.container.toggleClass("oj-enabled",a),this.container.find(".oj-identity-filter").toggleClass("disabled-filter",!a),this._enableInterface())},_disable:function(){this._enable(!1)},_readonly:function(a){return void 0===a&&(a=!1),this._readonly!==a&&(this._readonly=a,this.opts.element.prop("readonly",a),this._enableInterface(),!0)},_opened:function(){return this.container.hasClass("oj-listbox-dropdown-open")},_usingHandler:function(a,c){if(n(c))return void(this._closeDelayTimer=window.setTimeout(b.proxy(this.close,this),1));var d=this.container,e=c.element.element;e.css(a),"bottom"===c.vertical?(d.addClass("oj-listbox-drop-above"),e.addClass("oj-listbox-drop-above")):(d.removeClass("oj-listbox-drop-above"),e.removeClass("oj-listbox-drop-above"))},_getDropdownPosition:function(){var a={my:"start top",at:"start bottom",of:this.container.children().first(),collision:"flip",using:b.proxy(this._usingHandler,this)},c="rtl"===k();return o(a,c)},_positionDropdown:function(){this.dropdown.css("width",this.container.outerWidth()),this.dropdown.position(this._getDropdownPosition())},_shouldOpen:function(a){if(this._opened())return b.isFunction(this.opts.options);if(this._enabled===!1||this._readonly===!0)return!1;var c={component:this.opts.element};return this.ojContext._trigger("beforeExpand",a,c)},_clearDropdownAlignmentPreference:function(){this.container.removeClass("oj-listbox-drop-above"),this.dropdown.removeClass("oj-listbox-drop-above")},open:function(a,b){return!!this._shouldOpen(a)&&(this._opening(a,b),!0)},_opening:function(){this.headerInitialized||this._createHeader(),this.container.addClass("oj-listbox-dropdown-open")},_showDropDown:function(){if(this._opened()){this.windowEventBind=b.proxy(this._positionDropdown,this),this.documentEventBind=b.proxy(this._clickAwayHandler,this),window.addEventListener("resize",this.windowEventBind,!0),window.addEventListener("scroll",this.windowEventBind,!0),document.documentElement.addEventListener("mousedown",this.documentEventBind,!0);var a=this._getActiveContainer().attr("aria-expanded");if("true"!==a){this._clearDropdownAlignmentPreference(),this.dropdown[0]!==this.body().children().last()[0]&&this.dropdown.detach().appendTo(this.body()),this.dropdown.appendTo(this.body()),this.header&&(this.dropdown.find(".oj-listbox-results-with-header").prepend(this.header),this.header.show()),this.dropdown.position(this._getDropdownPosition()).show(),b("#oj-listbox-drop").removeAttr("id"),this.dropdown.attr("id","oj-listbox-drop");var c=this.containerId;this.dropdown.attr("data-oj-containerid",c),this._positionDropdown(),this._getActiveContainer().attr("aria-expanded",!0)}}},close:function(a){if(this._opened()){if(this._selectionEvent&&this._selectionEvent.target&&b(this._selectionEvent.target).hasClass("oj-identity-checkbox"))return void(this._selectionEvent=null);this.container.removeClass("oj-listbox-dropdown-open");var c=this._getActiveContainer().attr("aria-expanded");if(c&&"false"!==c){window.removeEventListener("resize",this.windowEventBind,!0),window.removeEventListener("scroll",this.windowEventBind,!0),document.documentElement.removeEventListener("mousedown",this.documentEventBind,!0);var d=this.containerId,e="scroll."+d,f="resize."+d,g="orientationchange."+d;this.container.parents().add(window).each(function(){b(this).off(e).off(f).off(g)}),this._clearDropdownAlignmentPreference(),this.header&&(this.header.hide(),this.header.appendTo(this.container)),this.dropdown.removeAttr("data-oj-containerid"),this.dropdown.removeAttr("id"),this.opts.list?this._removeHighlight():(this.dropdown.detach(),this.results.empty()),this._getActiveContainer().attr("aria-expanded",!1),this.ojContext._IsRequired()&&this.ojContext.validate()}}},_clearSearch:function(){},_ensureHighlightVisible:function(){var a,c,d,e,f,g,h,i=this.results;if(c=this._highlight(),!(c<0)){if(0==c)return void i.scrollTop(0);a=this._findHighlightableChoices().find(".oj-listbox-result-label"),d=b(a[c]),e=d.offset().top+d.outerHeight(!0),c===a.length-1&&(h=i.find("li.oj-listbox-more-results"),h.length>0&&(e=h.offset().top+h.outerHeight(!0))),f=i.offset().top+i.outerHeight(!0),e>f&&i.scrollTop(i.scrollTop()+(e-f)),g=d.offset().top-i.offset().top,g<0&&"none"!=d.css("display")&&i.scrollTop(i.scrollTop()+g)}},_findHighlightableChoices:function(){return this.results.find(".oj-listbox-result-selectable:not(.oj-disabled, .oj-selected)").filter(function(){return"none"!=b(this).css("display")})},_moveHighlight:function(a){var c=this._findHighlightableChoices(),d=this._highlight();if(this.header&&(d<=0||d===c.length-1)){var e=this._getActiveContainer().attr("aria-activedescendant"),f=this._isHeaderItem(e);f||(e=null);var g=null;if(a>0&&(d<0||d===c.length-1)?g=this._getNextHeaderItem(e):a<0&&(f&&d<0||0===d)&&(g=this._getPreviousHeaderItem(e)),g)return this._removeHighlight(),this._setFocusOnHeaderItem(g),void this._getActiveContainer().attr("aria-activedescendant",g.attr("id"));f&&a<0&&(d=0)}for(;d>=-1&&d<c.length;){d+=a,d==c.length?d=0:d==-1&&(d=c.length-1);var h=b(c[d]);if(h.hasClass("oj-listbox-result-selectable")&&!h.hasClass("oj-disabled")&&!h.hasClass("oj-selected")){this._highlight(d);break}}},_highlight:function(a){var c,d=this._findHighlightableChoices();if(0===arguments.length){var e=d.filter(".oj-hover");return e.length||(e=d.children(".oj-hover").closest(".oj-listbox-result")),d.get().indexOf(e[0])}a>=d.length&&(a=d.length-1),a<0&&(a=0),this._removeHighlight(),c=b(d[a]),c.hasClass("oj-listbox-result-with-children")?c.children(".oj-listbox-result-label").addClass("oj-hover"):c.addClass("oj-hover"),this._getActiveContainer().attr("aria-activedescendant",c.find(".oj-listbox-result-label").attr("id")),this._ensureHighlightVisible()},_removeHighlight:function(){this.results.find(".oj-hover").removeClass("oj-hover"),this._removeHighlightFromHeaderItems()},_highlightUnderEvent:function(a){var c=b(a.target).closest(".oj-listbox-result-selectable");if(c.length>0&&!c.is(".oj-hover")){var d=this._findHighlightableChoices();this._highlight(d.index(c))}else 0==c.length&&this._removeHighlight()},_updateResults:function(a){var d=this.search,e=this,f=d.val(),g=b.data(this.container,this._classNm+"-last-term");if((a===!0||!g||f!==g)&&(g||f||!a||"input"!==a.type)){b.data(this.container,this._classNm+"-last-term",f);var h=this.opts.minLength||0;f.length>=h?(clearTimeout(this.queryTimer),a&&a!==!0?this.queryTimer=setTimeout(function(){e._queryResults(a)},c.DEFAULT_QUERY_DELAY):this._queryResults(a)):this.close()}},_queryResults:function(a){function d(){if(j._positionDropdown(),j.header&&j.headerItems.length){var a=j._findHighlightableChoices(),b=j.headerItems.length+a.length;if(j.headerItems.attr("aria-setsize",b),a.length){var c=a.children("[role='option']");c.attr("aria-setsize",b),c.first().attr("aria-posinset",j.headerItems.length+1)}}}var e,f,g=this.search,h=this.results,i=this.opts,j=this,k=g.val(),l=i.minLength||0;return l>k.length?void this.close():(this.open(null,!0),f=++this.queryCount,this._removeHighlight(),e=this.search.val(),k=void 0!==e&&null!==e&&(a!==!0||i.inputSearch||i.minLength>0)?e:"",this.resultsPage=1,void i.query({element:i.element,term:k,page:this.resultsPage,context:null,matcher:i.matcher,callback:this._bind(function(e){if(this._opened())if(this.context=e&&void 0!==e.context?e.context:null,e&&0!==e.results.length)c.saveLastQueryResult(this,e.results),this._showDropDown(),this._preprocessResults(h),j.opts.populateResults.call(this,h,e.results,{term:g.val(),page:this.resultsPage,context:null,initial:a},this._showPlaceholder()),this._postprocessResults(e,a),d();else if("oj-select"===this._classNm&&this.opts.multiple!==!0||this.opts.inputSearch&&""!==b.trim(this.opts.inputSearch)||this.header){var f=b("<li>");f.addClass("oj-listbox-no-results"),f.text(i.noMatchesFound),this._showDropDown(),this._preprocessResults(h),h.append(f),d()}})}))},_preprocessResults:function(a){if(this.opts.list){var b=a.children();this._hideResultList(b)}else a.empty()},_hideResultList:function(a){for(var c=0;c<a.length;c++){b(a[c]).is("LI")&&((b(a[c]).hasClass("oj-listbox-no-results")||b(a[c]).hasClass("oj-listbox-placeholder"))&&b(a[c]).remove(),b(a[c]).css("display","none"),b(a[c]).hasClass("oj-selected")&&b(a[c]).removeClass("oj-selected"));var d=b(a[c]).children("ul");d&&d.children()&&this._hideResultList(d.children())}},_cancel:function(a){this.close(a)},_focusSearch:function(){c._focus(this.search)},_selectHighlighted:function(a,d){if(this.header){var e=this._getActiveContainer().attr("aria-activedescendant");if(this._isHeaderItem(e)){var f=b("#"+e),g="a, input, select, textarea, button, object",h=f.find(g).first();return 0===h.length&&(h=f.children()),h.length&&h[0].click(),void this.close(d)}}var i=this._highlight(),j=this.results.find(".oj-hover"),k=j.closest(".oj-listbox-result").data(this._elemNm);k?(this._highlight(i),a=a||{},a.trigger=c.ValueChangeTriggerTypes.OPTION_SELECTED,k!==this.opts._placeholderData?this._onSelect(k,a,d):this._onSelect([],a,d)):a&&a.noFocus&&this.close(d)},_getPlaceholder:function(){return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder},_setPlaceholder:function(){var a=this._getPlaceholder();a&&(this.search.attr("placeholder",a),this.container.removeClass(this._classNm+"-allowclear"))},_initContainerWidth:function(){function a(){var a,b,c,d,e,f;if(a=this.opts.element.attr("style"),void 0!==a)for(b=a.split(";"),d=0,e=b.length;d<e;d+=1)if(f=b[d].replace(/\s/g,""),c=f.match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i),null!==c&&c.length>=1)return c[1]}var b=a.call(this);null!==b&&this.container.css("width",b)},getVal:function(){return this.ojContext.option("value")},setVal:function(a,b,c){var d={doValueChangeCheck:!1};c&&(d._context=c),"string"!=typeof a&&Array.isArray(a)||(a=[a]),this.opts.element.val(0!==a.length?a:null),this.ojContext._updateValue(a,b,d)},_showPlaceholder:function(){return!1},_getActiveContainer:function(){return this.search},_hasSearchBox:function(){return void 0!==this.opts.minimumResultsForSearch&&void 0!==this.container._hasSearchBox},_findItem:function(a,c){for(var d=0;d<a.length;d++)if(b(a[d]).data(this._elemNm).value===c)return a[d];return null}}),e={closeOnSelect:!0,openOnEnter:!0,id:function(a){return a.id},matcher:function(a,b){return(""+b).toUpperCase().indexOf((""+a).toUpperCase())>=0},separator:","},f=c.clazz(d,{_enableInterface:function(){f.superclass._enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this._isInterfaceEnabled())},_focus:function(){this._opened()&&this.close()},_destroy:function(){b("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id")),f.superclass._destroy.apply(this,arguments)},_clear:function(a){this.selection.data(this._elemNm);this.search.val(""),this.selection.removeData(this._elemNm),
this._setPlaceholder()},_initSelection:function(){var a=this.opts.element;this.opts.initSelection.call(null,a,this._bind(this._updateSelectedOption))},_containerKeydownHandler:function(a){if(this._isInterfaceEnabled()){if(a.which===c.KEY.PAGE_UP||a.which===c.KEY.PAGE_DOWN)return void c.killEvent(a);switch(a.which){case c.KEY.UP:case c.KEY.DOWN:return this._opened()?this._moveHighlight(a.which===c.KEY.UP?-1:1):this.open(a),void c.killEvent(a);case c.KEY.ENTER:return this._selectHighlighted(null,a),c.killEvent(a),void(this._opened()||(this._userTyping=!1));case c.KEY.TAB:return this.close(a),void(this._userTyping=!1);case c.KEY.ESC:return this._opened()&&(this._cancel(a),c.killEvent(a)),void(this._userTyping=!1)}this._userTyping=!0}},_containerKeyupHandler:function(a){this._isInterfaceEnabled()&&(this._opened()||this.open(a))},_initContainer:function(){var a,d,e=this.container,f=(this.dropdown,this.opts.rootAttributes),g=f&&f.id?f.id:this.opts.element.attr("id")||c.nextUid();this.selection=a=e.find("."+this._classNm+"-choice"),a.attr("id",this._classNm+"-choice-"+g),d=b("label[for='"+this.opts.element.attr("id")+"']"),d.attr("id")||d.attr("id",this._classNm+"-label-"+g),a.find("."+this._classNm+"-input").attr("id",this._classNm+"-input-"+g),this.results.attr("id")||this.results.attr("id","oj-listbox-results-"+g),this.search.attr("aria-owns",this.results.attr("id")),this.search.attr("aria-labelledby",d.attr("id")),this.opts.element.attr("aria-labelledby",d.attr("id")),this.search.attr("id")&&d.attr("for",this.search.attr("id")),this.opts.element.attr("aria-label")&&this.search.attr("aria-label",this.opts.element.attr("aria-label")),this.opts.element.attr("aria-controls")&&this.search.attr("aria-controls",this.opts.element.attr("aria-controls")),a.on("keydown",this._bind(this._containerKeydownHandler)),a.on("mousedown","abbr",this._bind(function(a){this._isInterfaceEnabled()&&(this._clear(a),c.killEventImmediately(a),this.close(a),this.selection.focus())})),a.on("mousedown",this._bind(function(a){this.opts.element.prop("disabled")&&c.killEvent(a),this._opened()?this.close(a):this._isInterfaceEnabled()&&this.open(a);var b=this.search.parent().attr("aria-hidden");b&&"true"==b?this.selection.focus():this.search.focus(),this.container.addClass("oj-active")})),a.on("mouseup",this._bind(function(a){this.container.removeClass("oj-active")})),a.on("focus",this._bind(function(a){c.killEvent(a)})),this.search.on("blur keyup",this._bind(function(a){if("keyup"!==a.type||10===a.keyCode||13===a.keyCode){if(void 0!==this.search.val()&&this.results.find(".oj-hover").length<=0)if(this.opts.manageNewEntry){var b=this.selection.data(this._elemNm);if(!b&&""!==this.search.val()||b&&(b.label!==this.search.val()||!this.ojContext.isValid())){var d=this.opts.manageNewEntry(this.search.val()),e="blur"===a.type?c.ValueChangeTriggerTypes.BLUR:c.ValueChangeTriggerTypes.ENTER_PRESSED,f={trigger:e};this._onSelect(d,f,a)}}else if(null==this.opts.manageNewEntry){var d=this.selection.data(this._elemNm);if(""==this.search.val())this._clear(a);else if("oj-select"!==this._classNm){var g=this.opts.formatSelection(d);void 0!==g&&this.search.val(g)}}this.search.removeClass(this._classNm+"-focused"),this.container.removeClass("oj-focus")}})),this._initContainerWidth(),this.opts.element.hide().attr("aria-hidden",!0),this._setPlaceholder()},_prepareOpts:function(){var a=f.superclass._prepareOpts.apply(this,arguments),d=this,e=this.getVal(),g=a.element.get(0).tagName.toLowerCase();if("input"===g&&a.element.attr("list")||"select"===g&&a.element.children().length>0||a.list){var h=a.list?"li":"option";a.initSelection=function(a,b){var c,e=d.getVal();Array.isArray(e)&&(e=e[0]),c=void 0!==e&&null!==e?d._optionToData(a.find(h).filter(function(){return"li"==h?this.getAttribute("oj-data-value")===e:"option"==h?this.value===e:void 0})):d._optionToData(a.find(h).filter(function(){return"li"==h?this.getAttribute("oj-data-selected")===!0:"option"==h?this.selected:void 0})),b(c)},a.validate=function(a,b){var c;return void 0!==b&&null!==b&&(c=d._optionToData(a.find(h).filter(function(){return"li"==h?this.getAttribute("oj-data-value")===b:"option"==h?this.value===b:void 0}))),!!c}}else("options"in a||e&&e.length>0)&&(b.isFunction(a.options)?(a.initSelection=function(f,g){var h=function(a,b){for(var c=0,d=a.length;c<d;c++){var e=a[c];if(JSON.stringify(b)===JSON.stringify(e))return e;if(e.children){var f=h(e.children,b);if(f)return f}}return null};e=d.getVal();var i="";e&&e.length&&(i=e[0]);var j=null;if(!i)return void g(j);var k=c.getLastQueryResult(d);if(k&&(j=h(k,i)),!j){var l=d.currentItem;l&&l.length&&i===l[0]&&(j=l[0])}j||d.valueChangeTrigger?g(j):a.query({value:[i],callback:b.isFunction(g)?function(a){a&&a.results&&(j=h(a.results,i)),g(j)}:b.noop})},a.validate||(a.validate=function(a,b){return!0})):(a.initSelection=function(c,f){var h="";e=d.getVal(),e&&e.length&&(h=e[0]);var i="select"==g&&d.ojContext._HasPlaceholderSet()&&!d.ojContext._IsRequired(),j=i?d._getPlaceholder():null,k=null;a.query({matcher:function(a,b,c){var d=JSON.stringify(h)===JSON.stringify(c);return d&&(k=c),null==j&&(j=c),d},callback:b.isFunction(f)?function(){k||"select"!==g||(k=j),f(k)}:b.noop})},a.validate=function(c,d){var e=d,f=null;return a.query({matcher:function(a,b,c){var d=JSON.stringify(e)===JSON.stringify(c);return d&&(f=c),d},callback:b.noop}),!!f}));return a},_postprocessResults:function(a,b,d){var e,f=-1,g=this;e=this._findHighlightableChoices(),c.each2(e,function(a,b){var c=g.getVal();if(c&&c[0]===g.id(b.data(g._elemNm)))return f=a,!1}),d!==!1&&b===!0&&f>=0&&this._highlight(f)},_onSelect:function(a,b,c){if(this._triggerSelect(a)){var d;b&&b.trigger&&(d={optionMetadata:{trigger:b.trigger}}),this.setVal(a?a:[],c,d),this.close(c),this._focusSearch()}},_clearSearch:function(){this.search.val("")}}),g=c.clazz(f,{_elemNm:"ojidentity",_classNm:"oj-select",_userTyping:!1,_createContainer:function(){var a=b(document.createElement("div")).attr({"class":"oj-identity oj-select oj-component"}).html(["<div class='oj-select-choice' tabindex='0' role='combobox' ","     aria-autocomplete='none' aria-expanded='false' aria-ready='true'>","  <span class='oj-select-chosen'></span>","  <abbr class='oj-select-search-choice-close' role='presentation'></abbr>","  <a class='oj-select-arrow oj-component-icon oj-clickable-icon-nocontext oj-select-open-icon' role='presentation'>","</a></div>","<span class='oj-identity-filter'></span>","<div class='oj-listbox-drop oj-identity-container' style='display:none' role='presentation'>","  <div class='oj-listbox-search-wrapper'>","  <div class='oj-listbox-search'>","    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off'","           spellcheck='false' class='oj-listbox-input' title='Search field' ","           role='combobox' aria-expanded='false' aria-autocomplete='list' />","    <span class='oj-listbox-spyglass-box'>","      <span class='oj-component-icon oj-clickable-icon-nocontext oj-listbox-search-icon' role='presentation'>","       <b role='presentation'></b></span>","    </span>","    <span class='oj-identity-loading-container oj-select-loading'>","      <span class='oj-identity-loading' role='presentation'>","       &nbsp;</span>","    </span>","  </div>","  </div>","   <ul class='oj-listbox-results' role='listbox'>","   </ul>","</div>"].join(""));return a},_enable:function(a){g.superclass._enable.apply(this,arguments),this._enabled?(this.container.find(".oj-select-choice").attr("tabindex","0"),this.container.find(".oj-select-arrow").removeClass("oj-disabled")):(this.container.find(".oj-select-choice").attr("tabindex","-1"),this.container.find(".oj-select-arrow").addClass("oj-disabled"))},close:function(a){this._opened()&&(g.superclass.close.apply(this,arguments),this.container.find(".oj-select-choice").attr("aria-expanded",!1),this._testClear(a)||this._clearSearch(),a instanceof MouseEvent&&a.target!=this.selection&&a.target!=this.search||c._focus(this.selection),this.container.find(".oj-listbox-spyglass-box").off("mouseup click"))},_opening:function(a,b){g.superclass._opening.apply(this,arguments);var d;a&&"keydown"==a.type&&a.which!=c.KEY.UP&&a.which!=c.KEY.DOWN&&a.which!=c.KEY.LEFT&&a.which!=c.KEY.RIGHT&&(d=String.fromCharCode(a.which),c.killEvent(a)),this._opened()&&(d=this.search.val()),this._showSearchBox(d),b||(d?this._updateResults():this._updateResults(!0))},_showDropDown:function(){if(this._opened()){g.superclass._showDropDown.apply(this,arguments),this.container.find(".oj-select-choice").attr("aria-expanded",!0);var a,b,c;this._hasSearchBox()&&(a=this.search.get(0),a.createTextRange?(b=a.createTextRange(),b.collapse(!1),b.select()):a.setSelectionRange&&(c=this.search.val().length,a.setSelectionRange(c,c)))}},_initContainer:function(){var a=this.containerId+"_selected";this.text=this.container.find(".oj-select-chosen").attr("id",a),g.superclass._initContainer.apply(this,arguments),this.container.find(".oj-select-choice").attr({"aria-owns":this.search.attr("aria-owns"),"aria-labelledby":this.search.attr("aria-labelledby"),"aria-describedby":a});var b=this.opts.element.attr("aria-label");b&&this.selection.attr("aria-label",b),this.search.on("keydown",this._bind(this._containerKeydownHandler)),this.search.on("keyup-change input",this._bind(this._containerKeyupHandler));var c=this;this.selection.on("blur",function(a){c._testClear(a)})},_initSelection:function(){this._isPlaceholderOptionSelected()?(this._updateSelection(null),this.close(),this._setPlaceholder()):g.superclass._initSelection.apply(this,arguments)},_updateSelectedOption:function(a){if(void 0!==a&&null!==a){var b=this.getVal();b=Array.isArray(b)?b[0]:b,JSON.stringify(b)!==JSON.stringify(a)&&(void 0===b||null===b?this.ojContext.options.value=Array.isArray(a)?a:[a]:this.setVal(Array.isArray(a)?a:[a])),this._updateSelection(a),this.close()}},_updateSelection:function(a){this.selection.data(this._elemNm,a),null!==a&&this.text.text(a[this.opts.optionsKeys.label]),a&&""!=a.id&&this.text.removeClass(this._classNm+"-default"),this.opts.allowClear&&this.container.addClass(this._classNm+"-allowclear")},_getActiveContainer:function(){var a=this.search.attr("aria-expanded");return a&&this._hasSearchBox()?this.search:this.selection},_isPlaceholderOptionSelected:function(){if(null===this._getPlaceholder())return!1;var a=this.getVal();return a=Array.isArray(a)?a[0]:a,""===a||void 0===a||null===a},_getPlaceholder:function(){return this.opts.placeholder},_showPlaceholder:function(){return!0},_setPlaceholder:function(){var a=this._getPlaceholder();this._isPlaceholderOptionSelected()&&void 0!==a&&(void 0===a&&(a=""),this.text.text(a).addClass(this._classNm+"-default"),this.container.removeClass(this._classNm+"-allowclear"))},setVal:function(a,b,c){g.superclass.setVal.call(this,a,b,c),this.selection.data("selectVal",a)},_containerKeydownHandler:function(a){if(!(c.KEY.isControl(a)&&a.which!=c.KEY.SHIFT||c.KEY.isFunctionKey(a))){switch(a.which){case c.KEY.TAB:return this.close(a),this.selection.focus(),void this._testClear(a);case c.KEY.ENTER:if(a.target===this.selection[0]&&!this._opened())return this.open(a),void c.killEvent(a)}var b=this._hasSearchBox();if(g.superclass._containerKeydownHandler.apply(this,arguments),this._userTyping&&!this._opened()&&this.open(a),!b&&this._userTyping){var d;a.which!=c.KEY.LEFT&&a.which!=c.KEY.RIGHT&&(d=String.fromCharCode(a.which)),this._showSearchBox(d),this._updateResults(),c.killEvent(a)}}},_testClear:function(a){return""==this.text.text()&&(this._clear(a),!0)},_showSearchBox:function(a){var d=!1,e=this.dropdown.find(".oj-listbox-search");if(e&&(this._hasSearchBox()?(this.dropdown.find(".oj-listbox-search-wrapper").removeClass("oj-helper-hidden-accessible"),b(e).removeAttr("aria-hidden"),this.search.val(a),d=!0):(this.dropdown.find(".oj-listbox-search-wrapper").addClass("oj-helper-hidden-accessible"),b(e).attr("aria-hidden","true"))),c._focus(d?this.search:this.selection),d){var f=this;e.find(".oj-listbox-spyglass-box").on("mouseup click",function(a){f.search.focus(),a.stopPropagation()})}},_hasSearchBox:function(){var a,c=this.opts.minimumResultsForSearch;return a=this.opts.list?b("#"+this.opts.list).find("li").length:this.datalist?this.datalist[0].length:this.opts.options?this.opts.options.length:0,a>c||this._userTyping||b.isFunction(this.opts.options)}}),h=c.clazz(d,{_prepareOpts:function(){var a=h.superclass._prepareOpts.apply(this,arguments),d=this,e=a.element.get(0).tagName.toLowerCase();if("input"===e&&a.element.attr("list")||"select"===e&&a.element.children().length>0||a.list){var f=a.list?"li":"option";a.initSelection=function(a,b){var g,h=[],i=d.getVal();if(i)for(var j=i,k=0;k<j.length;k++){var l=j[k];g=a.find(f).filter(function(){return"option"===f?this.value===l:"li"===f?this.getAttribute("oj-data-value")===l:void 0}),g&&g.length?h.push(d._optionToData(g)):h.push({value:l,label:l})}else"select"!==e&&(g=a.find(f).filter(function(){return"option"===f?this.selected:"li"===f?this.getAttribute("oj-data-selected")===!0:void 0}),c.each2(g,function(a,b){h.push(d._optionToData(b))}));b(h)}}else"options"in a&&(b.isFunction(a.options)?a.initSelection=function(e,f){var g=function(c,d){for(var e=[],f=0,h=c.length;f<h;f++){var i=c[f],j=a.indexOf.call(c,i);if(j>=0&&e.push(i),i.children){var k=g(i.children,d);k&&k.length&&b.merge(e,k)}}return e},h=d.getVal(),i=[],j=c.getLastQueryResult(d);j&&(i=g(j,h));var k=function(){for(var a=[],b=0;b<h.length;b++){for(var c=h[b],e=!1,g=0;g<i.length;g++){var j=i[g];if(JSON.stringify(c)===JSON.stringify(j)){a.push(j),i.splice(g,1),e=!0;break}}if(!e){var k=d.currentItem;if(k&&k.length)for(var l=0;l<k.length;l++)if(JSON.stringify(c)===JSON.stringify(k[l])){a.push(k[l]),e=!0;break}e||a.push(c)}}f(a)};d.valueChangeTrigger?k():a.query({value:h,callback:function(a){if(a&&a.results){var c=g(a.results,h);c&&c.length&&b.merge(i,c)}k()}})}:a.initSelection=a.initSelection||function(c,e){var f=d.getVal(),g=[];a.query({matcher:function(a,c,d){var e=b.grep(f,function(a){return JSON.stringify(a)===JSON.stringify(d)}).length;return e&&g.push(d),e},callback:b.isFunction(e)?function(){for(var a=[],b=0;b<f.length;b++){for(var c=f[b],d=!1,h=0;h<g.length;h++){var i=g[h];if(JSON.stringify(c)===JSON.stringify(i)){a.push(i),g.splice(h,1),d=!0;break}}d||a.push(c)}e(a)}:b.noop})});return a},_selectChoice:function(a){var b=this.container.find("."+this._classNm+"-selected-choice.oj-focus");b.length&&a&&a[0]==b[0]||(b.length&&this.opts.element.trigger("choice-deselected",b),b.removeClass("oj-focus"),a&&a.length&&(this.close(),a.addClass("oj-focus"),this.container.find("."+this._classNm+"-description").text(a.attr("valueText")+". Press back space to delete.").attr("aria-live","assertive"),this.opts.element.trigger("choice-selected",a)))},_destroy:function(){b("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id")),h.superclass._destroy.apply(this,arguments)},_initContainer:function(){var a,d,e="."+this._classNm+"-choices",f=c.nextUid();this.searchContainer=this.container.find("."+this._classNm+"-search-field"),this.selection=a=this.container.find(e);var g=this;this.selection.on("click","."+this._classNm+"-selected-choice:not(."+this._classNm+"-locked)",function(a){g.search[0].focus(),g._selectChoice(b(this))}),d=b("label[for='"+this.opts.element.attr("id")+"']"),d.attr("id")||d.attr("id",this._classNm+"-label-"+f),a.find("."+this._classNm+"-input").attr("id",this._classNm+"-input-"+f),this.results.attr("id")||this.results.attr("id","oj-listbox-results-"+f),this.search.attr("aria-owns",this.results.attr("id")),this.search.attr("aria-labelledby",d.attr("id")),this.opts.element.attr("aria-labelledby",d.attr("id")),this.search.attr("id")&&d.attr("for",this.search.attr("id")),this.opts.element.attr("aria-label")&&this.search.attr("aria-label",this.opts.element.attr("aria-label")),this.opts.element.attr("aria-controls")&&this.search.attr("aria-controls",this.opts.element.attr("aria-controls")),this.search.attr("tabindex",this.elementTabIndex),this.keydowns=0,this.search.on("keydown",this._bind(function(b){if(this._isInterfaceEnabled()){++this.keydowns;var d=a.find("."+this._classNm+"-selected-choice.oj-focus"),e=d.prev("."+this._classNm+"-selected-choice:not(."+this._classNm+"-locked)"),f=d.next("."+this._classNm+"-selected-choice:not(."+this._classNm+"-locked)"),g=c.getCursorInfo(this.search);if(d.length&&(b.which==c.KEY.LEFT||b.which==c.KEY.RIGHT||b.which==c.KEY.BACKSPACE||b.which==c.KEY.DELETE||b.which==c.KEY.ENTER)){var h=d;return b.which==c.KEY.LEFT&&e.length?h=e:b.which==c.KEY.RIGHT?h=f.length?f:null:b.which===c.KEY.BACKSPACE?(this._unselect(d.first(),b),this.search.width(10),h=e.length?e:f):b.which==c.KEY.DELETE?(this._unselect(d.first(),b),this.search.width(10),h=f.length?f:null):b.which==c.KEY.ENTER&&(h=null),this._selectChoice(h),c.killEvent(b),void(h&&h.length||this.open())}if((b.which===c.KEY.BACKSPACE&&1==this.keydowns||b.which==c.KEY.LEFT)&&0==g.offset&&!g.length)return this._selectChoice(a.find("."+this._classNm+"-selected-choice:not(."+this._classNm+"-locked)").last()),void c.killEvent(b);if(this._selectChoice(null),this._opened())switch(b.which){case c.KEY.UP:case c.KEY.DOWN:return this._moveHighlight(b.which===c.KEY.UP?-1:1),void c.killEvent(b);case c.KEY.ENTER:return this._selectHighlighted(null,b),void c.killEvent(b);case c.KEY.TAB:return void this.close(b);case c.KEY.ESC:return this._cancel(b),void c.killEvent(b)}if(!(b.which===c.KEY.TAB||c.KEY.isControl(b)||c.KEY.isFunctionKey(b)||b.which===c.KEY.ESC||b.which===c.KEY.ENTER&&this.search.val()&&"ojcombobox"===this._elemNm))switch(b.which){case c.KEY.UP:case c.KEY.DOWN:return this.open(),void c.killEvent(b);case c.KEY.PAGE_UP:case c.KEY.PAGE_DOWN:return void c.killEvent(b);case c.KEY.ENTER:return void c.killEvent(b)}}})),this.search.on("keyup",this._bind(function(a){this.keydowns=0})),this.search.on("blur keyup",this._bind(function(a){if("keyup"!==a.type||10===a.keyCode||13===a.keyCode){if(this.opts.manageNewEntry&&this.search.val()&&this.results.find(".oj-hover").length<=0){var b=this.opts.manageNewEntry(this.search.val()),d="blur"===a.type?c.ValueChangeTriggerTypes.BLUR:c.ValueChangeTriggerTypes.ENTER_PRESSED,e={trigger:d};this._onSelect(b,e,a)}this.search.removeClass(this._classNm+"-focused"),this.container.removeClass("oj-focus"),this._selectChoice(null),this._opened()||this._clearSearch(),a.stopImmediatePropagation()}})),this.container.on("click touchstart",e,this._bind(function(a){this._isInterfaceEnabled()&&(b(a.target).closest("."+this._classNm+"-selected-choice").length>0||(this._selectChoice(null),this._opened()?this.close(a):(this.open(),this._focusSearch()),a.preventDefault()))})),this.container.on("focus",e,this._bind(function(){!this._isInterfaceEnabled()})),this._initContainerWidth(),this.opts.element.hide().attr("aria-hidden",!0),this._clearSearch()},_enableInterface:function(){h.superclass._enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this._isInterfaceEnabled())},_initSelection:function(){var a=this.getVal();if(null!==a&&0!==a.length||"oj-select"!==this._classNm&&""!==this.opts.element.text()||(this._updateSelection([]),this.close(),this._clearSearch()),null!==a&&a.length){var b=this,c=this.opts.element;this.opts.initSelection.call(null,c,function(a){void 0!==a&&null!==a&&0!==a.length&&(b._updateSelection(a),b.close(),b._clearSearch())})}},_clearSearch:function(){var a=this._getPlaceholder(),b=this._getMaxSearchWidth(),c=this.getVal();void 0===a||c&&0!==c.length?(this.search.attr("placeholder",""),this.search.val("").width(10),this.searchContainer.width("auto")):(this.search.attr("placeholder",a),this.search.val("").width(b>0?b:this.container.css("width")),this.searchContainer.width("100%"))},_opening:function(a,b){this._resizeSearch(),h.superclass._opening.apply(this,arguments),this._focusSearch(),b||this._updateResults(!0),this.search.focus()},close:function(a){this._opened()&&h.superclass.close.apply(this,arguments)},_focus:function(){this.close(),this.search.focus()},_updateSelection:function(a){var c=[],d=[],e=this;b(a).each(function(){e.opts.indexOf.call(c,this)<0&&(c.push(this),d.push(this))}),a=d,this.selection.find("."+this._classNm+"-selected-choice").remove(),b(a).each(function(){e._addSelectedChoice(this)}),this.currentItem=a,this.opts.element.val(0===c.length?[]:c),e._postprocessResults(),setTimeout(function(){e._positionDropdown()},0)},_onSelect:function(a,c,d){if(this._triggerSelect(a)){var e,f=this;c&&c.trigger&&(e={optionMetadata:{trigger:c.trigger}});var g=this.getVal(),h=g?g.slice(0):[];b(a).each(function(){f.opts.indexOf.call(h,this)<0&&h.push(this)}),this.setVal(h,d,e),!this.select&&this.opts.closeOnSelect||this._postprocessResults(a,!1,this.opts.closeOnSelect===!0),this.opts.closeOnSelect&&(this.close(d),this.search.width(10)),c&&c.noFocus||this._focusSearch()}},_cancel:function(a){this.close(a),this._focusSearch()},_addSelectedChoice:function(a){var d,e=!a.locked,f=b("<li class='"+this._classNm+"-selected-choice'>    <div></div>    <a href='#' onclick='return false;' role='button' aria-label='remove' class='"+this._classNm+"-clear-entry       oj-component-icon oj-clickable-icon-nocontext "+this._classNm+"-clear-entry-icon' tabindex='-1'>    </a></li>"),g=b("<li class='"+this._classNm+"-selected-choice "+this._classNm+"-locked'><div></div></li>"),h=e?f:g;this.id(a);d=this.opts.formatSelection(a),void 0!==d&&(h.find("div").addClass(this._classNm+"-selected-choice-label").text(d),h.find("."+this._classNm+"-clear-entry").attr("aria-label",d+" remove"),h.attr("valueText",d)),e&&h.find("."+this._classNm+"-clear-entry").on("mousedown",c.killEvent).on("click dblclick",this._bind(function(a){this._isInterfaceEnabled()&&(b(a.target).closest("."+this._classNm+"-selected-choice").fadeOut("fast",this._bind(function(){this._unselect(b(a.target),a),this.selection.find("."+this._classNm+"-selected-choice.oj-focus").removeClass("oj-focus"),this.close(a),this._focusSearch()})).dequeue(),c.killEvent(a))})),h.data(this._elemNm,a),h.insertBefore(this.searchContainer)},_unselect:function(a,b){var c,d,e=this.getVal(),f=e?e.slice(0):[],g=this;if(a=a.closest("."+this._classNm+"-selected-choice"),0===a.length)throw"Invalid argument: "+a+". Must be ."+this._classNm+"-selected-choice";if(c=a.data(this._elemNm)){for(var h;(d=g.opts.indexOf.call(f,c))>=0;)h=f.splice(d,1),this.setVal(f,b),this.select&&this._postprocessResults();this.ojContext._IsRequired()&&0===f.length||a.remove(),this.ojContext._IsRequired()&&this.ojContext.validate()}},_postprocessResults:function(a,b,d){var e=this.getVal(),f=e&&(this.opts.element.val()||this.ojContext.isValid())?e:[],g=this.results.find(".oj-listbox-result"),h=this;c.each2(g,function(a,b){var c=h.id(b.data(h._elemNm));f&&h.opts.indexOf.call(f,c)>=0&&(b.addClass("oj-selected"),b.find(".oj-listbox-result-selectable").addClass("oj-selected"))}),!g.filter(".oj-listbox-result:not(.oj-selected)").length>0&&this.close()},_getMaxSearchWidth:function(){return this.selection.width()-c.getSideBorderPadding(this.search)},_textWidth:function(a){var c=document.createElement("span"),d=document.createTextNode(a);c.style.display="none",c.appendChild(d),b("body").append(c);var e=b("body").find("span:last").width();return b("body").find("span:last").remove(),e},_resizeSearch:function(){var a,b,d,e,f,g=c.getSideBorderPadding(this.search);a=this._textWidth(this.search.val())+10,b=this.search.offset().left,d=this.selection.width(),e=this.selection.offset().left,f=d-(b-e)-g,f<a&&(f=d-g),f<40&&(f=d-g),f<=0&&(f=a),this.search.width(Math.floor(f))},setVal:function(a,b,d){var e=[],f=this;"string"==typeof a&&(a=c.splitVal(a,this.opts.separator));for(var g=0;g<a.length;g++)f.opts.indexOf.call(e,a[g])<0&&e.push(a[g]);var h={doValueChangeCheck:!1};d&&(h._context=d),this.opts.element.val(0!==a.length?a:null),this.ojContext._updateValue(e,b,h),this.search.attr("aria-activedescendant",this.opts.element.attr("id"))}}),i=c.clazz(h,{_elemNm:"ojidentity",_classNm:"oj-select",_createContainer:function(){var a=b(document.createElement("div")).attr({"class":"oj-identity oj-select oj-select-multi oj-component"}).html(["<div class='oj-identity-select'>","  <ul class='oj-select-choices'>","    <li class='oj-select-search-field'>","      <input type='text' role='combobox' aria-expanded='false' aria-autocomplete='list' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='oj-listbox-input'>","    <span class='oj-identity-loading-container oj-multi-loading'>","      <span class='oj-identity-loading' role='presentation'>","       &nbsp;</span>","    </li>","  </ul>","</div>","<span class='oj-identity-filter multiple'></span>","<div class='oj-select-description oj-helper-hidden-accessible'/>","<div class='oj-listbox-drop oj-identity-container oj-listbox-drop-multi' style='display:none'>","   <ul class='oj-listbox-results' role='listbox'>","   </ul>","</div>"].join(""));return a}}),j=function(a,c,d,e){if(b.widget(a,c,d),e){var f=a.split(".")[1];delete b.fn[f]}if("oj.oj"===a.substring(0,5)||"oj._oj"===a.substring(0,6))var g=a.split(".");var h,i=g[0],j=g[1],k=i+"-"+j,l="_"===j.substring(0,1);h=l?"_"+i+"-"+j.substring(3):i+"-"+j.substring(2),b.expr[":"][h.toLowerCase()]=function(a){return!!b.data(a,k)}},k=function(){var a=document.documentElement.getAttribute("dir");return a&&(a=a.toLowerCase()),"rtl"===a?"rtl":"ltr"},l=function(){var a=20;if(b.isNumeric(a))return a;var c=b("<div />");b(document.body).append(c),c.width(50).height(50).css({overflow:"scroll",visibility:"hidden",position:"absolute"});var d=b("<div />");d.height(1),c.append(d);var e=d.width(),f=c.width();return c.remove(),a=f-e}(),m=function(a,c){function d(a,b){if(a.bottom-b.top<-1)return!1;var c="auto"===b.overflowY||"scroll"===b.overflowY?l:0;return!(b.bottom-c-a.top<1)&&(c="auto"!==b.overflowX&&"scroll"!==b.overflowX||"rtl"!==k()?0:l,!(a.right-(b.left+c)<-1)&&(c="auto"!==b.overflowX&&"scroll"!==b.overflowX||"ltr"!==k()?0:l,!(a.left-(b.right-c)>-1)))}function e(a){return"visible"!==a.css("overflow-x")||"visible"!==a.css("overflow-y")}function f(a){var c=a[0];if(1===c.nodeType){var d=c.getBoundingClientRect();return d.overflowX=a.css("overflow-x"),d.overflowY=a.css("overflow-y"),d}if(b.isWindow(c)){var d={width:c.innerWidth,height:c.innerHeight,top:0,bottom:c.innerHeight,left:0,right:c.innerWidth};return d}return{height:0,width:0}}if(!a)return!1;var g=f(a);if(c&&!d(g,f(b(window))))return!1;for(var h=!0,i=a.parent();h&&i&&i.length>0&&1===i[0].nodeType;){if(e(i)){var j=f(i);j.height>0&&j.width>0&&(h=d(g,j))}i=i.parent()}return h},n=function(a){if(a.target&&a.target.height>0&&a.target.width>0){var b=a.target.element;return!m(b)}return!1},o=function(a,c){for(var d=b.extend({},a),e=0;e<p.length;e++){var f=p[e],g=d[f];g&&(d[f]=g.replace("start",c?"right":"left").replace("end",c?"left":"right").replace("<",c?"+":"-").replace(">",c?"-":"+"))}return d},p=["my","at"],q={defaultElement:"<select>",widgetEventPrefix:"oj",options:{minimumResultsForSearch:10,noMatchesFound:"No matches found",placeholder:null,list:void 0,multiple:!0,options:null,optionsKeys:{label:"id",value:"id"},beforeExpand:null,selectAll:!0,selectLabel:"Select All",defaultScope:"user",showScopeFilter:!1,scopesOptions:[{label:"All",value:"all"},{label:"User",value:"user"},{label:"Group",value:"group"},{label:"Role",value:"role"}],indexOf:function(a){if(!a)return-1;var b=this.length,c=0;for(a=JSON.stringify(a);c<b;c++){var d=JSON.stringify(this[c]);if(d===a)return c}return-1},contains:function(a){if(!a)return!1;for(var b=a.length,c=this.length,d=0,e=0,f=0;d<c;d++){var g=JSON.stringify(this[d]);for(e=0;e<b;e++){var h=JSON.stringify(a[e]);if(g===h){++f;break}}}return f===c}},widget:function(){return this.select?this.select.container:this.element.parent()},_ComponentCreate:function(){this._super(),this._setup()},_nativeSetDisabled:function(a){a?(this.element.attr("disabled",""),this.element.parent().addClass("oj-disabled").removeClass("oj-enabled")):(this.element.removeAttr("disabled"),this.element.parent().removeClass("oj-disabled").addClass("oj-enabled"))},_nativeChangeHandler:function(a){},_jetSetup:function(){var a={},c=this.options.multiple;a.element=this.element,a.ojContext=this,a=b.extend(this.options,a),this.select=c?new i:new g,this.select._init(a),this.select.container.addClass("oj-select-jet oj-form-control"),this.element.val=function(a){return arguments.length&&this.data("selected-value",a),this.data("selected-value")||[]}},_setup:function(){this._jetSetup()},refresh:function(){this._super(),this._cleanup(),this._setup()},_destroy:function(){this._super(),this._cleanup()},_NotifyDetached:function(){this.select.close()},_NotifyHidden:function(){this.select.close()},_SetPlaceholder:function(a){},_updateValue:function(a,c,d){c&&(d._context=d._context||{},b.extend(!0,d._context,{optionMetadata:{trigger:"option_selected",writeback:"shouldWrite"},originalEvent:c.originalEvent||c}),this.valueUpdated=!0,this.option({value:a},d),this.select._initSelection()),this._IsRequired()&&0!==a.length&&(this.select.container.removeClass("oj-invalid"),this.select.container.find(".oj-messaging-inline-container").remove())},_SetPlaceholderOption:function(a){this._super(a)},_HasPlaceholderSet:function(){return"string"==typeof this.options.placeholder},_IsRequired:function(){return this.options.required},_ClearPlaceholder:function(){this._SetPlaceholderOption(null),this._SetPlaceholder(null)},_InitOptions:function(b,d){var e=[{attribute:"disabled",validateOption:!0},{attribute:"placeholder"},{attribute:"required",coerceDomValue:!0,validateOption:!0},{attribute:"title"}];if(this._super(b,d),a.EditableValueUtils.initializeOptionsFromDom(e,d,this),void 0===this.options.value)this.options.value=void 0!==this.element.attr("value")?c.splitVal(this.element.val(),","):null;else{var f=this.options.value;Array.isArray(f)&&(f=f.slice(0)),this.options.value=f}},_SetDisplayValue:function(a){},_updateDisplayValue:function(){this.valueUpdated?this.valueUpdated=!1:this.select._initSelection()},_setOption:function(a,b,c){if("value"===a){var d=this.select.opts.element;b||(b=[]),Array.isArray(b)||(b=[b]);for(var e=[],f=0;f<b.length;f++)(this.options.multiple||this.select.opts.validate(d,b[f]))&&e.push(b[f]);return this._super(a,e,c),void this._updateDisplayValue()}"placeholder"===a?(this.select.opts.placeholder=b?b:null,this.select._setPlaceholder()):"minimumResultsForSearch"===a?this.select.opts.minimumResultsForSearch=b:"multiple"===a&&(this.options.multiple=b,this.refresh()),"disabled"===a?b?this.select._disable():this.select._enable():"options"===a?(this.select.opts.options=b,this.select.opts=this.select._prepareOpts(this.select.opts),this._super("value",this.select.getVal())):this._super(a,b,c)},_getDropdown:function(){if(this.select&&this.select._opened()){var a=this.select.dropdown;if(a&&a.attr("data-oj-containerid")===this.select.containerId)return a}return null},_cleanup:function(){this.select._destroy(),this.select=void 0},getNodeBySubId:function(a){var c,d=null;if(null==a){var e=this.widget();return e?e[0]:null}if(this._isNative())return null;if(d=this._super(a),!d){var f=this._getDropdown();switch(c=a.subId){case"oj-select-drop":f&&(d=f[0]);break;case"oj-select-results":f&&(d=f.find(".oj-listbox-results")[0]);break;case"oj-select-search":f&&(d=f.find(".oj-listbox-search")[0]);break;case"oj-select-input":case"oj-listbox-input":this.options.multiple===!0?d=this.widget().find(".oj-listbox-input")[0]:f&&(d=f.find(".oj-listbox-input")[0]);break;case"oj-select-choice":case"oj-select-chosen":case"oj-select-arrow":d=this.widget().find("."+c)[0];break;case"oj-listitem":if(f){var g=f.find(".oj-listbox-result");d=this.select._findItem(g,a.value)}break;case"oj-select-remove":var h=this.widget().find(".oj-select-selected-choice"),i=this.select._findItem(h,a.value);d=i?b(i).find(".oj-select-clear-entry-icon")[0]:null;break;case"oj-listbox-result-label":if(f){var j=b("#"+this.select.results.attr("id")).children(),k=a.index;
j.length&&k<j.length&&(d=j.eq(k).find("."+c)[0])}}}return d||null},getSubIdByNode:function(a){if(this._isNative())return this._super(a);var c=null;if(null!=a){var d=b(a);d.hasClass("oj-listbox-input")?c={subId:"oj-select-input"}:d.hasClass("oj-select-arrow")?c={subId:"oj-select-arrow"}:d.hasClass("oj-listbox-result")?c={subId:"oj-listitem",value:d.data("ojidentity").value}:d.hasClass("oj-select-clear-entry-icon")&&(c={subId:"oj-select-remove",value:d.closest(".oj-select-selected-choice").data("ojidentity").value})}return c},_GetDefaultStyleClass:function(){return"oj-select"},_GetMessagingLauncherElement:function(){return this.select?this.select.selection:this.element}};j("oj.ojIdentity",b.oj.editableValue,q)});